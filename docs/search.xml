<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Android æŒ‡å®š DNS ï¼ˆä¸ºä»€ä¹ˆæ–°ç”¨æˆ·å®‰è£…å®Œä½ çš„Appåï¼Œä¸ApiæœåŠ¡è¿æ¥å¤±è´¥ï¼Ÿï¼‰</title>
    <url>/2019/07/16/android-custom-dns/</url>
    <content><![CDATA[<blockquote>
<p>è¿‡å»ä¸€ç›´æœ‰ä¸ªé—®é¢˜ï¼šå‘ç°æˆ‘çš„æ–°ç”¨æˆ·åœ¨å®‰è£…å®ŒAppåï¼Œæ‰“å¼€æ—¶æç¤ºæ²¡æœ‰ç½‘ç»œï¼ˆè¿æ¥åˆ°æˆ‘çš„ApiæœåŠ¡å™¨å¤±è´¥ï¼‰<br><br>ç›´åˆ°ä»Šå¤©ç¿»qiniuçš„SDKæ—¶æ‰æ˜ç™½è¿‡æ¥ï¼Œé—®é¢˜å¯èƒ½åœ¨<strong>DNS</strong><br><br>ä¸ƒç‰›çš„SDKä¸€ç›´ä½¿ç”¨äº†ä¸€ä¸ªå«<code>HappyDNS</code>çš„ä¸€ä¸ªåº“ã€‚æˆ‘ä¸€ç›´ä»¥ä¸ºè¿™æ˜¯â€œè„±è£¤å­æ”¾å±â€ã€‚<br><br>ç›´åˆ°ä»Šå¤©æ‰æ˜ç™½è¿™ä¸­é—´çš„â€œä¸­å›½ç‰¹è‰²â€</p>
</blockquote>
<h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><ul>
<li>å¼€å‘å·¥å…·ï¼šAndroid Studio</li>
<li>è¯­è¨€ï¼šKotlin</li>
<li>ä¾èµ–åŒ…ï¼š<ul>
<li>com.squareup.okhttp3:okhttp:3.14.2</li>
<li>com.qiniu:happy-dns:0.2.13</li>
</ul>
</li>
</ul>
<h2 id="å…³é”®ä»£ç "><a href="#å…³é”®ä»£ç " class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h2><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> client = OkHttpClient.Builder()</span><br><span class="line">                             .dns &#123;</span><br><span class="line">                                 <span class="keyword">if</span> (it == <span class="string">&quot;my.api.host.domain.name&quot;</span>) &#123;</span><br><span class="line">                                     InetAddress.getAllByName(Config.SERVER_IP).toMutableList()</span><br><span class="line">                                 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                                     <span class="keyword">try</span>&#123;</span><br><span class="line">                                         <span class="keyword">val</span> resolvers = mutableListOf&lt;IResolver&gt;()</span><br><span class="line">                                         <span class="keyword">try</span>&#123;</span><br><span class="line">                                             resolvers.add(Resolver(InetAddress.getByName(<span class="string">&quot;119.29.29.29&quot;</span>)))</span><br><span class="line">                                         &#125;<span class="keyword">catch</span> (e:Exception)&#123;&#125;</span><br><span class="line">                                         <span class="keyword">try</span>&#123;</span><br><span class="line">                                             resolvers.add(Resolver(InetAddress.getByName(<span class="string">&quot;114.114.114.114&quot;</span>)))</span><br><span class="line">                                         &#125;<span class="keyword">catch</span> (e:Exception)&#123;&#125;</span><br><span class="line">                                         <span class="keyword">try</span>&#123;</span><br><span class="line">                                             resolvers.add(Resolver(InetAddress.getByName(<span class="string">&quot;8.8.8.8&quot;</span>)))</span><br><span class="line">                                         &#125;<span class="keyword">catch</span> (e:Exception)&#123;&#125;</span><br><span class="line">                                         <span class="keyword">if</span> (resolvers.size == <span class="number">0</span>) <span class="keyword">throw</span> UnknownHostException(<span class="string">&quot;<span class="variable">$it</span> resolver fail&quot;</span>)</span><br><span class="line">                                         DnsManager(NetworkInfo.normal,resolvers.toTypedArray()).queryInetAdress(Domain(it)).toMutableList()</span><br><span class="line">                                     &#125;<span class="keyword">catch</span> (e:Exception)&#123;</span><br><span class="line">                                         Dns.SYSTEM.lookup(it)</span><br><span class="line">                                     &#125;</span><br><span class="line">                                 &#125;</span><br><span class="line">                             &#125;.build()</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>Android</tag>
        <tag>DNS</tag>
      </tags>
  </entry>
  <entry>
    <title>FreeBSD 12 æ„å»º mosquitto v2.0.7 + websockets + TLS + PostgreSQLè®¤è¯</title>
    <url>/2021/02/01/build-mosquitto-on-freebsd/</url>
    <content><![CDATA[<h1 id="MQTTæœåŠ¡å™¨éœ€æ±‚"><a href="#MQTTæœåŠ¡å™¨éœ€æ±‚" class="headerlink" title="MQTTæœåŠ¡å™¨éœ€æ±‚"></a>MQTTæœåŠ¡å™¨éœ€æ±‚</h1><ul>
<li>æ”¯æŒWebsocket</li>
<li>æ”¯æŒå‘½ä»¤è¡Œè¾“å‡ºjsonè¾“å‡º</li>
<li>æ”¯æŒé€šè¿‡PostgreSQLè®¤è¯ç”¨æˆ·</li>
</ul>
<pre class="mermaid">graph LR
pg[(PostgreSQL)]
auth(Auth plugin)
mos([Mosquitto])
ws(LibWebsockets)
c(MQTT Client)
b(Web Browser)

click auth "https://github.com/iegomez/mosquitto-go-auth" _blank
click pg "https://www.postgresql.org/" "PostgreSQL å®˜æ–¹" _blank
click mos "https://mosquitto.org/" "mosquitto å®˜æ–¹" _blank

pg --- auth
auth --- mos
mos --- ws
ws --- b
mos --- c</pre>

<h1 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h1><h2 id="mosquitto-èµ„æº"><a href="#mosquitto-èµ„æº" class="headerlink" title="mosquitto èµ„æº"></a>mosquitto èµ„æº</h2><p>å®˜ç½‘æºç åŒ…ä¸‹è½½åœ°å€ï¼š <a class="link"   href="https://mosquitto.org/download/" >https://mosquitto.org/download/<i class="fas fa-external-link-alt"></i></a></p>
<ul>
<li>å½“å‰æœ€æ–°ç‰ˆæœ¬2.0.6ï¼š <a class="link"   href="https://mosquitto.org/files/source/mosquitto-2.0.7.tar.gz" >https://mosquitto.org/files/source/mosquitto-2.0.7.tar.gz<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<h2 id="å®˜æ–¹æ¨èè®¤è¯æ‰©å±•"><a href="#å®˜æ–¹æ¨èè®¤è¯æ‰©å±•" class="headerlink" title="å®˜æ–¹æ¨èè®¤è¯æ‰©å±•"></a>å®˜æ–¹æ¨èè®¤è¯æ‰©å±•</h2><p><a class="link"   href="https://github.com/iegomez/mosquitto-go-auth" >https://github.com/iegomez/mosquitto-go-auth<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h1><h2 id="ç¼–è¯‘-mosquitto"><a href="#ç¼–è¯‘-mosquitto" class="headerlink" title="ç¼–è¯‘ mosquitto"></a>ç¼–è¯‘ mosquitto</h2><h3 id="å®‰è£…ä¾èµ–ï¼š"><a href="#å®‰è£…ä¾èµ–ï¼š" class="headerlink" title="å®‰è£…ä¾èµ–ï¼š"></a>å®‰è£…ä¾èµ–ï¼š</h3><ul>
<li><code>gmake</code> ç¼–è¯‘å·¥å…·</li>
<li><code>cmake</code> ç¼–è¯‘å·¥å…·</li>
<li><code>libcjson</code> å‘½ä»¤è¡Œæ”¯æŒjsonæ ¼å¼è¾“å‡ºä¾èµ–</li>
<li><code>libwebsockets</code> websocketä¾èµ–</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pkg install gmake libcjson</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®å¼€å‘è€…æè¿°:<a class="link"   href="https://github.com/eclipse/mosquitto/issues/2060" >https://github.com/eclipse/mosquitto/issues/2060<i class="fas fa-external-link-alt"></i></a><br><code>libwebsockets</code> é«˜äº<code>v2.4.2</code>åä¼šé»˜è®¤å…³é—­<code>LWS_WITH_EXTERNAL_POLL</code>é€‰é¡¹.å¯¼è‡´<code>mosquitto</code>åŠŸèƒ½å—æŸ.</p>
<p>æ‰€ä»¥,è¦ä¹ˆé€‰æ‹©ä½ç‰ˆæœ¬çš„<code>libwebsockets</code>,è¦ä¹ˆé‡æ–°æ‰‹åŠ¨ç¼–è¯‘é«˜ç‰ˆæœ¬.</p>
<p>è¿™é‡Œé€‰æ‹©é‡æ–°æ‰‹åŠ¨ç¼–è¯‘é«˜ç‰ˆæœ¬,å¼€å¯<code>LWS_WITH_EXTERNAL_POLL</code>é€‰é¡¹.</p>
<ul>
<li><code>cmake</code> ç¼–è¯‘:<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone https://libwebsockets.org/repo/libwebsockets</span><br><span class="line">cd libwebsockets</span><br><span class="line">git checkout v4.1.6</span><br><span class="line">cd ..</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake -DLWS_WITH_EXTERNAL_POLL=ON ../libwebsockets</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h3 id="è§£å‹æºç åŒ…ã€‚é…ç½®config-mk"><a href="#è§£å‹æºç åŒ…ã€‚é…ç½®config-mk" class="headerlink" title="è§£å‹æºç åŒ…ã€‚é…ç½®config.mk"></a>è§£å‹æºç åŒ…ã€‚é…ç½®<code>config.mk</code></h3></li>
</ul>
<ul>
<li>WITH_WEBSOCKETS:=no -&gt; yes</li>
<li>WITH_CJSON:=yes</li>
</ul>
<h3 id="ç¼–è¯‘-1"><a href="#ç¼–è¯‘-1" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><ul>
<li><code>gmake</code> ç¼–è¯‘:<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gmake CFLAGS=&quot;-I/usr/local/include&quot; LDFLAGS=&quot;-L/usr/local/lib&quot;</span><br><span class="line">gmake install</span><br></pre></td></tr></table></figure></li>
<li><code>cmake</code> ç¼–è¯‘:<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake -DCMAKE_INSTALL_PREFIX=/usr/local -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl -DWITH_WEBSOCKETS=ON -E env LDFLAGS=&quot;-L/usr/local/lib&quot; -DCMAKE_C_FLAGS=&quot;-I/usr/local/include&quot; ../mosquitto</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h2 id="ç¼–è¯‘-mosquitto-go-auth"><a href="#ç¼–è¯‘-mosquitto-go-auth" class="headerlink" title="ç¼–è¯‘ mosquitto-go-auth"></a>ç¼–è¯‘ mosquitto-go-auth</h2></li>
</ul>
<h3 id="å®‰è£…ä¾èµ–ï¼š-1"><a href="#å®‰è£…ä¾èµ–ï¼š-1" class="headerlink" title="å®‰è£…ä¾èµ–ï¼š"></a>å®‰è£…ä¾èµ–ï¼š</h3><ul>
<li><code>go</code> ç¼–è¯‘å·¥å…·ï¼Œæ­¤ä¸º<code>golang</code>æºç </li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pkg install go</span><br></pre></td></tr></table></figure>
<h3 id="é…ç½®å›½å†…æº"><a href="#é…ç½®å›½å†…æº" class="headerlink" title="é…ç½®å›½å†…æº"></a>é…ç½®å›½å†…æº</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">go env -w GO111MODULE=on</span><br><span class="line">go env -w GOPROXY=https://goproxy.cn,direct</span><br></pre></td></tr></table></figure>
<h3 id="ç¼–è¯‘-2"><a href="#ç¼–è¯‘-2" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gmake</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>mosquitto</tag>
        <tag>mqtt</tag>
        <tag>PostgreSQL</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¼–è¯‘opencore-amr for iOS8å¹¶æ”¯æŒbitcode</title>
    <url>/2017/01/05/build-opencore-amr/</url>
    <content><![CDATA[<h1 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h1><p><code>amr</code> æ˜¯ä¸€ä¸ªå¾ˆé€‚åˆåœ¨çº¿ä¼ è¾“çš„éŸ³é¢‘æ ¼å¼ã€‚ä½†æ‚²æ‘§çš„æ˜¯<code>apple</code>æ—©å°±ä¸æ”¯æŒå®ƒäº†ã€‚åŸå› ä¸æ˜ã€‚</p>
<p>å¦ä¸€å±‚æ˜¯å¾®ä¿¡ä¹Ÿæ˜¯ä½¿ç”¨çš„è¿™ç§æ ¼å¼æ¥å½•åˆ¶éŸ³é¢‘ã€‚</p>
<p>ä¸åª<code>apple</code>ä¸æ”¯æŒå®ƒï¼Œä¸‡èƒ½çš„<code>cocoapods</code>ä¹Ÿæ²¡æœ‰æ”¯æŒçš„ã€‚åªå¥½è‡ªå·±åŠ¨æ‰‹äº†ã€‚</p>
<p>æ­¢äºå½“å‰ï¼Œæˆ‘æ‰¾åˆ°æœ€åˆé€‚çš„ï¼Œå°±æ˜¯<code>opencore-amr</code>åº“ã€‚è¿™ä¸ªåº“12å¹´å†™å°±ã€‚è¿™ä¹ˆå¤šå¹´ä¹Ÿæ²¡è§æ€ä¹ˆæ›´æ–°ã€‚[æ‚è„¸]ğŸ˜‚</p>
<p>æ‰¾åˆ°äº†ä¸€ä¸ªå¥½å¿ƒäººå†™çš„æ”¯æŒ<code>bitcode</code>å’Œ8.0çš„ç¼–è¯‘è„šæœ¬</p>
<h1 id="åŸæ–™"><a href="#åŸæ–™" class="headerlink" title="åŸæ–™"></a>åŸæ–™</h1><p>github:<a class="link"   href="https://github.com/feuvan/opencore-amr-iOS" >opencore-amr-IOS<i class="fas fa-external-link-alt"></i></a></p>
<p>sourceforge:<a class="link"   href="https://sourceforge.net/projects/opencore-amr/files/opencore-amr/opencore-amr-0.1.3.tar.gz/download" >opencore-amr 0.1.3<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="ç¼–è¯‘è„šæœ¬"><a href="#ç¼–è¯‘è„šæœ¬" class="headerlink" title="ç¼–è¯‘è„šæœ¬"></a>ç¼–è¯‘è„šæœ¬</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> -xe</span><br><span class="line"></span><br><span class="line">VERSION=<span class="string">&quot;0.1.3&quot;</span></span><br><span class="line">SDKVERSION=<span class="string">&quot;8.4&quot;</span></span><br><span class="line">LIBSRCNAME=<span class="string">&quot;opencore-amr&quot;</span></span><br><span class="line"></span><br><span class="line">CURRENTPATH=`<span class="built_in">pwd</span>`</span><br><span class="line"></span><br><span class="line">mkdir -p <span class="string">&quot;<span class="variable">$&#123;CURRENTPATH&#125;</span>/src&quot;</span></span><br><span class="line">tar zxvf <span class="variable">$&#123;LIBSRCNAME&#125;</span>-<span class="variable">$&#123;VERSION&#125;</span>.tar.gz -C <span class="string">&quot;<span class="variable">$&#123;CURRENTPATH&#125;</span>/src&quot;</span></span><br><span class="line"><span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$&#123;CURRENTPATH&#125;</span>/src/<span class="variable">$&#123;LIBSRCNAME&#125;</span>-<span class="variable">$&#123;VERSION&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">DEVELOPER=`xcode-select -print-path`</span><br><span class="line">DEST=<span class="string">&quot;<span class="variable">$&#123;CURRENTPATH&#125;</span>/lib-ios&quot;</span></span><br><span class="line">mkdir -p <span class="string">&quot;<span class="variable">$&#123;DEST&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">ARCHS=<span class="string">&quot;armv7 armv7s arm64 i386 x86_64&quot;</span></span><br><span class="line"><span class="comment"># ARCHS=&quot;armv7&quot;</span></span><br><span class="line">LIBS=<span class="string">&quot;libopencore-amrnb.a libopencore-amrwb.a&quot;</span></span><br><span class="line"></span><br><span class="line">DEVELOPER=`xcode-select -print-path`</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> arch <span class="keyword">in</span> <span class="variable">$ARCHS</span>; <span class="keyword">do</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$arch</span> <span class="keyword">in</span></span><br><span class="line">arm*)</span><br><span class="line"></span><br><span class="line">IOSV=<span class="string">&quot;-miphoneos-version-min=7.0&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$arch</span> == <span class="string">&quot;arm64&quot;</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">IOSV=<span class="string">&quot;-miphoneos-version-min=7.0&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Building for iOS <span class="variable">$arch</span> ****************&quot;</span></span><br><span class="line">SDKROOT=<span class="string">&quot;<span class="subst">$(xcrun --sdk iphoneos --show-sdk-path)</span>&quot;</span></span><br><span class="line">CC=<span class="string">&quot;<span class="subst">$(xcrun --sdk iphoneos -f clang)</span>&quot;</span></span><br><span class="line">CXX=<span class="string">&quot;<span class="subst">$(xcrun --sdk iphoneos -f clang++)</span>&quot;</span></span><br><span class="line">CPP=<span class="string">&quot;<span class="subst">$(xcrun -sdk iphonesimulator -f clang++)</span>&quot;</span></span><br><span class="line">CFLAGS=<span class="string">&quot;-isysroot <span class="variable">$SDKROOT</span> -arch <span class="variable">$arch</span> <span class="variable">$IOSV</span> -isystem <span class="variable">$SDKROOT</span>/usr/include -fembed-bitcode&quot;</span></span><br><span class="line">CXXFLAGS=<span class="variable">$CFLAGS</span></span><br><span class="line">CPPFLAGS=<span class="variable">$CFLAGS</span></span><br><span class="line"><span class="built_in">export</span> CC CXX CFLAGS CXXFLAGS CPPFLAGS</span><br><span class="line"></span><br><span class="line">./configure \</span><br><span class="line">--host=arm-apple-darwin \</span><br><span class="line">--prefix=<span class="variable">$DEST</span> \</span><br><span class="line">--disable-shared --enable-static</span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">IOSV=<span class="string">&quot;-mios-simulator-version-min=7.0&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Building for iOS <span class="variable">$arch</span>*****************&quot;</span></span><br><span class="line"></span><br><span class="line">SDKROOT=`xcodebuild -version -sdk iphonesimulator Path`</span><br><span class="line">CC=<span class="string">&quot;<span class="subst">$(xcrun -sdk iphoneos -f clang)</span>&quot;</span></span><br><span class="line">CXX=<span class="string">&quot;<span class="subst">$(xcrun -sdk iphonesimulator -f clang++)</span>&quot;</span></span><br><span class="line">CPP=<span class="string">&quot;<span class="subst">$(xcrun -sdk iphonesimulator -f clang++)</span>&quot;</span></span><br><span class="line">CFLAGS=<span class="string">&quot;-isysroot <span class="variable">$SDKROOT</span> -arch <span class="variable">$arch</span> <span class="variable">$IOSV</span> -isystem <span class="variable">$SDKROOT</span>/usr/include -fembed-bitcode&quot;</span></span><br><span class="line">CXXFLAGS=<span class="variable">$CFLAGS</span></span><br><span class="line">CPPFLAGS=<span class="variable">$CFLAGS</span></span><br><span class="line"><span class="built_in">export</span> CC CXX CFLAGS CXXFLAGS CPPFLAGS</span><br><span class="line">./configure \</span><br><span class="line">--prefix=<span class="variable">$DEST</span> \</span><br><span class="line">--disable-shared</span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line">make &gt; /dev/null</span><br><span class="line">make install</span><br><span class="line">make clean</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$LIBS</span>; <span class="keyword">do</span></span><br><span class="line">mv <span class="variable">$DEST</span>/lib/<span class="variable">$i</span> <span class="variable">$DEST</span>/lib/<span class="variable">$i</span>.<span class="variable">$arch</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$LIBS</span>; <span class="keyword">do</span></span><br><span class="line">input=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> arch <span class="keyword">in</span> <span class="variable">$ARCHS</span>; <span class="keyword">do</span></span><br><span class="line">input=<span class="string">&quot;<span class="variable">$input</span> <span class="variable">$DEST</span>/lib/<span class="variable">$i</span>.<span class="variable">$arch</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">lipo -create -output <span class="variable">$DEST</span>/lib/<span class="variable">$i</span> <span class="variable">$input</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="ç¼–è¯‘æ–¹å¼"><a href="#ç¼–è¯‘æ–¹å¼" class="headerlink" title="ç¼–è¯‘æ–¹å¼"></a>ç¼–è¯‘æ–¹å¼</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt; mkdir opencore-amr</span><br><span class="line">&gt; <span class="built_in">cd</span> opencore-amr</span><br><span class="line">&gt; <span class="comment">#æŠŠä¸Šæ–¹çš„è„šæœ¬å†…å®¹æ”¾åˆ°build.shä¸­ã€‚å»ä¸‹è½½0.1.3ç‰ˆçš„åŒ…ï¼Œå¼„æˆä¸‹è¾¹çš„æ ·å­</span></span><br><span class="line">&gt; ls</span><br><span class="line">build.sh				opencore-amr-0.1.3.tar.gz</span><br><span class="line">&gt; bash build.sh</span><br><span class="line">&gt; .....</span><br><span class="line">&gt; <span class="comment">#å®Œäº‹åæœå­åœ¨ï¼šlib-iosæ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">&gt; ls</span><br><span class="line">  build.sh			lib-ios				opencore-amr-0.1.3.tar.gz	src</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>xcode</tag>
        <tag>opencore-amr</tag>
        <tag>amr</tag>
        <tag>ios</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP Swoole ä»å…¥é—¨åˆ°æ”¾å¼ƒ</title>
    <url>/2017/06/20/byebye-swoole/</url>
    <content><![CDATA[<p>è¢«Swooleæ–‡æ¡£ä¸Šå„ç§â€œé«˜XXâ€è¯´å¾—å£æ°´æµäº†ä¸€åœ°ã€‚å¤©çœŸçš„æˆ‘ï¼Œå†³å®šèŠ±äº›æ—¶é—´ï¼ŒæŠŠè‡ªå·±é¡¹ç›®çš„æ–°ä¸šåŠ¡è¿ç§»åˆ°swooleå¹³å°ä¸Šæ¥ã€‚</p>
<blockquote>
<p>ä»Šå¤©è°¨ä»¥æ­¤æ–‡çºªå¿µæˆ‘ä¸ºäº†swooleè€Œé€å»çš„æ—¶å…‰ï¼</p>
</blockquote>
<p>ä»¥ä¸‹æ˜¯è¿™æ®µæ—¶é—´ä»¥æ¥å°è¯•è¿‡ç¨‹ä¸­çš„å„ç§ç—›ï¼š</p>
<hr>
<blockquote>
<p>é«˜å¯ç”¨ã€‚å¯ä»¥é€šè¿‡ç»™ä¸»è¿›ç¨‹å‘USR1ä¿¡å·æ¥çƒ­æ›´æ–°ä»£ç ï¼Œè¿‡ç¨‹å¾ˆä¼˜é›…ã€‚æˆ‘åªè¦ä¸€ä¸ªä¿¡å·å°±å…¨GETåˆ°äº†ã€‚</p>
</blockquote>
<ul>
<li>äº‹å®ä¸Šã€‚è¿™æœ‰ä¸ªè›‹ç–¼çš„å‰æï¼šä½ å¿…é¡»å…ˆæŠŠserveræ®µçš„ä»£ç ä¸workeræ®µçš„ä¸šåŠ¡ä»£ç åˆ†å¼€ã€‚å› ä¸ºwokeré‡å¯åï¼Œåªèƒ½reload å¯åŠ¨åincludeè¿›æ¥çš„ä»£ç ã€‚è¿™å°±æ“äº†å¤§è›‹äº†ã€‚</li>
</ul>
<hr>
<blockquote>
<p>é«˜æ•ˆç¼–ç ã€‚æä¾›äº†åç¨‹ï¼Œå¯ä»¥ç”¨åŒæ­¥çš„ä»£ç ï¼Œå¾—åˆ°å¼‚æ­¥çš„å–„æœï¼nodejsè¿˜è¦async/awaitä¸€ä¸‹å‘¢ï¼</p>
</blockquote>
<ul>
<li>äº‹å®ä¸Šã€‚ä½¿ç”¨åç¨‹æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼</li>
</ul>
<ol>
<li>åªèƒ½åœ¨æŒ‡å®šçš„åœ°æ–¹ä½¿ç”¨ï¼Œè¦æ˜¯åœ¨åˆ«çš„åœ°æ–¹ä½¿ç”¨ï¼Œå¾—ç”¨ä¸ªå›è°ƒï¼ŒæŠŠä»£ç åŒ…èµ·æ¥ã€‚ä¸ä¾¿ä¸å…¶å®ƒä¸šåŠ¡ä»£ç éš”ç¦»å¼€ï¼</li>
<li>åªèƒ½ä½¿ç”¨æä¾›çš„å‡ æ ·ä¸œè¥¿ã€‚ç”¨å¼€å‘è€…çš„è¯è¯´ï¼šç¼“å­˜åªèƒ½ä½¿ç”¨redisï¼Œæ•°æ®åº“åªèƒ½ç”¨mysqlã€‚</li>
</ol>
<ul>
<li>è¿™é‡Œè¿˜æœ‰æ›´å¤šå…¶å®ƒè›‹ç–¼çš„äº‹ï¼š</li>
</ul>
<ol>
<li>worker ä¸­ä¸èƒ½ä½¿ç”¨åŒæ­¥ä»£ç ã€‚å› ä¸ºå®ƒä¼šé˜»å¡æ•´ä¸ªå®Œç¾çš„workerè¿›ç¨‹ã€‚é¡¿æ—¶PHPçš„å¾ˆå¤šçš„ç¬¬ä¸‰æ–¹åº“æˆäº†åºŸç‰©ã€‚å³ä¾¿è¦ç”¨ï¼Œä¹Ÿè¦ä¸¢åˆ°taskè¿›ç¨‹ä¸­å»ã€‚</li>
<li>task è¿›ç¨‹æœ‰é˜Ÿåˆ—ï¼Œä½†æ˜¯ï¼Œå®ƒåªåšäº†å†…éƒ¨ç§æœ‰å°è£…äº†çš„é˜Ÿåˆ—ã€‚è¿˜æå‡ºäº†è‹¥å¹²æ¡ä¸æ¸…ä¸æ¥šçš„ä½¿ç”¨æ—¶çš„é™åˆ¶ã€‚å¦‚æœä»»åŠ¡å¤±è´¥ï¼Œè‡ªå·±ä¸æ”¶é›†ï¼Œå°±æ— æ³•é‡ç°ã€‚å¦‚æœå®•æœºï¼Œæ‰€æœ‰é˜Ÿåˆ—é‡Œçš„äº‹ï¼Œå…¨äº†äº†è´¦ã€‚é˜Ÿåˆ—é‡Œçš„äº‹åŠ¡ä¹Ÿéƒ½æˆäº†æ‚¬æ¡ˆã€‚è¿™ä¸€ç‚¹ä¸laravelçš„é˜Ÿåˆ—æ¯”èµ·æ¥ï¼Œå¯ç”¨æ€§å·®å¾—å¤ªTMè¿œäº†ï¼</li>
<li>é€ƒä¸è¿‡çš„å›è°ƒã€‚å…¶å®PHPå…¶å®ƒæ‰©å±•ä¹Ÿæœ‰å¼‚æ­¥çš„ï¼Œè­¬å¦‚ï¼šext-pgsqlã€‚å¯ä»¥ç”¨swooleçš„Eventç›‘å¬pgsqlçš„socketå¯è·å¾—å…¼å®¹çš„å¼‚æ­¥ï¼Œä½†å›è°ƒçš„é—®é¢˜å°±å›æ¥äº†ã€‚swooleé‡è¦çš„æœåŠ¡å®šä¹‰ä¹Ÿæ˜¯å…¨ç¨‹ç”¨å›è°ƒçš„ã€‚åŒ…æ‹¬worker/task/server/processè¿™äº›å¯¹è±¡ç”Ÿå‘½å‘¨æœŸã€‚</li>
<li>ä¸å…¼å®¹ã€‚ä½¿ç”¨swooleçš„åç¨‹ï¼Œå…¶å®ƒä¸è¶³ä¸èƒ½ç”¨å…¶å®ƒçš„å¼‚æ­¥PHPåº“åšå¼¥è¡¥ï¼Œå› ä¸ºå®ƒä»¬å„è‡ªçš„event-loopä¸åŒã€‚è¿™ä¸€ç‚¹æ€ªä¸å¾—swooleå¼€å‘è€…ã€‚å¦‚æœå…±ç”¨ï¼Œä¸æ˜¯é€šæ™“åº•å±‚çš„å¤§å¸ˆçº§æ“åˆ€ï¼Œä¼šå‡ºç°å„ç§ç¨€å¥‡å¤æ€ªçš„é—®é¢˜ã€‚</li>
<li>åŠŸèƒ½å¼±ã€‚è¿™ä¸€ç‚¹ä¸»è¦è¡¨ç°åœ¨websocket Serverè¿™ä¸ªå¯¹è±¡ä¸Šã€‚swooleçš„websocketã€‚å£°ç§°è‡ªåŠ¨çš„æ¡æ‰‹ä½¿ç”¨çš„æ˜¯XXåè®®ã€‚ä½†ä¸æ”¯æŒä½¿ç”¨websocketçš„å†…éƒ¨çš„â€œåè®®â€ã€‚å¦‚æœå¸¦ä¸Šåè®®åï¼Œå°±ä¼šæ‹’ç»ã€‚å¹¶ä¸”è¿˜æœ‰ä¸ªè®©äººè›‹ç–¼ï¼å¦‚æœè‡ªå·±å®ç°æ¡æ‰‹åè®®ï¼Œåœ¨å¾ˆå¤šç‰ˆæœ¬ä¸­ï¼Œå®ƒä¼šè‡ªåŠ¨åœ°åœ¨è¿”å›çš„headerä¸­åŠ å…¥å…¶å®ƒçš„å¤´ï¼Œå¯¼è‡´è¢«å®¢æˆ·ç«¯æ‹’ç»ï¼è¿™ä¸€ç‚¹å¼€å‘è€…å¯¹æ­¤æ— èƒ½ä¸ºåŠ›ï¼Œå› ä¸ºswooleçš„responseå¯¹è±¡ä¸­çš„headerï¼Œå¼€å‘è€…åªèƒ½åŠ ï¼Œä¸èƒ½æ”¹ï¼Œä¸èƒ½åˆ ã€‚å®ƒè¿˜ä¸æ”¯æŒacceptã€‚ä»€ä¹ˆæ ·æ¥è·¯çš„è¯·æ±‚éƒ½æ˜¯ç›´æ¥åˆ°æ¡æ‰‹ï¼Œå¦‚æœè¦æ‹’ç»acceptä¸€äº›ä¸åˆæ³•çš„æ¥æºéƒ½ä¸èƒ½è½»æ˜“åšåˆ°ã€‚</li>
<li>å¥‡è‘©çš„å¼‚æ­¥http clientã€‚è®¾è®¡å¾—è¿˜æ˜¯æ»¡å¥½çš„ã€‚ä½†ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œä½¿ç”¨å®ƒè¯·æ±‚è…¾è®¯çš„æœåŠ¡å™¨ï¼Œå°±æ˜¯ä¸ç¨³å®šã€‚40%ä¼šè¢«æ‹’ã€‚ä½†å¦‚æœä½¿ç”¨nodejs çš„ requestã€‚å°±èƒ½åšåˆ°100%ç¨³å®šï¼</li>
</ol>
<hr>
<blockquote>
<p>äºŒè¿›åˆ¶åˆ†å‘ã€‚ä¸€æ¬¡ç¼–è¯‘åˆ†å‘åˆ°å„ç§å¹³å°ã€‚</p>
</blockquote>
<ul>
<li>ä¸€æ¥ï¼Œåˆ†å‘çš„éœ€æ±‚ä¸å¤§ã€‚ä¸åŒçš„ç¯å¢ƒéœ€è¦ä¸åŒçš„å®šåˆ¶ï¼ŒæœåŠ¡å™¨ç¯å¢ƒä¸å¼€å‘ç¯å¢ƒçš„é…ç½®æ³¨å®šä¸èƒ½å®Œå…¨ç›¸åŒã€‚</li>
<li>äºŒæ¥ï¼Œç¼–è¯‘èµ·æ¥å°±å‘æ­»äººäº†ã€‚ç®€å•ç¼–è¯‘å¾ˆå¤šâ€œé«˜XXâ€çš„ä¸œè¥¿å¾—ä¸åˆ°ã€‚å¦‚æœç¼–è¯‘çš„ç³»ç»Ÿæœ‰ç±»åº“ç¼ºå¤±ï¼Œåœ¨configureä¸­ä¸ä¼šä¸­æ­¢ï¼Œåªä¼šåœ¨checkçš„æ—¶å€™æ”¾ä¸ªå°å°çš„â€™noâ€™ç»“å°¾ã€‚ä¸‰ä¸ªä¸åŒçš„ç³»ç»Ÿå¹³å°ä¸Šç¼–è¯‘ä¸€ä¸‹ï¼ŒåŒ…ä½ çœ¼èŠ±ã€‚PHPerå¯¹Cçš„makeäº†è§£å¹¶ä¸æ·±ï¼Œå¾ˆéš¾ç¼–è¯‘å‡ºä¸€ä¸ªçœŸæ­£æ»¡æ„çš„ç»“æœã€‚ç¼ºå¤±ç±»åº“çš„æƒ…å†µä¸‹ç¼–è¯‘å‡ºçš„soæ–‡ä»¶ï¼Œæ”¾åˆ°PHPé‡Œåï¼Œä¸€è¿è¡Œï¼ŒPHPå°±ä¼šå‡ºä¸€ä¸ª<code>segmentfault</code>ã€‚å¹¶ä¸”æœ‰äº›ç¬¬ä¸‰æ–¹åº“è¦åˆ°æ”¾æºç å†…éƒ¨ç¼–è¯‘ï¼Œæœ‰çš„æ˜¯åœ¨å¤–éƒ¨å•ç‹¬ç¼–è¯‘å®‰è£…ã€‚å…¶ä¸­<code>jemalloc</code>åº“ç¼–è¯‘çš„æ—¶å€™è¿˜å¾—åŠ ä¸Šä¸“é—¨ä¸ºæ”¯æŒswooleè€Œç”¨çš„å‡½æ•°å‰ç¼€ã€‚è€Œæ–‡æ¡£å¯¹è¿™é‡Œè®²è§£ï¼Œæˆ‘å°±â€œå‘µå‘µâ€äº†ã€‚</li>
</ul>
<hr>
<blockquote>
<p>ç¤¾åŒºåŠæ”¯æŒ</p>
</blockquote>
<ul>
<li>å“ï¼ä»Šå¤©æˆ‘å°±æ˜¯åœ¨githubçš„issueé‡ŒæŠŠswooleéª‚ä¸Šå¤©ï¼Œææ€•å‚²æ…¢çš„å¼€å‘è€…ä¹Ÿæœªå¿…èƒ½çœ‹åˆ°æˆ‘ï¼è™½ç„¶swooleé¡¹ç›®å¤©å¤©æœ‰æ›´æ–°ï¼Œä½†swooleå¼€å‘è€…æ˜¯åœ¨åšä»–è‡ªå·±çš„äº‹ã€‚æˆ‘ä»¬swooleçš„ç”¨æˆ·å¦‚åŒè‹è‡ï¼</li>
</ul>
]]></content>
      <tags>
        <tag>PHP</tag>
        <tag>Swoole</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨FreeBSD12ä¸Šç¼–è¯‘PostgreSQL12</title>
    <url>/2019/10/23/build-postgresql12-on-freebsd12/</url>
    <content><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="åœ¨PostgreSQL12æºç é‡Œè¿è¡Œ-configureæŠ¥ï¼š"><a href="#åœ¨PostgreSQL12æºç é‡Œè¿è¡Œ-configureæŠ¥ï¼š" class="headerlink" title="åœ¨PostgreSQL12æºç é‡Œè¿è¡Œ ./configureæŠ¥ï¼š"></a>åœ¨<code>PostgreSQL12</code>æºç é‡Œè¿è¡Œ <code>./configure</code>æŠ¥ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">checking <span class="keyword">for</span> readline.h... no</span><br><span class="line">configure: error: readline header not found</span><br></pre></td></tr></table></figure>
<p>ä¸”<code>readline</code>åº“å·²ç»å®‰è£…è¿‡äº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pkg info readline</span></span><br><span class="line">readline-8.0.0</span><br><span class="line">Name           : readline</span><br><span class="line">Version        : 8.0.0</span><br></pre></td></tr></table></figure>
<p>åŸå› æ˜¯ï¼š<code>/usr/local/lib</code>å’Œ<code>/usr/local/include</code>ä¸åœ¨<code>configure</code>è„šæœ¬çš„æœç´¢è·¯å¾„ä¸­ã€‚<br>å¯ä»¥é€šè¿‡<code>--with-includes</code>é…ç½®é¡¹åŠ å…¥è¿›å»å°±å¥½äº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./configure --with-includes=/usr/<span class="built_in">local</span>/include --with-libraries=/usr/<span class="built_in">local</span>/lib</span><br></pre></td></tr></table></figure>
<h3 id="llvm-configæ‰¾ä¸åˆ°"><a href="#llvm-configæ‰¾ä¸åˆ°" class="headerlink" title="llvm-configæ‰¾ä¸åˆ°"></a><code>llvm-config</code>æ‰¾ä¸åˆ°</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pkg install llvm90</span><br><span class="line"></span><br><span class="line">ln -s /usr/<span class="built_in">local</span>/bin/llvm-config90 /usr/<span class="built_in">local</span>/bin/llvm-config</span><br></pre></td></tr></table></figure>
<h2 id="å®Œæ•´æ„å»º"><a href="#å®Œæ•´æ„å»º" class="headerlink" title="å®Œæ•´æ„å»º"></a>å®Œæ•´æ„å»º</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./configure --with-libraries=/usr/<span class="built_in">local</span>/lib --with-includes=/usr/<span class="built_in">local</span>/include --enable-thread-safety --disable-debug --with-openssl --with-llvm --prefix=/usr/<span class="built_in">local</span>/pg12 --localstatedir=/var --build=amd64-bluse-freebsd12.0 build_alias=amd64-bluse-freebsd12.0 --with-uuid=bsd --with-icu --enable-nls=<span class="string">&#x27;zh_CN&#x27;</span></span><br><span class="line">make world</span><br><span class="line">make install-world</span><br></pre></td></tr></table></figure>
<ul>
<li><code>--enable-thread-safety</code> çº¿ç¨‹å®‰å…¨</li>
<li><code>--disable-debug</code> ç¦ç”¨debugï¼Œè¯¥æ˜¯æœ‰åŠ©äºæå‡ç”Ÿäº§æ—¶è¿è¡Œæ€§èƒ½</li>
<li><code>--with-openssl</code> æ”¯æŒåŠ å¯†ä¼ è¾“</li>
<li><code>--with-llvm</code> æ”¯æŒå³æ—¶ç¼–è¯‘ï¼Œä½¿å¾—åœ¨å¤„ç†å¤æ‚ä»»åŠ¡æ—¶ï¼Œæ€§èƒ½æœ‰æœ›å†æå‡20%ï½30%</li>
<li><code>--build</code> ç¼–è¯‘å¹³å°ï¼Œæ ¼å¼ï¼šç¡¬ä»¶å¹³å°-ç¼–è¯‘æ–¹-ç³»ç»Ÿå¹³å°ã€‚å¦‚ï¼šâ€œx86_64-myName-freebsd12.0â€</li>
<li><code>build_alias</code> ç¼–è¯‘å¹³å°åˆ«å</li>
<li><code>--with-uuid</code> åœ¨<code>FreeBSD</code>ä¸Šé€‰æ‹©<code>bsd</code>åº”è¯¥æ˜¯æœ€åˆé€‚çš„</li>
<li><code>--with-icu</code> æ”¯æŒæ’åºï¼Œä¾èµ–<code>pkgconf</code>åŒ…</li>
<li><code>--enable-nls</code> è½¯ä»¶æœ¬åœ°åŒ–ã€‚å¯æŒ‡å®šå¤šç§è¯­è¨€ã€‚ä¾èµ–<code>GNU</code>çš„<code>gettext</code></li>
</ul>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>FreeBSD</tag>
      </tags>
  </entry>
  <entry>
    <title>daemontoolsç³»åˆ—å°å·¥å…·</title>
    <url>/2017/06/17/daemontools/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸ºä»€ä¹ˆè¦è®²ä¸€ä¸ªå¦‚æ­¤â€å¤è€â€çš„å®ˆæŠ¤å·¥å…·ï¼Ÿä¸ºä»€ä¹ˆä¸ç”¨supervisordï¼Ÿ</p>
<p><code>supervisord</code> æœ‰ä¸ªé—®é¢˜ç–¼æ­»æˆ‘äº†ã€‚ä¸€è¿œç¨‹ç®¡ç†ä¸€ä¸‹å®ƒå®ˆæŠ¤ä¸‹çš„è¿›ç¨‹ï¼Œ<a class="link"   href="https://github.com/Supervisor/supervisor/issues/807" >CPUå°±ä¼š100%<i class="fas fa-external-link-alt"></i></a>ã€‚è¿™ä¸ªé—®é¢˜å¹´ä¹…å¤±ä¿®ã€‚</p>
<p>å®ƒçš„supervisorctlé‡Œçš„æŒ‡ä»¤ï¼Œå¸¸reloadä¸€ä¸‹ä¼šè®©æ‰€æœ‰çš„æœåŠ¡æ­»äº†ï¼Œè‡ªå·±ä¹Ÿæ­»äº†ï¼ä¹Ÿä¸é‡å¯ï¼Œå¾—æ‰‹åŠ¨é‡å¯ã€‚</p>
<p>æ›´è®©äººæªå¿ƒçš„æ˜¯ï¼Œå½“ä¸šåŠ¡è´Ÿè½½ç¹é‡æ—¶ï¼Œè¿™ä¸ªå·¥å…·å°±æˆäº†â€ä»™äººæŒâ€ï¼Œç¢°ä¸å¾—ï¼Œå‰æ®µæ—¶é—´å‘ç°ä¸€æ¬¡åŠå¤œé‡Œæ— ç«¯åœ°æŒç»­äº†2ä¸ªå¤šå°æ—¶æŠŠCPUæåˆ°äº†100%ã€‚</p>
<p>ç”¨äº†å®ƒå¯è®©é˜¿é‡Œäº‘ç ´è´¹äº†ä¸å°‘çŸ­ä¿¡è´¹ã€‚å¤©å¤©æœ‰è­¦å‘Šï¼</p>
<p>ä¸å¾—å·²å†èŠ±äº›æ—¶é—´å­¦ä¹ äº†ä¸€ä¸‹å…¶å®ƒçš„å®ˆæŠ¤å·¥å…·äº†ã€‚è¿™ä¸ªdaemontoolsåè€ï¼Œçœ‹ä¸Šå»æ›´ç¨³å¦¥ã€‚</p>
<p>ä»¥ä¸‹å®æ“åŸºäºFreeBSD11ï¼ˆLinuxæœ‰systendï¼Œå®ˆæŠ¤å˜å˜çš„ï¼ï¼‰</p>
<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p><a class="link"   href="http://cr.yp.to/daemontools.html" >Daemontools<i class="fas fa-external-link-alt"></i></a>æ˜¯ç®¡ç†UnixæœåŠ¡çš„å·¥å…·ï¼Œå®ƒæä¾›ä¸€ç»„å·¥å…·æ¥ç®¡ç†ä¸€ç³»åˆ—ç”¨æˆ·è¿›ç¨‹ï¼Œå½“è¿›ç¨‹ç”±äºæŸäº›åŸå› downæ‰ä¹‹åï¼Œdaemontoolsä¼šè‡ªåŠ¨é‡å¯è¿›ç¨‹</p>
<h1 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h1><ul>
<li>è¢«ç®¡ç†çš„è¿›ç¨‹ä¸èƒ½ä»¥daemonå½¢å¼è¿è¡Œï¼Œä¾‹å¦‚nginx.conf å¿…é¡»å…³é—­daemonï¼Œ daemon off;</li>
<li>ä¸è¦åœ¨/var/service/å»ºä»»ä½•ç›®å½•ï¼Œ /var/service/åªå­˜æ”¾ä¸€äº›symbol link</li>
<li>åªéœ€è¦å®Œæˆå®‰è£… ã€ é…ç½®ä¸¤æ­¥å³å¯</li>
</ul>
<h1 id="å®‰è£…å¯åŠ¨"><a href="#å®‰è£…å¯åŠ¨" class="headerlink" title="å®‰è£…å¯åŠ¨"></a>å®‰è£…å¯åŠ¨</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pkg install daemontools</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;svscan_enable=&quot;YES&quot;&#x27;</span> &gt; /etc/rc.conf</span><br><span class="line">service svscan start</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨æˆåŠŸå¤šå‡ºäº†2ä¸ªè¿›ç¨‹ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">root  7616   0.0  0.1   8344  1676  -  S    10:28     0:00.04 /usr/local/bin/svscan /var/service</span><br><span class="line">root  7617   0.0  0.1   6240  1616  -  I    10:28     0:00.00 /usr/local/bin/readproctitle service errors: ......................................................................</span><br></pre></td></tr></table></figure>
<p><code>svscan</code>å¯åŠ¨åç›‘è§†<code>/var/service</code>ç›®å½•ï¼Œå½“è¿™é‡Œæœ‰æœåŠ¡çš„è½¯è¿æ¥æ—¶ï¼Œsvscanä¼šä¸ºæ¯ä¸ªæœåŠ¡ä¸»æ¸ä¸€ä¸ª<code>supervise</code>æœåŠ¡ã€‚<br><code>supervise</code> æ‰§è¡ŒæœåŠ¡ç›®å½•ä¸‹çš„<code>run</code>ï¼Œå¦‚æœæœåŠ¡ç›®å½•ä¸‹è¿˜æœ‰<code>down</code>æ–‡ä»¶å­˜åœ¨ï¼Œå°±ä¸ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œéœ€äººå·¥æ‰‹åŠ¨å¯åŠ¨æ­¤æœåŠ¡ã€‚</p>
<p><code>supervise</code>çš„çŠ¶æ€ä¿¡æ¯ä»¥2è¿›åˆ¶çš„å½¢å¼å­˜æ”¾åœ¨æœåŠ¡ç›®å½•çš„<code>supervise</code>ä¸‹é¢ï¼Œå¹¶ä¸”æä¾›äº†ä¸‹é¢çš„å·¥å…·æ¥æ“ä½œï¼š</p>
<ul>
<li>svstatï¼š è¯»å–çŠ¶æ€ä¿¡æ¯</li>
<li>svcï¼š å¯åŠ¨/åœæ­¢/æŒ‚èµ·ç­‰</li>
<li>svokï¼š æ£€æŸ¥æ˜¯å¦è¿è¡ŒæˆåŠŸ</li>
<li>svscanï¼šå¯é çš„å¯åŠ¨/var/serviceç›®å½•ä¸‹çš„æœåŠ¡ã€‚å¦‚æœæŸä¸ªæœåŠ¡åŠ å…¥åï¼Œæ²¡æœ‰å¯åŠ¨ï¼Œå¯ä»¥è°ƒç”¨æ­¤å‘½ä»¤ï¼Œå¼ºåˆ¶å¯åŠ¨ã€‚</li>
</ul>
<h1 id="æ·»åŠ æœåŠ¡"><a href="#æ·»åŠ æœåŠ¡" class="headerlink" title="æ·»åŠ æœåŠ¡"></a>æ·»åŠ æœåŠ¡</h1><h2 id="æ™®é€šæ·»åŠ "><a href="#æ™®é€šæ·»åŠ " class="headerlink" title="æ™®é€šæ·»åŠ "></a>æ™®é€šæ·»åŠ </h2><p>å…ˆåˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨çš„éœ€è¦è¢«å®ˆæŠ¤çš„é¡¹ç›®ã€‚æ”¾åˆ°ï¼š<code>/var/server/testprocess/</code></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">root@freebsd:/var/server/testprocess # ll</span><br><span class="line">total 12</span><br><span class="line">-rwxr-xr-x  1 root  wheel  122 Jun 17 10:30 main.py*</span><br><span class="line">-rwxr-xr-x  1 root  wheel  333 Jun 17 10:47 run*</span><br><span class="line">root@freebsd:/var/server/testprocess # cat main.py</span><br><span class="line">#!/usr/local/bin/python2</span><br><span class="line">import time</span><br><span class="line">import logging</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    time.sleep(1)</span><br><span class="line">    logging.warning(&quot;sleep 1 second&quot;)</span><br><span class="line"></span><br><span class="line">root@freebsd:/var/server/testprocess # cat run</span><br><span class="line">#!/bin/sh</span><br><span class="line">exec /usr/local/bin/python2 /var/server/testprocess/main.py &gt;&gt; /tmp/main.py.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨<code>/var/service</code>ç›®å½•ä¸‹å»ºç«‹è½¯é“¾æ¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@freebsd:/var/server/testprocess <span class="comment"># ln -s /var/server/testprocess /var/service/testprocess</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™å¯ä»¥æ£€æŸ¥ä¸€ä¸‹æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root  7618  0.0  0.1   6252  1632  -  I    10:28     0:00.00 supervise testprocess</span><br><span class="line">root  7747  0.0  0.4  39308  7416  -  S    10:48     0:00.72 &#x2F;usr&#x2F;local&#x2F;bin&#x2F;python2 &#x2F;var&#x2F;server&#x2F;testprocess&#x2F;main.py (python2.7)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ç§æ–¹å¼çš„åå¤„æ˜¯å¿…é¡»ä»¥rootç”¨æˆ·è¿è¡Œï¼Œå¦‚æœæƒ³ä»¥å…¶ä»–ç”¨æˆ·è¿è¡Œï¼Œåˆ™éœ€è¦åšå¦‚ä¸‹æ”¹è¿›ï¼Œå‡è®¾ç”¨æˆ·ä¸ºbluseï¼Œidä¸º1001ï¼š</p>
<h2 id="ä»¥æŒ‡å®šç”¨æˆ·èº«ä»½è¿è¡Œ"><a href="#ä»¥æŒ‡å®šç”¨æˆ·èº«ä»½è¿è¡Œ" class="headerlink" title="ä»¥æŒ‡å®šç”¨æˆ·èº«ä»½è¿è¡Œ"></a>ä»¥æŒ‡å®šç”¨æˆ·èº«ä»½è¿è¡Œ</h2><p>æ”¹è¿›ä¸€ä¸‹runçš„æ‰§è¡Œæ–¹å¼ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">root@freebsd:/var/server/testprocess # cat run</span><br><span class="line">#!/bin/sh</span><br><span class="line">who=`id -u`</span><br><span class="line">if [ $who -eq 0 ]; then</span><br><span class="line">    exec /usr/local/bin/setuidgid bluse /usr/local/bin/python2 /var/server/testprocess/main.py &gt;&gt; /tmp/main.py.log 2&gt;&amp;1</span><br><span class="line">elif [ $who -eq 1001 ]; then</span><br><span class="line">    exec /usr/local/bin/python2 /var/server/service/testprocess/main.py &gt;&gt; /tmp/main.py.log 2&gt;&amp;1</span><br><span class="line">else</span><br><span class="line">    echo &quot;neither root or bluse&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<p>å°±å¯ä»¥äº†</p>
<h1 id="ç®¡ç†æœåŠ¡"><a href="#ç®¡ç†æœåŠ¡" class="headerlink" title="ç®¡ç†æœåŠ¡"></a>ç®¡ç†æœåŠ¡</h1><p>ä½¿ç”¨svstatæ¥æŸ¥çœ‹æœåŠ¡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root@freebsd:&#x2F;var&#x2F;server&#x2F;testprocess # svstat &#x2F;var&#x2F;server&#x2F;testprocess&#x2F;</span><br><span class="line">&#x2F;var&#x2F;server&#x2F;testprocess&#x2F;: up (pid 7747) 2680 seconds</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨svcæ¥ç®¡ç†æœåŠ¡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NAME</span><br><span class="line">       svc - controls services monitored by supervise(8).</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">       svc [ -udopchaitkx ] services</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">       services consists of any number of arguments, each argument naming a</span><br><span class="line">       directory used by supervise(8).</span><br><span class="line"></span><br><span class="line">       svc applies all the options to each service in turn.</span><br><span class="line"></span><br><span class="line">OPTIONS</span><br><span class="line">       -u     Up. If the service is not running, start it. If the service</span><br><span class="line">              stops, restart it.</span><br><span class="line"></span><br><span class="line">       -d     Down. If the service is running, send it a TERM signal and then</span><br><span class="line">              a CONT signal. After it stops, do not restart it.</span><br><span class="line"></span><br><span class="line">       -o     Once. If the service is not running, start it. Do not restart it</span><br><span class="line">              if it stops.</span><br><span class="line"></span><br><span class="line">       -p     Pause. Send the service a STOP signal.</span><br><span class="line"></span><br><span class="line">       -c     Continue. Send the service a CONT signal.</span><br><span class="line"></span><br><span class="line">       -h     Hangup. Send the service a HUP signal.</span><br><span class="line"></span><br><span class="line">       -a     Alarm. Send the service an ALRM signal.</span><br><span class="line"></span><br><span class="line">       -i     Interrupt. Send the service an INT signal.</span><br><span class="line"></span><br><span class="line">       -t     Terminate. Send the service a TERM signal.</span><br><span class="line"></span><br><span class="line">       -k     Kill. Send the service a KILL signal.</span><br><span class="line"></span><br><span class="line">       -x     Exit.  supervise(8) will exit as soon as the service is down. If</span><br><span class="line">              you use this option on a stable system, you&#39;re doing something</span><br><span class="line">              wrong; supervise(8) is designed to run forever.</span><br></pre></td></tr></table></figure>
<h1 id="daemontools-ä¸­çš„å…¶å®ƒå·¥å…·"><a href="#daemontools-ä¸­çš„å…¶å®ƒå·¥å…·" class="headerlink" title="daemontools ä¸­çš„å…¶å®ƒå·¥å…·"></a>daemontools ä¸­çš„å…¶å®ƒå·¥å…·</h1><p>logå·¥å…·ï¼š</p>
<ul>
<li>The readproctitle program</li>
<li>The multilog program</li>
<li>The tai64n program</li>
<li>The tai64nlocal program</li>
</ul>
<p>ç¯å¢ƒå·¥å…·ï¼š</p>
<ul>
<li>The setuidgid program</li>
<li>The envuidgid program</li>
<li>The envdir program</li>
<li>The softlimit program</li>
<li>The setlock program</li>
</ul>
]]></content>
      <tags>
        <tag>FreeBSD</tag>
        <tag>daemontool</tag>
        <tag>supervisord</tag>
      </tags>
  </entry>
  <entry>
    <title>swift3å‡çº§åå±…ç„¶ä¸åšåå‘å…¼å®¹</title>
    <url>/2017/01/02/damned-xcode/</url>
    <content><![CDATA[<p>å‘æ­»çˆ¹äº†ï¼<code>apple</code>è¿™æ¬¡å‡çº§ä»ç³»ç»ŸOSåˆ°å¼€å‘å·¥å…·ï¼Œæ²¡ä¸€ä¸ªä¸æ˜¯åˆ°å¤„å‘äººã€‚</p>
<p>mac os 10ï¼Œå‡çº§åï¼Œä¸€æ’androidæ‰‹æœºå°±æ­»æœºï¼windowsè“å±ï¼Œå®ƒç™½å±ï¼</p>
<p>xcodeå‡çº§è‡³8åï¼Œä¸Šæ¥å°±è¦ç»™æˆ‘çš„é¡¹ç›®è½¬ç ï¼æƒ³ç€æˆ‘å¤§å°ä¹Ÿæ˜¯ä»˜è´¹ç”¨æˆ·ã€‚æ¯å¹´éƒ½äº¤ç€ä¼šè´¹å‘¢ï¼åº”è¯¥ç»™æˆ‘çš„å¾…é‡ä¸ä¼šå·®çš„ã€‚</p>
<p>æ²¡æˆæƒ³ï¼Œç‚¹å®ŒOKåã€‚æˆç™¾ä¸Šåƒä¸ªé”™ï¼é”™è¯¯æ•°é‡999+ï¼å®ƒå±…ç„¶ä¸åå‘å…¼å®¹ï¼è¯´å¥½çš„åªæ˜¯è¯­æ³•å˜åŠ¨ç‚¹çš„å˜›ï¼</p>
<p>æˆ‘è‡ªå·±çš„é¡¹ç›®ä»£ç å°±ç®—äº†ï¼Œå½“æ—¶alamofireï¼ŒSwiftyJSON ç­‰ç­‰ï¼Œæˆ‘æœ‰æ•°åä¸ªç¬¬ä¸‰æ–¹cocoapodåº“ï¼Œæ²¡ä¸€ä¸ªæ”¯æŒåˆ°swift3çš„ï¼Œå½“æ—¶å°±æ…Œäº†ç¥äº†ã€‚</p>
<p>æƒ³ç€æˆ‘è¿˜æœ‰SVNã€‚xcodeè¿™è´§å¯¹SVNçš„æ”¯æŒæ˜¯ä¸šä½™çº§çš„ã€‚è‡ªå¸¦çš„æäº¤éº»çƒ¦å°±ç®—äº†ã€‚ç‰ˆæœ¬è¿˜æ˜¯è€çš„ã€‚æå¾—æˆ‘æäº¤æ¬¡æ•°åˆå°‘ã€‚</p>
<p>ç°åœ¨ç½‘ä¸Šç¿»äº†ç¿»ï¼Œå¥½å¤šäººä¸ºäº†ç¨³å®šè¿˜åœ¨ç”¨ç€xcode7å‘¢ï¼è¿˜æ˜¯æˆ‘too young!too simple!</p>
<p>ä»¥æ­¤çºªå¿µæˆ‘ä¸Šè¿‡appleçš„å½“ï¼</p>
]]></content>
      <tags>
        <tag>xcode</tag>
        <tag>swift3</tag>
      </tags>
  </entry>
  <entry>
    <title>FFmpegè§†é¢‘è£å‰ª</title>
    <url>/2021/02/01/ffmpeg-resize/</url>
    <content><![CDATA[<p>è§†é¢‘è£å‰ªå°±æ˜¯é€‰ä¸­ä½ æƒ³è¦çš„çŸ©å½¢åŒºåŸŸå¹¶åªè¾“å‡ºè¿™ä¸ªåŒºåŸŸï¼Œå»æ±¡ä¸æ®‹ç•™ã€‚è£å‰ªé€šå¸¸å’Œå¤§å°è°ƒæ•´ï¼Œå¡«å……å’Œå…¶ä»–æ“ä½œä¸€èµ·ä½¿ç”¨ã€‚</p>
<h1 id="åŸºæœ¬è£åˆ‡å†…å®¹"><a href="#åŸºæœ¬è£åˆ‡å†…å®¹" class="headerlink" title="åŸºæœ¬è£åˆ‡å†…å®¹"></a>åŸºæœ¬è£åˆ‡å†…å®¹</h1><p>è€ç‰ˆæœ¬çš„FFmpegæœ‰<code>cropbottom</code>ã€<code>cropleft</code>ã€<code>cropright</code>ã€<code>croptop</code>å‡ ä¸ªæŒ‡ä»¤ï¼Œä½†æ˜¯ç°åœ¨è¿‡æ—¶äº†ã€‚è£å‰ªæ“ä½œç°åœ¨ä½¿ç”¨ä¸‹è¡¨æè¿°çš„<code>crop</code>æ»¤é•œã€‚</p>
<p><img src="https://user-images.githubusercontent.com/1764005/106429770-d9b79280-64a5-11eb-9531-c3673b9399bf.png" alt="image"></p>
<p><code>ow</code>çš„å€¼èƒ½å¤Ÿé€šè¿‡<code>oh</code>çš„å€¼æ¨å¯¼å¾—å‡ºï¼Œåä¹‹äº¦ç„¶ã€‚ä½†æ˜¯ä¸èƒ½é€šè¿‡<code>x</code>å’Œyæ¨å¯¼å¾—å‡ºï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨<code>ow</code>å’Œ<code>oh</code>ä¹‹åè¿›è¡Œæ±‚å€¼çš„ã€‚å¦å¤–<code>x</code>èƒ½å¤Ÿé€šè¿‡<code>y</code>æ¨å¯¼å¾—å‡ºï¼Œåä¹‹äº¦ç„¶ã€‚</p>
<p>å¥½æ‡µé€¼ã€‚å…ˆçœ‹äººå®¶ä¸¾çš„æ —å­ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ffmpeg -i input -vf crop=iw/3:ih:0:0 output</span><br><span class="line">ffmpeg -i input -vf crop=iw/3:ih:iw/3:0 output</span><br><span class="line">ffmpeg -i input -vf crop=iw/3:ih:iw/3*2:0 output</span><br></pre></td></tr></table></figure>
<p>ç»“æœè¿˜æ˜¯æ²¡æ˜ç™½äººå®¶ä»€ä¹ˆæ„æ€ã€‚å†çœ‹ä¸ªå›¾ï¼š<br><img src="https://user-images.githubusercontent.com/1764005/106429885-09669a80-64a6-11eb-9c9c-cc4846b40487.png" alt="image"></p>
<h1 id="ä¸­å¿ƒè£å‰ª"><a href="#ä¸­å¿ƒè£å‰ª" class="headerlink" title="ä¸­å¿ƒè£å‰ª"></a>ä¸­å¿ƒè£å‰ª</h1><p>å½“æˆ‘ä»¬è¿›è¡Œä¸­å¿ƒè£å‰ªæ“ä½œæ—¶ï¼Œå¯ä»¥è·³è¿‡<code>crop</code>æ»¤é•œ<code>x</code>å’Œ<code>y</code>å‚æ•°çš„è¾“å…¥ã€‚é»˜è®¤<code>x</code>å’Œ<code>y</code>çš„å€¼åˆ†åˆ«æ˜¯ï¼š<code>x_default = ( input width - output width)/2ï¼Œy_default = ( input height - output height)/2</code><br>è¿™æ„å‘³ç€ä¸­å¿ƒè£å‰ªæ—¶é»˜è®¤å€¼æ˜¯è‡ªåŠ¨è®¾ç½®çš„ã€‚é‚£ä¹ˆè£å‰ªä¸­å¿ƒåŒºåŸŸçš„è¯­æ³•æ˜¯ï¼š<code>ffmpeg -i input_file -vf crop=w:h output_file</code><br>ä¾‹å¦‚<code>ffmpeg -i input.mpg -vf crop=iw/2:ih/2 output.mp4</code>è¡¨ç¤ºä»¥ä¸­å¿ƒè£å‰ªçš„æ–¹å¼è£å‡ºå®½é«˜ä¸ºåŸè§†é¢‘ä¸€åŠçš„è§†é¢‘ã€‚</p>
]]></content>
      <tags>
        <tag>FFmpeg</tag>
        <tag>è§†é¢‘å‰ªè£</tag>
      </tags>
  </entry>
  <entry>
    <title>FreeBSD 11 ç£ç›˜ç©ºé—´æ‰©å®¹</title>
    <url>/2018/06/16/freebsd-disk-resize/</url>
    <content><![CDATA[<h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h2><p>é˜¿é‡Œäº‘ä¹°äº†ä¸ª60Gçš„ç³»ç»Ÿç›˜ECSã€‚è¿›å»ä¸€çœ‹åªæœ‰20Gï¼<br>åŸå› æ˜¯ï¼šå®ƒåˆ·é•œåƒæ—¶ï¼Œåªåˆ·äº†å‰è¾¹çš„20Gã€‚åè¾¹çš„40Gï¼Œå°±æˆäº†ç©ºç™½ã€‚ç»“æœäº¤åˆ°æˆ‘æ‰‹ä¸Šï¼Œå°±æˆäº†ä¸ªåŠæˆå“ã€‚<br>åªå¾—è‡ªå·±ç»™å®ƒæ‰©å®¹</p>
<p>åˆå§‹çŠ¶æ€ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@log:~ # df -h</span><br><span class="line">Filesystem                     Size    Used   Avail Capacity  Mounted on</span><br><span class="line">/dev/ufsid/59a7effe7885633c     19G    4.1G     14G    23%    /</span><br><span class="line">devfs                          1.0K    1.0K      0B   100%    /dev</span><br></pre></td></tr></table></figure>
<h3 id="ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹"><a href="#ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹"></a>ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@log:~ # gpart show</span><br><span class="line">=&gt;       63  125829057  vtbd0  MBR  (60G)</span><br><span class="line">         63          1         - free -  (512B)</span><br><span class="line">         64   41942975      1  freebsd  [active]  (20G)</span><br><span class="line">   41943039   83886081         - free -  (40G)</span><br></pre></td></tr></table></figure>
<p>çš„ç¡®æœ‰40Gçš„ç©ºç™½</p>
<h3 id="ç¬¬äºŒæ­¥ï¼šé‡ç½®å¤§å°"><a href="#ç¬¬äºŒæ­¥ï¼šé‡ç½®å¤§å°" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šé‡ç½®å¤§å°"></a>ç¬¬äºŒæ­¥ï¼šé‡ç½®å¤§å°</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@log:~ # gpart resize -i 1 -a 4k -s 59G vtbd0</span><br><span class="line">vtbd0s1 resized</span><br></pre></td></tr></table></figure>
<p><code>-i 1</code> è¿™é‡Œçš„<code>1</code>æ˜¯æŠ„å†™ <code>gpart show</code>ä¸­<code>vtbd0</code>ä¸€æ ä¸‹å½“å‰æ­£ä½¿ç”¨çš„ç£ç›˜çš„ç¼–å·<br><code>-s 59G</code> ä¸ºä»€ä¹ˆè¦ä¸¢æ‰ä¸€ä¸ªGï¼Ÿå› ä¸ºäº¤æ¢åˆ†åŒºéœ€è¦ç©ºé—´ã€‚</p>
<h3 id="ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œé…ç½®"><a href="#ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œé…ç½®" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œé…ç½®"></a>ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œé…ç½®</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@log:~ # service growfs onestart</span><br><span class="line">Growing root partition to fill device</span><br><span class="line">vtbd0s1 resized</span><br><span class="line">super-block backups (for fsck_ffs -b #) at:</span><br><span class="line"> 42314112, 43596352, 44878592, 46160832, 47443072, 48725312, 50007552, 51289792, 52572032, 53854272, 55136512, 56418752, 57700992, 58983232, 60265472, 61547712, 62829952,</span><br><span class="line"> 64112192, 65394432, 66676672, 67958912, 69241152, 70523392, 71805632, 73087872, 74370112, 75652352, 76934592, 78216832, 79499072, 80781312, 82063552, 83345792, 84628032,</span><br><span class="line"> 85910272, 87192512, 88474752, 89756992, 91039232, 92321472, 93603712, 94885952, 96168192, 97450432, 98732672, 100014912, 101297152, 102579392, 103861632, 105143872, 106426112,</span><br><span class="line"> 107708352, 108990592, 110272832, 111555072, 112837312, 114119552, 115401792, 116684032, 117966272, 119248512, 120530752, 121812992, 123095232, 124377472, 125659712</span><br></pre></td></tr></table></figure>
<h3 id="å®Œæˆï¼å¹¶æ£€æŸ¥"><a href="#å®Œæˆï¼å¹¶æ£€æŸ¥" class="headerlink" title="å®Œæˆï¼å¹¶æ£€æŸ¥"></a>å®Œæˆï¼å¹¶æ£€æŸ¥</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@log:~ # df -h</span><br><span class="line">Filesystem                     Size    Used   Avail Capacity  Mounted on</span><br><span class="line">/dev/ufsid/59a7effe7885633c     58G    4.2G     49G     8%    /</span><br><span class="line">devfs                          1.0K    1.0K      0B   100%    /dev</span><br><span class="line">root@log:~ # gpart show</span><br><span class="line">=&gt;       63  125829057  vtbd0  MBR  (60G)</span><br><span class="line">         63          1         - free -  (512B)</span><br><span class="line">         64  125829056      1  freebsd  [active]  (60G)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>FreeBSD</tag>
      </tags>
  </entry>
  <entry>
    <title>FreeBSDä¸Šä½¿ç”¨tunnelbrokeréš§é“æ”¯æŒipv6</title>
    <url>/2017/03/19/freebsd-nginx-ipv6-with-tunnelbroker/</url>
    <content><![CDATA[<h1 id="èµ·æº"><a href="#èµ·æº" class="headerlink" title="èµ·æº"></a>èµ·æº</h1><p>IOSè¢«æ‹’ï¼ŒåŸå› åˆæ˜¯<code>IPV6 only</code>ç½‘ç»œä¸‹è®¿é—®å¼‚å¸¸ï¼</p>
<p>äºæ˜¯å¼€å§‹è‡ªæ£€ï¼</p>
<p>å…ˆæ£€æŸ¥äº†ä»£ç ï¼Œæ²¡æœ‰ä½¿ç”¨åªèƒ½ç”¨äºipv4çš„ä»£ç ã€‚</p>
<p>æ¥å£ä¸­ä¹Ÿæ²¡æœ‰ä½¿ç”¨ipv4é™æ€åœ°å€çš„è¯·æ±‚ã€‚</p>
<p>é‚£å°±æ˜¯ç½‘ç»œé—®é¢˜äº†ï¼</p>
<p>å…ˆæ¨¡æ‹Ÿäº†ä¸€ä¸‹<code>ipv6</code>ç½‘ç»œã€‚æˆåŠŸé…ç½®äº†mac proå…±äº«ç½‘ç»œã€‚è®¿é—®äº†ä¸€ä¸‹ï¼æ²¡æ¯›ç—…ï¼</p>
<p>é‚£å°±æ˜¯<code>IPV6 only</code>ç½‘ç»œè‡³ipv4ï¼Œä¸”èµ°å›½é™…çº¿è·¯ï¼Œè¿™ä¸ªæœ‰äº›ç‰¹åˆ«äº†ï¼<br>æ‰¾äº†ä¸€ä¸‹å‘ç°ä¸å°‘äººåå˜ˆè¿™ä¸ªäº‹ï¼Œæ–‡ç« ä¸­ç”šè‡³æ‰¬è¨€è¦æŠ•é <code>Android</code>^_^ã€‚<br>ä¸”æœ‰å…¬å¸å·²ç»æŠŠä¼˜åŒ–å›½å†…IPV4è‡³è‹¹æœå…¬å¸çš„ipv6-onlyçš„ç½‘ç»œåšæˆæœåŠ¡ï¼Œå½“ç”Ÿæ„åšäº†ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜è‡ªå·±è§£å†³å°±æ˜¯ç»™è‡ªå·±çš„æœåŠ¡å™¨ä¸ŠåŠ ä¸€ä¸ªipv6åœ°å€ï¼Œå°±OKå•¦ï¼<br>ä½†ç°å®å¤ªéª¨æ„Ÿï¼Œé˜¿é‡Œäº‘æ²¡æœ‰ipv6ã€‚åªå¥½é€šè¿‡å…¶å®ƒé€”å¾„äº†ã€‚æ¯”è¾ƒåˆé€‚çš„æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨<a class="link"   href="https://tunnelbroker.net/" >tunnelbroker<i class="fas fa-external-link-alt"></i></a>æä¾›çš„ipv6éš§é“äº†ã€‚</p>
<h1 id="åŠ¨æ‰‹"><a href="#åŠ¨æ‰‹" class="headerlink" title="åŠ¨æ‰‹"></a>åŠ¨æ‰‹</h1><ul>
<li>æ³¨å†Œè´¦å·</li>
<li>éªŒè¯é‚®ç®±<br>å®Œæˆåï¼Œç™»å½•è¿›å»ï¼Œåœ¨å·¦ä¾§çš„<code>User Functions</code>ä¸‹<code>Create Regular Tunnel</code>åˆ›å»ºä¸€ä¸ªå¸¸è§„çš„å°±å¥½ã€‚</li>
</ul>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>åˆ›å»ºå®Œé€šé“åï¼Œåœ¨<code>Tunnel Details</code>ä¸‹æœ‰ä¸ª<code>Example Configurations</code>æ ‡ç­¾ï¼Œè¿™é‡Œèƒ½æŒ‰ä½ çš„ç³»ç»Ÿç”Ÿæˆé…ç½®æŒ‡ä»¤ã€‚<br>è¿›å»é€‰æ‹©<code>Freebsd &gt; 4.4</code>ï¼Œå¾—åˆ°ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">ifconfig gif0 create</span><br><span class="line">ifconfig gif0 tunnel [æˆ‘çš„IP] 209.51.161.14  #æˆ‘æœåŠ¡å™¨çš„IP å¸®æˆ‘è½¬å‘çš„ipv4IP</span><br><span class="line">ifconfig gif0 inet6 2001:470:1f06:1458::2 2001:470:1f06:1458::1 prefixlen 128       # å‡ºéš§é“åï¼Œæˆ‘åœ¨å…¬ç½‘ä¸Šçš„ipv6åœ°å€ éš§é“æ–¹çš„æœåŠ¡ipv6åœ°å€</span><br><span class="line">route -n add -inet6 default 2001:470:1f06:1458::1</span><br><span class="line">ifconfig gif0 up</span><br></pre></td></tr></table></figure>
<p>è¿›å»æ‰§è¡Œæ‰<br>æ‰§è¡Œå®Œåï¼Œ<code>ifconfig</code>é‡Œå°±ä¼šå¤šå‡ºæ¥ä¸€ä¸ªgif0è®¾å¤‡ã€‚</p>
<p>FreeBSDçš„/etc/rc.confå¢åŠ é…ç½®ï¼ŒæŠŠç¦æ­¢ipv6çš„é¡¹åˆ å»ã€‚</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># IPv6 Tunnel Client</span><br><span class="line">ipv6_enable=&quot;YES&quot;</span><br><span class="line">gif_interfaces=&quot;gif0&quot;</span><br><span class="line">gifconfig_gif0=&quot;[æˆ‘çš„IP] 209.51.161.14&quot;</span><br><span class="line">ipv6_ifconfig_gif0=&quot;2001:470:1f06:1458::2 2001:470:1f06:1458::1 prefixlen 128&quot;</span><br><span class="line">ipv6_defaultrouter=&quot;2001:470:1f06:1458::1&quot;</span><br><span class="line"> </span><br><span class="line"># IPv6 Gateway</span><br><span class="line">ipv6_config_nfe0=&quot;2001:470:1f07:1458::1 prefixlen 64&quot;   #è¿™ä¸ªæ˜¯è·¯ç”±åœ°å€ï¼šåœ¨â€˜Tunnel Detailsâ€™ é‡Œï¼Œæ˜¯â€˜Routed IPv6 Prefixesâ€™ä¸‹çš„â€˜Routed /64â€™é¡¹ã€‚</span><br><span class="line">ipv6_gateway_enable=&quot;YES&quot;</span><br><span class="line">rtadvd_enable=&quot;YES&quot;</span><br><span class="line">rtadvd_interfaces=&quot;nfe0&quot;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªéœ€è¦rtadvdæœåŠ¡ï¼Œ<code>service rtadvd start</code>ã€‚</p>
<h2 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h2><p>FreeBSDå¤„ç†ipv4ä¸v6æ˜¯ä¸¤æ¡ä¸åŒçš„é“ã€‚<br>æ‰€ä»¥åœ¨<code>nginx</code>é‡Œï¼Œè¦åŠ ä¸Šipv6çš„ç›‘å¬ï¼Œç±»ä¼¼ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">listen 443 ssl;</span><br><span class="line">listen [::]:443 ssl;</span><br></pre></td></tr></table></figure>
<p>å†<code>sysctl net.inet6.ip6.forwarding</code>ä¸€ä¸‹ï¼Œçœ‹çœ‹æ˜¯å¦æ”¯æŒè½¬å‘ã€‚<br>å¦‚æœæ˜¯0ã€‚å°±å¾—æ”¾å¼€ï¼æ‰§è¡Œï¼š<code>sysctl -w net.inet6.ip6.forwarding=1</code>ã€‚</p>
<h2 id="dns"><a href="#dns" class="headerlink" title="dns"></a>dns</h2><p>è¿›å…¥DNSPODç»™åŸŸåä¸‹åŠ ä¸€æ¡<code>AAAA</code>è®°å½•ã€‚åœ°å€ç”¨<code>2001:470:1f06:1458::2</code>ã€‚</p>
<h1 id="æ£€æµ‹"><a href="#æ£€æµ‹" class="headerlink" title="æ£€æµ‹"></a>æ£€æµ‹</h1><p>æ²¡æœ‰ipv6-onlyç¯å¢ƒï¼Œæ€ä¹ˆåˆ¤æ–­è¿™ä¸€åˆ‡ç”Ÿæ•ˆäº†å‘¢ï¼Ÿåªéœ€æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š<a href="http://www.wangjunfeng.com.cn.ipv4.sixxs.org/"><code>http://www.wangjunfeng.com.cn.ipv4.sixxs.org</code></a>ã€‚<br>è¿™é‡Œ<code>www.wangjunfeng.com.cn</code>å°±æ˜¯è¦æ”¯æŒçš„ç½‘å€äº†ã€‚å¦‚æœæ­£å¸¸æ‰“å¼€ã€‚å°±OKäº†ï¼</p>
]]></content>
      <tags>
        <tag>FreeBSD</tag>
        <tag>nginx</tag>
        <tag>ipv6</tag>
        <tag>tunnelbroker</tag>
      </tags>
  </entry>
  <entry>
    <title>FreeBSD çš„æ—¥å¸¸</title>
    <url>/2017/07/22/freebsd/</url>
    <content><![CDATA[<h1 id="æŸ¥çœ‹å½“å‰å†…æ ¸ï¼Œç¼–è¯‘æ—¶çš„å‚æ•°"><a href="#æŸ¥çœ‹å½“å‰å†…æ ¸ï¼Œç¼–è¯‘æ—¶çš„å‚æ•°" class="headerlink" title="æŸ¥çœ‹å½“å‰å†…æ ¸ï¼Œç¼–è¯‘æ—¶çš„å‚æ•°"></a>æŸ¥çœ‹å½“å‰å†…æ ¸ï¼Œç¼–è¯‘æ—¶çš„å‚æ•°</h1><p><code>sysctl kern.conftxt</code></p>
<h1 id="é…ç½®å¹¶ç¼–è¯‘æ–°å†…æ ¸"><a href="#é…ç½®å¹¶ç¼–è¯‘æ–°å†…æ ¸" class="headerlink" title="é…ç½®å¹¶ç¼–è¯‘æ–°å†…æ ¸"></a>é…ç½®å¹¶ç¼–è¯‘æ–°å†…æ ¸</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/src/sys/amd64/conf/</span><br><span class="line">ee GENERIC</span><br><span class="line">config GENERIC</span><br><span class="line"><span class="built_in">cd</span> ../compile/GENERIC/</span><br><span class="line">make cleandepend &amp;&amp; make depend</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h1 id="ä»ä½ç‰ˆæœ¬å†…æ ¸å‡çº§è‡³é«˜ç‰ˆæœ¬"><a href="#ä»ä½ç‰ˆæœ¬å†…æ ¸å‡çº§è‡³é«˜ç‰ˆæœ¬" class="headerlink" title="ä»ä½ç‰ˆæœ¬å†…æ ¸å‡çº§è‡³é«˜ç‰ˆæœ¬"></a>ä»ä½ç‰ˆæœ¬å†…æ ¸å‡çº§è‡³é«˜ç‰ˆæœ¬</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">setenv UNAME_r <span class="string">&quot;10.3-RELEASE&quot;</span></span><br><span class="line">freebsd-update -r 11.0-RELEASE upgrade</span><br><span class="line">freebsd-update insatll</span><br><span class="line">reboot</span><br><span class="line">freebsd-update insatll</span><br></pre></td></tr></table></figure>
<ul>
<li>æ³¨å†Œä¸èƒ½è·¨å¤§ç‰ˆæœ¬ã€‚å¦‚ï¼šä»10.1 -&gt; 11.0 ä¸­é—´è¦ç»è¿‡10.3ã€‚ 10.1 -&gt; 10.3 -&gt; 11.0</li>
<li>å¦‚æœæœ‰å®šä¹‰è‡ªå·±å†…æ ¸ï¼Œéœ€å…ˆå‡çº§ï¼Œå†ç¼–è¯‘è‡ªå·±çš„é…ç½®ã€‚</li>
</ul>
<h1 id="ç»™å†…æ ¸æ‰“è¡¥ä¸"><a href="#ç»™å†…æ ¸æ‰“è¡¥ä¸" class="headerlink" title="ç»™å†…æ ¸æ‰“è¡¥ä¸"></a>ç»™å†…æ ¸æ‰“è¡¥ä¸</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">freebsd-update fetch</span><br><span class="line">freebsd-update install</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>FreeBSD</tag>
      </tags>
  </entry>
  <entry>
    <title>ginä¸ŠåŒæ—¶å®ç°websocket</title>
    <url>/2019/07/30/gin-with-websocket/</url>
    <content><![CDATA[<h1 id="ä¸€ä¸ªåœ¨Ginæ¡†æ¶ä¸Šå®ç°websocketçš„æ ·ä¾‹"><a href="#ä¸€ä¸ªåœ¨Ginæ¡†æ¶ä¸Šå®ç°websocketçš„æ ·ä¾‹" class="headerlink" title="ä¸€ä¸ªåœ¨Ginæ¡†æ¶ä¸Šå®ç°websocketçš„æ ·ä¾‹"></a>ä¸€ä¸ªåœ¨Ginæ¡†æ¶ä¸Šå®ç°websocketçš„æ ·ä¾‹</h1><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gorilla/websocket&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	upgrader = websocket.Upgrader&#123;</span><br><span class="line">		ReadBufferSize:   <span class="number">1024</span>,</span><br><span class="line">		WriteBufferSize:  <span class="number">1024</span>,</span><br><span class="line">		CheckOrigin:      <span class="function"><span class="keyword">func</span><span class="params">(r *http.Request)</span> <span class="title">bool</span></span> &#123; <span class="keyword">return</span> <span class="literal">true</span> &#125;,</span><br><span class="line">		HandshakeTimeout: time.Duration(time.Second * <span class="number">5</span>),</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleWebsocket</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	conn, err := upgrader.Upgrade(c.Writer, c.Request, <span class="literal">nil</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Println(<span class="string">&quot;cant upgrade connection:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		msgType, msgData, err := conn.ReadMessage()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Println(<span class="string">&quot;cant read message:&quot;</span>, err)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">switch</span> err.(<span class="keyword">type</span>) &#123;</span><br><span class="line">			<span class="keyword">case</span> *websocket.CloseError:</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Skip binary messages</span></span><br><span class="line">		<span class="keyword">if</span> msgType != websocket.TextMessage &#123;</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		log.Printf(<span class="string">&quot;incoming message: %s\n&quot;</span>, msgData)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	router.GET(<span class="string">&quot;/websocket&quot;</span>, handleWebsocket)</span><br><span class="line">	router.Run(<span class="string">&quot;:5000&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤‡è‡ªï¼š<a class="link"   href="https://github.com/gin-gonic/gin/issues/1305" >https://github.com/gin-gonic/gin/issues/1305<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>golang</tag>
        <tag>gin</tag>
        <tag>websocket</tag>
      </tags>
  </entry>
  <entry>
    <title>golang udp æœåŠ¡çš„å‘</title>
    <url>/2020/06/29/golang-udp-server/</url>
    <content><![CDATA[<p>golang udp æœåŠ¡ç«¯æ¼”ç¤ºçº§çš„å†™æ³•ä¸€èˆ¬æ˜¯ï¼š</p>
<figure class="highlight golang"><table><tr><td class="code"><pre><span class="line">   conn, err := net.ListenUDP(<span class="string">&quot;udp&quot;</span>, &amp;net.UDPAddr&#123;Port: <span class="number">8866</span>&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	log.Fatalf(<span class="string">&quot;Udp Service listen report udp fail:%v&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> conn.Close()</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">	data := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">1024</span>*<span class="number">4</span>)</span><br><span class="line">	n, remoteAddr, err := conn.ReadFromUDP(data)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="comment">// ... åšç‚¹ä»€ä¹ˆ</span></span><br><span class="line">           conn.WriteToUDP(data[:n], remoteAddr)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä½œä¸ºæ•™å­¦æˆ–æ¼”ç¤ºæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†åº”ç”¨äºç”Ÿäº§æ—¶ï¼Œå¤„åœ¨åœ¨ä¸€ä¸ªé¢‘ç¹æ”¶å‘æŠ¥æ–‡çš„ä¸­å¿ƒæœåŠ¡å™¨ä¸Šï¼Œè¿™é‡Œå°±æœ‰ä¸¤ä¸ªé—®é¢˜äº†ï¼š</p>
<ul>
<li>åœ¨<code>for</code>å¾ªç¯ä¸­ä¸æ–­ç”³è¯·å˜é‡<code>data</code>å¹¶<code>make</code>ã€‚ä¼šäº§ç”Ÿå¤§é‡å†…å­˜æ¶ˆè€—ã€‚å¼•èµ·é¢‘ç¹GCã€‚</li>
<li>æ”¶åˆ°æ•°æ®åå¤„ç†ä¸åº”è¯¥åœ¨<code>for</code>å¾ªç¯å†…éƒ¨ã€‚å› ä¸ºå¦‚æœæ•°æ®å¤„ç†æ—¶é—´è¿‡é•¿ï¼Œå°±ä¼šæ‹¥å¡ã€‚æ‹¥å¡æœŸé—´è‹¥åº•å±‚ç¼“å†²åŒºæ»¡äº†ï¼Œè¯´ä¸å®šä¼šä¸¢åŒ…ã€‚</li>
</ul>
<p>é‚£ä¹ˆV2ç‰ˆå†™æ³•æ¥äº†ï¼š</p>
<figure class="highlight golang"><table><tr><td class="code"><pre><span class="line">   conn, err := net.ListenUDP(<span class="string">&quot;udp&quot;</span>, &amp;net.UDPAddr&#123;Port: <span class="number">8866</span>&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	log.Fatalf(<span class="string">&quot;Udp Service listen report udp fail:%v&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> conn.Close()</span><br><span class="line">   data := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">1024</span>*<span class="number">4</span>)</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">	n, remoteAddr, err := conn.ReadFromUDP(data)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">           <span class="keyword">go</span> <span class="function"><span class="keyword">func</span> <span class="params">()</span></span>&#123;</span><br><span class="line">               <span class="comment">// ... æ‹¿ data[:n]åšç‚¹ä»€ä¹ˆ</span></span><br><span class="line">               conn.WriteToUDP(data[:n], remoteAddr)</span><br><span class="line">           &#125;()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>V2ç‰ˆçœ‹ä¸Šå»å®Œç¾ï¼å…¶å®è¿è¡Œç»“æœä¼šå®Œå…¨å‡ºäººæ„æ–™ï¼</p>
<p>å› ä¸ºæ¯æ¬¡<code>for</code>å¾ªç¯æ²¡æœ‰å°†<code>data</code>ç½®0ï¼Œå½“ä¼ è¾“çš„æ˜¯äºŒè¿›åˆ¶æ—¶ï¼Œä¼šå¯¼è‡´ä¸Šæ¬¡Readçš„ç»“æœå¹²æ‰°ä¸‹æ¬¡Readçš„ç»“æœã€‚å¯¼è‡´å¯¹æ•°æ® <code>Unmarshal</code>æ—¶éšæœºå‡ºé”™ï¼å¦‚æœä¸å€ŸåŠ©<code>tcpdump</code>æŠ“åŒ…åšä½çº§æ¯”å¯¹ï¼è¿™ä¼šå˜æˆä¸€ä¸ªç„å­¦é—®é¢˜ï¼</p>
<p>okï¼å†æ¥V3ï¼</p>
<figure class="highlight golang"><table><tr><td class="code"><pre><span class="line">   conn, err := net.ListenUDP(<span class="string">&quot;udp&quot;</span>, &amp;net.UDPAddr&#123;Port: <span class="number">8866</span>&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	log.Fatalf(<span class="string">&quot;Udp Service listen report udp fail:%v&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> conn.Close()</span><br><span class="line">   <span class="keyword">var</span> data []<span class="keyword">byte</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">       data = <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">1024</span>*<span class="number">4</span>)</span><br><span class="line">	n, remoteAddr, err := conn.ReadFromUDP(data)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">           <span class="keyword">go</span> <span class="function"><span class="keyword">func</span> <span class="params">()</span></span>&#123;</span><br><span class="line">               <span class="comment">// ... æ‹¿ data[:n]åšç‚¹ä»€ä¹ˆ</span></span><br><span class="line">               conn.WriteToUDP(data[:n], remoteAddr)</span><br><span class="line">           &#125;()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>V3ç‰ˆæˆåŠŸè§£å†³äº†å¹²æ‰°ï¼</p>
<p>ä½†åˆæ¥äº†æ–°é—®é¢˜ã€‚å°±æ˜¯ï¼šåœ¨åç¨‹ä¸­å¤„ç†æ•°æ®<code>data[:n]</code>æ—¶æ€»æ˜¯æ‰€æœ‰ä½æ˜¯<code>0</code>çš„<code>n</code>ä½é•¿çš„æ•°ç»„ã€‚è¾£ä¹ˆï¼Œæ•°æ®å‘¢ï¼Ÿ</p>
<p>å½“ç„¶æ˜¯åç¨‹å†…å¼•ç”¨<code>data</code>å¯¼è‡´çš„ã€‚å› ä¸ºåœ¨åç¨‹åˆ›å»ºå®Œæˆï¼Œå¼€å§‹æ‰§è¡Œå‰ï¼Œ<code>for</code>å·²ç»è¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯å¹¶åœ¨<code>Read</code>å¤„ç­‰å¾…äº†ã€‚æ­¤æ—¶çš„<code>data</code>ç»è¿‡<code>make</code>å·²ç»é‡ç½®æ•°æ®äº†ã€‚</p>
<blockquote>
<p>è¿™é‡Œè¦ä»‹ç»ä¸€ä¸ª<code>golang</code>çš„åŸºç¡€åŠŸèƒ½<code>copy</code></p>
<blockquote>
<p><code>golang</code> ä¸ºäº†é¿å…æ¯ä¸€å±‚çš„å¤„ç†æ•°æ®éƒ½è¦åœ¨å†…å­˜é‡Œå»ºç«‹ç›¸åŒæ•°æ®çš„å‰¯æœ¬ã€‚é‡‡ç”¨äº†å¼•ç”¨çš„æ–¹å¼ä¼ é€’ã€‚ä¹Ÿå°±æ˜¯<code>slice</code>çš„å­˜åœ¨çš„æ„ä¹‰ï¼å®ƒå¤§é‡èŠ‚çº¦äº†å†…å­˜ï¼å¤©æ‰èˆ¬çš„è®¾è®¡ï¼<br><br>è¿™é‡Œ<code>conn.ReadFromUDP(data)</code>å<code>data</code>é‡Œæ”¾çš„å…¶å®æ˜¯åº•å±‚ç¼“å†²åŒºå†…çš„æ•°æ®å¼•ç”¨ã€‚æ“ä½œ<code>data</code>å®é™…ä¸Šæ˜¯åœ¨æ“ä½œåº•å±‚ç¼“å†²åŒºã€‚<br><br>æ‰€ä»¥æˆ‘ä»¬åœ¨æ“ä½œ<code>data</code>å‰ä¸€å®šè¦å…ˆå°†<code>data</code>é‡Œçš„æ•°æ®è¯»å…¥æ–°çš„å˜é‡é‡Œï¼Œå®ç°<code>ç§æœ‰åŒ–</code>ï¼Œå†äº¤ç»™åç¨‹å¤„ç†ã€‚å¦åˆ™åœ¨åç¨‹æœªå¯åŠ¨å®Œæˆå‰ï¼Œ<code>data</code>é‡Œçš„æ•°æ®å¯èƒ½å› ä¸ºè¿›å…¥æ–°çš„å¾ªç¯ï¼Œè€Œè¢«åˆ·æ–°ï¼<br><br>ä¸å¹¸çš„æ˜¯ï¼Œç®€å•çš„<code>=</code>æ˜¯ä¸èƒ½å°†<code>data</code> <code>ç§æœ‰åŒ–</code>çš„ã€‚åªèƒ½<code>make</code>ä¸€ä¸ªç©ºç™½çš„<code>slice</code>ï¼Œå†å°†<code>data</code>é€ä¸ªå¤åˆ¶è¿›æ¥ã€‚è¿™ä¸ªæ“ä½œ<code>golang</code>å·²ä¸ºæˆ‘ä»¬å°è£…å¥½äº†ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°±æ˜¯ï¼š<code>copy</code></p>
</blockquote>
</blockquote>
<p>okï¼å†æ¥V4ï¼</p>
<figure class="highlight golang"><table><tr><td class="code"><pre><span class="line">conn, err := net.ListenUDP(<span class="string">&quot;udp&quot;</span>, &amp;net.UDPAddr&#123;Port: <span class="number">8866</span>&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	log.Fatalf(<span class="string">&quot;Udp Service listen report udp fail:%v&quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> conn.Close()</span><br><span class="line"><span class="keyword">var</span> data = <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">1024</span>*<span class="number">4</span>)</span><br><span class="line"><span class="keyword">var</span> raw []<span class="keyword">byte</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">	n, remoteAddr, err := conn.ReadFromUDP(data)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">		raw = <span class="built_in">make</span>([]<span class="keyword">byte</span>,n)</span><br><span class="line">		<span class="built_in">copy</span>(raw,data[:n])</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span> <span class="params">()</span></span>&#123;</span><br><span class="line">			<span class="comment">// ... æ‹¿ raw åšç‚¹ä»€ä¹ˆ</span></span><br><span class="line">			conn.WriteToUDP(raw, remoteAddr)</span><br><span class="line">		&#125;()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ok! è¿è¡Œèµ·æ¥å‡ ä¹æ²¡å•¥é—®é¢˜ã€‚</p>
]]></content>
      <tags>
        <tag>golang</tag>
        <tag>udp</tag>
      </tags>
  </entry>
  <entry>
    <title>iptablesè¯¦ç»†æ•™ç¨‹ï¼šåŸºç¡€ã€æ¶æ„ã€æ¸…ç©ºè§„åˆ™ã€è¿½åŠ è§„åˆ™ã€åº”ç”¨å®ä¾‹</title>
    <url>/2019/12/14/iptables/</url>
    <content><![CDATA[<p>iptablesé˜²ç«å¢™å¯ä»¥ç”¨äºåˆ›å»ºè¿‡æ»¤(filter)ä¸NATè§„åˆ™ã€‚æ‰€æœ‰Linuxå‘è¡Œç‰ˆéƒ½èƒ½ä½¿ç”¨iptablesï¼Œå› æ­¤ç†è§£å¦‚ä½•é…ç½®iptableså°†ä¼šå¸®åŠ©ä½ æ›´æœ‰æ•ˆåœ°ç®¡ç†Linuxé˜²ç«å¢™ã€‚å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦iptablesï¼Œä½ ä¼šè§‰å¾—å®ƒå¾ˆå¤æ‚ï¼Œä½†æ˜¯ä¸€æ—¦ä½ ç†è§£iptablesçš„å·¥ä½œåŸç†ï¼Œä½ ä¼šå‘ç°å…¶å®å®ƒå¾ˆç®€å•ã€‚</p>
<p>é¦–å…ˆä»‹ç»iptablesçš„ç»“æ„ï¼šiptables -&gt; Tables -&gt; Chains -&gt; Rules. ç®€å•åœ°è®²ï¼Œtablesç”±chainsç»„æˆï¼Œè€Œchainsåˆç”±rulesç»„æˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://user-images.githubusercontent.com/1764005/70845966-94926480-1e8f-11ea-8c62-38010afa3146.png" alt="image"><br>å›¾: IPTables Table, Chain, and Rule Structure</p>
<h1 id="iptablesçš„è¡¨ä¸é“¾"><a href="#iptablesçš„è¡¨ä¸é“¾" class="headerlink" title="iptablesçš„è¡¨ä¸é“¾"></a>iptablesçš„è¡¨ä¸é“¾</h1><p>iptableså…·æœ‰Filter, NAT, Mangle, Rawå››ç§å†…å»ºè¡¨ï¼š</p>
<h2 id="Filterè¡¨"><a href="#Filterè¡¨" class="headerlink" title="Filterè¡¨"></a>Filterè¡¨</h2><p>Filterè¡¨ç¤ºiptablesçš„é»˜è®¤è¡¨ï¼Œå› æ­¤å¦‚æœä½ æ²¡æœ‰è‡ªå®šä¹‰è¡¨ï¼Œé‚£ä¹ˆå°±é»˜è®¤ä½¿ç”¨filterè¡¨ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ä¸‰ç§å†…å»ºé“¾ï¼š</p>
<ul>
<li><strong>INPUTé“¾</strong> â€“ å¤„ç†æ¥è‡ªå¤–éƒ¨çš„æ•°æ®ã€‚</li>
<li><strong>OUTPUTé“¾</strong> â€“ å¤„ç†å‘å¤–å‘é€çš„æ•°æ®ã€‚</li>
<li><strong>FORWARDé“¾</strong> â€“ å°†æ•°æ®è½¬å‘åˆ°æœ¬æœºçš„å…¶ä»–ç½‘å¡è®¾å¤‡ä¸Šã€‚</li>
</ul>
<h2 id="NATè¡¨"><a href="#NATè¡¨" class="headerlink" title="NATè¡¨"></a>NATè¡¨</h2><p>NATè¡¨æœ‰ä¸‰ç§å†…å»ºé“¾ï¼š</p>
<ul>
<li><strong>PREROUTINGé“¾</strong> â€“ å¤„ç†åˆšåˆ°è¾¾æœ¬æœºå¹¶åœ¨è·¯ç”±è½¬å‘å‰çš„æ•°æ®åŒ…ã€‚å®ƒä¼šè½¬æ¢æ•°æ®åŒ…ä¸­çš„ç›®æ ‡IPåœ°å€ï¼ˆdestination ip addressï¼‰ï¼Œé€šå¸¸ç”¨äºDNAT(destination NAT)ã€‚</li>
<li><strong>POSTROUTINGé“¾</strong> â€“ å¤„ç†å³å°†ç¦»å¼€æœ¬æœºçš„æ•°æ®åŒ…ã€‚å®ƒä¼šè½¬æ¢æ•°æ®åŒ…ä¸­çš„æºIPåœ°å€ï¼ˆsource ip addressï¼‰ï¼Œé€šå¸¸ç”¨äºSNATï¼ˆsource NATï¼‰ã€‚</li>
<li><strong>OUTPUTé“¾</strong> â€“ å¤„ç†æœ¬æœºäº§ç”Ÿçš„æ•°æ®åŒ…ã€‚</li>
</ul>
<h2 id="Mangleè¡¨"><a href="#Mangleè¡¨" class="headerlink" title="Mangleè¡¨"></a>Mangleè¡¨</h2><p>Mangleè¡¨ç”¨äºæŒ‡å®šå¦‚ä½•å¤„ç†æ•°æ®åŒ…ã€‚å®ƒèƒ½æ”¹å˜TCPå¤´ä¸­çš„QoSä½ã€‚Mangleè¡¨å…·æœ‰5ä¸ªå†…å»ºé“¾ï¼š</p>
<ul>
<li>PREROUTING</li>
<li>OUTPUT</li>
<li>FORWARD</li>
<li>INPUT</li>
<li>POSTROUTING</li>
</ul>
<h2 id="Rawè¡¨"><a href="#Rawè¡¨" class="headerlink" title="Rawè¡¨"></a>Rawè¡¨</h2><p>Rawè¡¨ç”¨äºå¤„ç†å¼‚å¸¸ï¼Œå®ƒå…·æœ‰2ä¸ªå†…å»ºé“¾ï¼š</p>
<p>PREROUTING chain<br>OUTPUT chain</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>ä¸‹å›¾å±•ç¤ºäº†iptablesçš„ä¸‰ä¸ªå†…å»ºè¡¨ï¼š</p>
<p><img src="https://user-images.githubusercontent.com/1764005/70846052-68c3ae80-1e90-11ea-83db-51e4b4e01987.png" alt="å›¾: IPTables å†…å»ºè¡¨"><br>å›¾: IPTables å†…å»ºè¡¨</p>
<h1 id="IPTABLES-è§„åˆ™-Rules"><a href="#IPTABLES-è§„åˆ™-Rules" class="headerlink" title="IPTABLES è§„åˆ™(Rules)"></a>IPTABLES è§„åˆ™(Rules)</h1><p>ç‰¢è®°ä»¥ä¸‹ä¸‰ç‚¹å¼ç†è§£iptablesè§„åˆ™çš„å…³é”®ï¼š</p>
<ul>
<li>RulesåŒ…æ‹¬ä¸€ä¸ªæ¡ä»¶å’Œä¸€ä¸ªç›®æ ‡(target)</li>
<li>å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œå°±æ‰§è¡Œç›®æ ‡(target)ä¸­çš„è§„åˆ™æˆ–è€…ç‰¹å®šå€¼ã€‚</li>
<li>å¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œå°±åˆ¤æ–­ä¸‹ä¸€æ¡Rulesã€‚</li>
</ul>
<h2 id="ç›®æ ‡å€¼ï¼ˆTarget-Valuesï¼‰"><a href="#ç›®æ ‡å€¼ï¼ˆTarget-Valuesï¼‰" class="headerlink" title="ç›®æ ‡å€¼ï¼ˆTarget Valuesï¼‰"></a>ç›®æ ‡å€¼ï¼ˆTarget Valuesï¼‰</h2><p>ä¸‹é¢æ˜¯ä½ å¯ä»¥åœ¨targeté‡ŒæŒ‡å®šçš„ç‰¹æ®Šå€¼ï¼š</p>
<ul>
<li>ACCEPT â€“ å…è®¸é˜²ç«å¢™æ¥æ”¶æ•°æ®åŒ…</li>
<li>DROP â€“ é˜²ç«å¢™ä¸¢å¼ƒåŒ…</li>
<li>QUEUE â€“ é˜²ç«å¢™å°†æ•°æ®åŒ…ç§»äº¤åˆ°ç”¨æˆ·ç©ºé—´</li>
<li>RETURN â€“ é˜²ç«å¢™åœæ­¢æ‰§è¡Œå½“å‰é“¾ä¸­çš„åç»­Rulesï¼Œå¹¶è¿”å›åˆ°è°ƒç”¨é“¾(the calling chain)ä¸­ã€‚<br>å¦‚æœä½ æ‰§è¡Œ<code>iptables --list</code>ä½ å°†çœ‹åˆ°é˜²ç«å¢™ä¸Šçš„å¯ç”¨è§„åˆ™ã€‚ä¸‹ä¾‹è¯´æ˜å½“å‰ç³»ç»Ÿæ²¡æœ‰å®šä¹‰é˜²ç«å¢™ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ˜¾ç¤ºäº†é»˜è®¤çš„filterè¡¨ï¼Œä»¥åŠè¡¨å†…é»˜è®¤çš„inputé“¾, forwardé“¾, outputé“¾ã€‚<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># iptables -t filter --list</span></span><br><span class="line">Chain INPUT (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination         </span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination         </span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line"></span><br></pre></td></tr></table></figure>
æŸ¥çœ‹mangleè¡¨ï¼š<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># iptables -t mangle --list</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
æŸ¥çœ‹NATè¡¨ï¼š<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># iptables -t nat --list</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
æŸ¥çœ‹RAWè¡¨ï¼š<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># iptables -t raw --list</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
æ³¨æ„ï¼šå¦‚æœä¸æŒ‡å®š<code>-t</code>é€‰é¡¹ï¼Œå°±åªä¼šæ˜¾ç¤ºé»˜è®¤çš„<code>filter</code>è¡¨ã€‚å› æ­¤ï¼Œä»¥ä¸‹ä¸¤ç§å‘½ä»¤å½¢å¼æ˜¯ä¸€ä¸ªæ„æ€ï¼š<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># iptables -t filter --list</span></span><br><span class="line">(or)</span><br><span class="line"><span class="comment"># iptables --list</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
ä»¥ä¸‹ä¾‹å­è¡¨æ˜åœ¨filterè¡¨çš„inputé“¾, forwardé“¾, outputé“¾ä¸­å­˜åœ¨è§„åˆ™ï¼š<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># iptables --list</span></span><br><span class="line">Chain INPUT (policy ACCEPT)</span><br><span class="line">num  target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">1    RH-Firewall-1-INPUT  all  --  0.0.0.0/0            0.0.0.0/0</span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT)</span><br><span class="line">num  target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">1    RH-Firewall-1-INPUT  all  --  0.0.0.0/0            0.0.0.0/0</span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT)</span><br><span class="line">num  target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line"></span><br><span class="line">Chain RH-Firewall-1-INPUT (2 references)</span><br><span class="line">num  target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">1    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0</span><br><span class="line">2    ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0           icmp <span class="built_in">type</span> 255</span><br><span class="line">3    ACCEPT     esp  --  0.0.0.0/0            0.0.0.0/0</span><br><span class="line">4    ACCEPT     ah   --  0.0.0.0/0            0.0.0.0/0</span><br><span class="line">5    ACCEPT     udp  --  0.0.0.0/0            224.0.0.251         udp dpt:5353</span><br><span class="line">6    ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0           udp dpt:631</span><br><span class="line">7    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp dpt:631</span><br><span class="line">8    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED</span><br><span class="line">9    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           state NEW tcp dpt:22</span><br><span class="line">10   REJECT     all  --  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
ä»¥ä¸Šè¾“å‡ºåŒ…å«ä¸‹åˆ—å­—æ®µï¼š</li>
</ul>
<p><strong>num</strong> â€“ æŒ‡å®šé“¾ä¸­çš„è§„åˆ™ç¼–å·<br><strong>target</strong> â€“ å‰é¢æåˆ°çš„targetçš„ç‰¹æ®Šå€¼<br><strong>prot</strong> â€“ åè®®ï¼štcp, udp, icmpç­‰<br><strong>source</strong> â€“ æ•°æ®åŒ…çš„æºIPåœ°å€<br><strong>destination</strong> â€“ æ•°æ®åŒ…çš„ç›®æ ‡IPåœ°å€</p>
<h1 id="æ¸…ç©ºæ‰€æœ‰iptablesè§„åˆ™"><a href="#æ¸…ç©ºæ‰€æœ‰iptablesè§„åˆ™" class="headerlink" title="æ¸…ç©ºæ‰€æœ‰iptablesè§„åˆ™"></a>æ¸…ç©ºæ‰€æœ‰iptablesè§„åˆ™</h1><p>åœ¨é…ç½®<code>iptables</code>ä¹‹å‰ï¼Œä½ é€šå¸¸éœ€è¦ç”¨<code>iptables --list</code>å‘½ä»¤æˆ–è€…<code>iptables-save</code>å‘½ä»¤æŸ¥çœ‹æœ‰æ— ç°å­˜è§„åˆ™ï¼Œå› ä¸ºæœ‰æ—¶éœ€è¦åˆ é™¤ç°æœ‰çš„<code>iptables</code>è§„åˆ™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">iptables --flush</span><br><span class="line">æˆ–è€…</span><br><span class="line">iptables -F</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤æ¡å‘½ä»¤æ˜¯ç­‰æ•ˆçš„ã€‚ä½†æ˜¯å¹¶éæ‰§è¡Œåå°±ä¸‡äº‹å¤§å‰äº†ã€‚ä½ ä»ç„¶éœ€è¦æ£€æŸ¥è§„åˆ™æ˜¯ä¸æ˜¯çœŸçš„æ¸…ç©ºäº†ï¼Œå› ä¸ºæœ‰çš„linuxå‘è¡Œç‰ˆä¸Šè¿™ä¸ªå‘½ä»¤ä¸ä¼šæ¸…é™¤NATè¡¨ä¸­çš„è§„åˆ™ï¼Œæ­¤æ—¶åªèƒ½æ‰‹åŠ¨æ¸…é™¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">iptables -t NAT -F</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="æ°¸ä¹…ç”Ÿæ•ˆ"><a href="#æ°¸ä¹…ç”Ÿæ•ˆ" class="headerlink" title="æ°¸ä¹…ç”Ÿæ•ˆ"></a>æ°¸ä¹…ç”Ÿæ•ˆ</h1><p>å½“ä½ åˆ é™¤ã€æ·»åŠ è§„åˆ™åï¼Œè¿™äº›æ›´æ”¹å¹¶ä¸èƒ½æ°¸ä¹…ç”Ÿæ•ˆï¼Œè¿™äº›è§„åˆ™å¾ˆæœ‰å¯èƒ½åœ¨ç³»ç»Ÿé‡å¯åæ¢å¤åŸæ ·ã€‚ä¸ºäº†è®©é…ç½®æ°¸ä¹…ç”Ÿæ•ˆï¼Œæ ¹æ®å¹³å°çš„ä¸åŒï¼Œå…·ä½“æ“ä½œä¹Ÿä¸åŒã€‚ä¸‹é¢è¿›è¡Œç®€å•ä»‹ç»ï¼š</p>
<h2 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h2><p>é¦–å…ˆï¼Œä¿å­˜ç°æœ‰çš„è§„åˆ™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">iptables-save &gt; /etc/iptables.rules</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ–°å»ºä¸€ä¸ªbashè„šæœ¬ï¼Œå¹¶ä¿å­˜åˆ°<code>/etc/network/if-pre-up.d/</code>ç›®å½•ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">iptables-restore &lt; /etc/iptables.rules</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œæ¯æ¬¡ç³»ç»Ÿé‡å¯åiptablesè§„åˆ™éƒ½ä¼šè¢«è‡ªåŠ¨åŠ è½½ã€‚<br>æ³¨æ„ï¼šä¸è¦å°è¯•åœ¨<code>.bashrc</code>æˆ–è€…<code>.profile</code>ä¸­æ‰§è¡Œä»¥ä¸Šå‘½ä»¤ï¼Œå› ä¸ºç”¨æˆ·é€šå¸¸ä¸æ˜¯rootï¼Œè€Œä¸”è¿™åªèƒ½åœ¨ç™»å½•æ—¶åŠ è½½iptablesè§„åˆ™ã€‚</p>
<h1 id="è¿½åŠ iptablesè§„åˆ™"><a href="#è¿½åŠ iptablesè§„åˆ™" class="headerlink" title="è¿½åŠ iptablesè§„åˆ™"></a>è¿½åŠ <code>iptables</code>è§„åˆ™</h1><p>å¯ä»¥ä½¿ç”¨<code>iptables -A</code>å‘½ä»¤è¿½åŠ æ–°è§„åˆ™ï¼Œå…¶ä¸­<code>-A</code>è¡¨ç¤º<code>Append</code>ã€‚å› æ­¤ï¼Œæ–°çš„è§„åˆ™å°†è¿½åŠ åˆ°é“¾å°¾ã€‚<br>ä¸€èˆ¬è€Œè¨€ï¼Œæœ€åä¸€æ¡è§„åˆ™ç”¨äºä¸¢å¼ƒ(DROP)æ‰€æœ‰æ•°æ®åŒ…ã€‚å¦‚æœä½ å·²ç»æœ‰è¿™æ ·çš„è§„åˆ™äº†ï¼Œå¹¶ä¸”ä½¿ç”¨<code>-A</code>å‚æ•°æ·»åŠ æ–°è§„åˆ™ï¼Œé‚£ä¹ˆå°±æ˜¯æ— ç”¨åŠŸã€‚</p>
<h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">iptables -A chain firewall-rule</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><code>-A chain</code> â€“ æŒ‡å®šè¦è¿½åŠ è§„åˆ™çš„é“¾</li>
<li><code>firewall-rule</code> â€“ å…·ä½“çš„è§„åˆ™å‚æ•°</li>
</ul>
<h2 id="æè¿°è§„åˆ™çš„åŸºæœ¬å‚æ•°"><a href="#æè¿°è§„åˆ™çš„åŸºæœ¬å‚æ•°" class="headerlink" title="æè¿°è§„åˆ™çš„åŸºæœ¬å‚æ•°"></a>æè¿°è§„åˆ™çš„åŸºæœ¬å‚æ•°</h2><p>ä»¥ä¸‹è¿™äº›è§„åˆ™å‚æ•°ç”¨äºæè¿°æ•°æ®åŒ…çš„åè®®ã€æºåœ°å€ã€ç›®çš„åœ°å€ã€å…è®¸ç»è¿‡çš„ç½‘ç»œæ¥å£ï¼Œä»¥åŠå¦‚ä½•å¤„ç†è¿™äº›æ•°æ®åŒ…ã€‚è¿™äº›æè¿°æ˜¯å¯¹è§„åˆ™çš„åŸºæœ¬æè¿°ã€‚</p>
<h3 id="p-åè®®ï¼ˆprotocolï¼‰"><a href="#p-åè®®ï¼ˆprotocolï¼‰" class="headerlink" title="-p åè®®ï¼ˆprotocolï¼‰"></a>-p åè®®ï¼ˆprotocolï¼‰</h3><ul>
<li>æŒ‡å®šè§„åˆ™çš„åè®®ï¼Œå¦‚<code>tcp</code>, <code>udp</code>, <code>icmp</code>ç­‰ï¼Œå¯ä»¥ä½¿ç”¨<code>all</code>æ¥æŒ‡å®šæ‰€æœ‰åè®®ã€‚</li>
<li>å¦‚æœä¸æŒ‡å®š<code>-p</code>å‚æ•°ï¼Œåˆ™é»˜è®¤æ˜¯<code>all</code>å€¼ã€‚è¿™å¹¶ä¸æ˜æ™ºï¼Œè¯·æ€»æ˜¯æ˜ç¡®æŒ‡å®šåè®®åç§°ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨åè®®å(å¦‚tcp)ï¼Œæˆ–è€…æ˜¯åè®®å€¼ï¼ˆæ¯”å¦‚6ä»£è¡¨tcpï¼‰æ¥æŒ‡å®šåè®®ã€‚æ˜ å°„å…³ç³»è¯·æŸ¥çœ‹<code>/etc/protocols</code></li>
<li>è¿˜å¯ä»¥ä½¿ç”¨<code>â€“protocol</code>å‚æ•°ä»£æ›¿<code>-p</code>å‚æ•°</li>
</ul>
<h3 id="s-æºåœ°å€ï¼ˆsourceï¼‰"><a href="#s-æºåœ°å€ï¼ˆsourceï¼‰" class="headerlink" title="-s æºåœ°å€ï¼ˆsourceï¼‰"></a>-s æºåœ°å€ï¼ˆsourceï¼‰</h3><ul>
<li>æŒ‡å®šæ•°æ®åŒ…çš„æºåœ°å€</li>
<li>å‚æ•°å¯ä»¥ä½¿IPåœ°å€ã€ç½‘ç»œåœ°å€ã€ä¸»æœºå</li>
<li>ä¾‹å¦‚ï¼š-s 192.168.1.101æŒ‡å®šIPåœ°å€</li>
<li>ä¾‹å¦‚ï¼š-s 192.168.1.10/24æŒ‡å®šç½‘ç»œåœ°å€</li>
<li>å¦‚æœä¸æŒ‡å®š-så‚æ•°ï¼Œå°±ä»£è¡¨æ‰€æœ‰åœ°å€</li>
<li>è¿˜å¯ä»¥ä½¿ç”¨<code>â€“src</code>æˆ–è€…<code>â€“source</code></li>
</ul>
<h3 id="d-ç›®çš„åœ°å€ï¼ˆdestinationï¼‰"><a href="#d-ç›®çš„åœ°å€ï¼ˆdestinationï¼‰" class="headerlink" title="-d ç›®çš„åœ°å€ï¼ˆdestinationï¼‰"></a>-d ç›®çš„åœ°å€ï¼ˆdestinationï¼‰</h3><ul>
<li>æŒ‡å®šç›®çš„åœ°å€</li>
<li>å‚æ•°å’Œ<code>-s</code>ç›¸åŒ</li>
<li>è¿˜å¯ä»¥ä½¿ç”¨<code>â€“dst</code>æˆ–è€…<code>â€“destination</code></li>
</ul>
<h3 id="j-æ‰§è¡Œç›®æ ‡ï¼ˆjump-to-targetï¼‰"><a href="#j-æ‰§è¡Œç›®æ ‡ï¼ˆjump-to-targetï¼‰" class="headerlink" title="-j æ‰§è¡Œç›®æ ‡ï¼ˆjump to targetï¼‰"></a>-j æ‰§è¡Œç›®æ ‡ï¼ˆjump to targetï¼‰</h3><ul>
<li><code>-j</code>ä»£è¡¨â€jump to targetâ€</li>
<li><code>-j</code>æŒ‡å®šäº†å½“ä¸è§„åˆ™(Rule)åŒ¹é…æ—¶å¦‚ä½•å¤„ç†æ•°æ®åŒ…</li>
<li>å¯èƒ½çš„å€¼æ˜¯<code>ACCEPT</code>, <code>DROP</code>, <code>QUEUE</code>, <code>RETURN</code></li>
<li>è¿˜å¯ä»¥æŒ‡å®šå…¶ä»–é“¾ï¼ˆChainï¼‰ä½œä¸ºç›®æ ‡</li>
</ul>
<h3 id="i-è¾“å…¥æ¥å£ï¼ˆinput-interfaceï¼‰"><a href="#i-è¾“å…¥æ¥å£ï¼ˆinput-interfaceï¼‰" class="headerlink" title="-i è¾“å…¥æ¥å£ï¼ˆinput interfaceï¼‰"></a>-i è¾“å…¥æ¥å£ï¼ˆinput interfaceï¼‰</h3><ul>
<li><code>-i</code>ä»£è¡¨è¾“å…¥æ¥å£(input interface)</li>
<li><code>-i</code>æŒ‡å®šäº†è¦å¤„ç†æ¥è‡ªå“ªä¸ªæ¥å£çš„æ•°æ®åŒ…</li>
<li>è¿™äº›æ•°æ®åŒ…å³å°†è¿›å…¥<code>INPUT</code>, <code>FORWARD</code>, <code>PREROUTEé“¾</code></li>
<li>ä¾‹å¦‚ï¼š<code>-i eth0</code>æŒ‡å®šäº†è¦å¤„ç†ç»ç”±eth0è¿›å…¥çš„æ•°æ®åŒ…</li>
<li>å¦‚æœä¸æŒ‡å®š<code>-i</code>å‚æ•°ï¼Œé‚£ä¹ˆå°†å¤„ç†è¿›å…¥æ‰€æœ‰æ¥å£çš„æ•°æ®åŒ…</li>
<li>å¦‚æœå‡ºç°! <code>-i eth0</code>ï¼Œé‚£ä¹ˆå°†å¤„ç†æ‰€æœ‰ç»ç”±eth0ä»¥å¤–çš„æ¥å£è¿›å…¥çš„æ•°æ®åŒ…</li>
<li>å¦‚æœå‡ºç°<code>-i eth+</code>ï¼Œé‚£ä¹ˆå°†å¤„ç†æ‰€æœ‰ç»ç”±ethå¼€å¤´çš„æ¥å£è¿›å…¥çš„æ•°æ®åŒ…</li>
<li>è¿˜å¯ä»¥ä½¿ç”¨<code>â€“in-interface</code>å‚æ•°</li>
</ul>
<h3 id="o-è¾“å‡ºï¼ˆout-interfaceï¼‰"><a href="#o-è¾“å‡ºï¼ˆout-interfaceï¼‰" class="headerlink" title="-o è¾“å‡ºï¼ˆout interfaceï¼‰"></a>-o è¾“å‡ºï¼ˆout interfaceï¼‰</h3><p>-oä»£è¡¨â€output interfaceâ€<br>-oæŒ‡å®šäº†æ•°æ®åŒ…ç”±å“ªä¸ªæ¥å£è¾“å‡º<br>è¿™äº›æ•°æ®åŒ…å³å°†è¿›å…¥<code>FORWARD</code>, <code>OUTPUT</code>, <code>POSTROUTINGé“¾</code><br>å¦‚æœä¸æŒ‡å®š<code>-o</code>é€‰é¡¹ï¼Œé‚£ä¹ˆç³»ç»Ÿä¸Šçš„æ‰€æœ‰æ¥å£éƒ½å¯ä»¥ä½œä¸ºè¾“å‡ºæ¥å£<br>å¦‚æœå‡ºç°! <code>-o eth0</code>ï¼Œé‚£ä¹ˆå°†ä»eth0ä»¥å¤–çš„æ¥å£è¾“å‡º<br>å¦‚æœå‡ºç°<code>-i eth+</code>ï¼Œé‚£ä¹ˆå°†ä»…ä»ethå¼€å¤´çš„æ¥å£è¾“å‡º<br>è¿˜å¯ä»¥ä½¿ç”¨<code>â€“out-interface</code>å‚æ•°</p>
<h2 id="æè¿°è§„åˆ™çš„æ‰©å±•å‚æ•°"><a href="#æè¿°è§„åˆ™çš„æ‰©å±•å‚æ•°" class="headerlink" title="æè¿°è§„åˆ™çš„æ‰©å±•å‚æ•°"></a>æè¿°è§„åˆ™çš„æ‰©å±•å‚æ•°</h2><p>å¯¹è§„åˆ™æœ‰äº†ä¸€ä¸ªåŸºæœ¬æè¿°ä¹‹åï¼Œæœ‰æ—¶å€™æˆ‘ä»¬è¿˜å¸Œæœ›æŒ‡å®šç«¯å£ã€<code>TCP</code>æ ‡å¿—ã€<code>ICMP</code>ç±»å‹ç­‰å†…å®¹ã€‚</p>
<h3 id="â€“sport-æºç«¯å£ï¼ˆsource-portï¼‰é’ˆå¯¹-p-tcp-æˆ–è€…-p-udp"><a href="#â€“sport-æºç«¯å£ï¼ˆsource-portï¼‰é’ˆå¯¹-p-tcp-æˆ–è€…-p-udp" class="headerlink" title="â€“sport æºç«¯å£ï¼ˆsource portï¼‰é’ˆå¯¹ -p tcp æˆ–è€… -p udp"></a>â€“sport æºç«¯å£ï¼ˆsource portï¼‰é’ˆå¯¹ -p tcp æˆ–è€… -p udp</h3><ul>
<li>ç¼ºçœæƒ…å†µä¸‹ï¼Œå°†åŒ¹é…æ‰€æœ‰ç«¯å£</li>
<li>å¯ä»¥æŒ‡å®šç«¯å£å·æˆ–è€…ç«¯å£åç§°ï¼Œä¾‹å¦‚<code>â€“sport 22</code>ä¸<code>â€“sport ssh</code>ã€‚</li>
<li><code>/etc/services</code>æ–‡ä»¶æè¿°äº†ä¸Šè¿°æ˜ å°„å…³ç³»ã€‚</li>
<li>ä»æ€§èƒ½ä¸Šè®²ï¼Œä½¿ç”¨ç«¯å£å·æ›´å¥½</li>
<li>ä½¿ç”¨å†’å·å¯ä»¥åŒ¹é…ç«¯å£èŒƒå›´ï¼Œå¦‚<code>â€“sport 22:100</code></li>
<li>è¿˜å¯ä»¥ä½¿ç”¨<code>â€“source-port</code></li>
</ul>
<h3 id="â€“-dport-ç›®çš„ç«¯å£ï¼ˆdestination-portï¼‰é’ˆå¯¹-p-tcp-æˆ–è€…-p-udp"><a href="#â€“-dport-ç›®çš„ç«¯å£ï¼ˆdestination-portï¼‰é’ˆå¯¹-p-tcp-æˆ–è€…-p-udp" class="headerlink" title="â€“-dport ç›®çš„ç«¯å£ï¼ˆdestination portï¼‰é’ˆå¯¹-p tcp æˆ–è€… -p udp"></a>â€“-dport ç›®çš„ç«¯å£ï¼ˆdestination portï¼‰é’ˆå¯¹-p tcp æˆ–è€… -p udp</h3><ul>
<li>å‚æ•°å’Œ<code>â€“sport</code>ç±»ä¼¼</li>
<li>è¿˜å¯ä»¥ä½¿ç”¨<code>â€“destination-port</code></li>
</ul>
<h3 id="â€“tcp-flags-TCPæ ‡å¿—-é’ˆå¯¹-p-tcp"><a href="#â€“tcp-flags-TCPæ ‡å¿—-é’ˆå¯¹-p-tcp" class="headerlink" title="-â€“tcp-flags TCPæ ‡å¿— é’ˆå¯¹-p tcp"></a>-â€“tcp-flags TCPæ ‡å¿— é’ˆå¯¹-p tcp</h3><ul>
<li>å¯ä»¥æŒ‡å®šç”±é€—å·åˆ†éš”çš„å¤šä¸ªå‚æ•°</li>
<li>æœ‰æ•ˆå€¼å¯ä»¥æ˜¯ï¼š<code>SYN</code>, <code>ACK</code>, <code>FIN</code>, <code>RST</code>, <code>URG</code>, <code>PSH</code></li>
<li>å¯ä»¥ä½¿ç”¨<code>ALL</code>æˆ–è€…<code>NONE</code></li>
</ul>
<h3 id="â€“icmp-type-ICMPç±»å‹-é’ˆå¯¹-p-icmp"><a href="#â€“icmp-type-ICMPç±»å‹-é’ˆå¯¹-p-icmp" class="headerlink" title="-â€“icmp-type ICMPç±»å‹ é’ˆå¯¹-p icmp"></a>-â€“icmp-type ICMPç±»å‹ é’ˆå¯¹-p icmp</h3><ul>
<li><code>â€“icmp-type 0</code> è¡¨ç¤ºEcho Reply</li>
<li><code>â€“icmp-type 8</code> è¡¨ç¤ºEcho</li>
</ul>
<h2 id="è¿½åŠ è§„åˆ™çš„å®Œæ•´å®ä¾‹ï¼šä»…å…è®¸SSHæœåŠ¡"><a href="#è¿½åŠ è§„åˆ™çš„å®Œæ•´å®ä¾‹ï¼šä»…å…è®¸SSHæœåŠ¡" class="headerlink" title="è¿½åŠ è§„åˆ™çš„å®Œæ•´å®ä¾‹ï¼šä»…å…è®¸SSHæœåŠ¡"></a>è¿½åŠ è§„åˆ™çš„å®Œæ•´å®ä¾‹ï¼šä»…å…è®¸SSHæœåŠ¡</h2><p>æœ¬ä¾‹å®ç°çš„è§„åˆ™å°†ä»…å…è®¸SSHæ•°æ®åŒ…é€šè¿‡æœ¬åœ°è®¡ç®—æœºï¼Œå…¶ä»–ä¸€åˆ‡è¿æ¥ï¼ˆåŒ…æ‹¬pingï¼‰éƒ½å°†è¢«æ‹’ç»ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.æ¸…ç©ºæ‰€æœ‰iptablesè§„åˆ™</span></span><br><span class="line">iptables -F</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ¥æ”¶ç›®æ ‡ç«¯å£ä¸º22çš„æ•°æ®åŒ…</span></span><br><span class="line">iptables -A INPUT -i eth0 -p tcp --dport 22 -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.æ‹’ç»æ‰€æœ‰å…¶ä»–æ•°æ®åŒ…</span></span><br><span class="line">iptables -A INPUT -j DROP</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="æ›´æ”¹é»˜è®¤ç­–ç•¥"><a href="#æ›´æ”¹é»˜è®¤ç­–ç•¥" class="headerlink" title="æ›´æ”¹é»˜è®¤ç­–ç•¥"></a>æ›´æ”¹é»˜è®¤ç­–ç•¥</h1><p>ä¸Šä¾‹çš„ä¾‹å­ä»…å¯¹æ¥æ”¶çš„æ•°æ®åŒ…è¿‡æ»¤ï¼Œè€Œå¯¹äºè¦å‘é€å‡ºå»çš„æ•°æ®åŒ…å´æ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚æœ¬èŠ‚ä¸»è¦ä»‹ç»å¦‚ä½•æ›´æ”¹é“¾ç­–ç•¥ï¼Œä»¥æ”¹å˜é“¾çš„è¡Œä¸ºã€‚</p>
<h2 id="é»˜è®¤é“¾ç­–ç•¥"><a href="#é»˜è®¤é“¾ç­–ç•¥" class="headerlink" title="é»˜è®¤é“¾ç­–ç•¥"></a>é»˜è®¤é“¾ç­–ç•¥</h2><p>è­¦å‘Šï¼šè¯·å‹¿åœ¨è¿œç¨‹è¿æ¥çš„æœåŠ¡å™¨ã€è™šæ‹Ÿæœºä¸Šæµ‹è¯•ï¼<br>å½“æˆ‘ä»¬ä½¿ç”¨-Lé€‰é¡¹éªŒè¯å½“å‰è§„åˆ™æ˜¯å‘ç°ï¼Œæ‰€æœ‰çš„é“¾æ—è¾¹éƒ½æœ‰<code>policy ACCEPT</code>æ ‡æ³¨ï¼Œè¿™è¡¨æ˜å½“å‰é“¾çš„é»˜è®¤ç­–ç•¥ä¸º<code>ACCEPT</code>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># iptables -L</span></span><br><span class="line">Chain INPUT (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:ssh</span><br><span class="line">DROP       all  --  anywhere             anywhere            </span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination         </span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br></pre></td></tr></table></figure>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®æ·»åŠ DROPè§„åˆ™ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹å°†é‡‡ç”¨ACCEPTç­–ç•¥è¿›è¡Œè¿‡æ»¤ã€‚é™¤éï¼š</p>
<h3 id="ä¸ºä»¥ä¸Šä¸‰ä¸ªé“¾å•ç‹¬æ·»åŠ DROPè§„åˆ™ï¼š"><a href="#ä¸ºä»¥ä¸Šä¸‰ä¸ªé“¾å•ç‹¬æ·»åŠ DROPè§„åˆ™ï¼š" class="headerlink" title="ä¸ºä»¥ä¸Šä¸‰ä¸ªé“¾å•ç‹¬æ·»åŠ DROPè§„åˆ™ï¼š"></a>ä¸ºä»¥ä¸Šä¸‰ä¸ªé“¾å•ç‹¬æ·»åŠ DROPè§„åˆ™ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">iptables -A INPUT -j DROP</span><br><span class="line">iptables -A OUTPUT -j DROP</span><br><span class="line">iptables -A FORWARD -j DROP</span><br></pre></td></tr></table></figure>
<h3 id="æ›´æ”¹é»˜è®¤ç­–ç•¥ï¼š"><a href="#æ›´æ”¹é»˜è®¤ç­–ç•¥ï¼š" class="headerlink" title="æ›´æ”¹é»˜è®¤ç­–ç•¥ï¼š"></a>æ›´æ”¹é»˜è®¤ç­–ç•¥ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">iptables -P INPUT DROP</span><br><span class="line">iptables -P OUTPUT DROP</span><br><span class="line">iptables -P FORWARD DROP</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ ä¸¥æ ¼æŒ‰ç…§ä¸Šä¸€èŠ‚çš„ä¾‹å­é…ç½®äº†iptablesï¼Œå¹¶ä¸”ç°åœ¨ä½¿ç”¨çš„æ˜¯SSHè¿›è¡Œè¿æ¥çš„ï¼Œé‚£ä¹ˆä¼šè¯ææ€•å·²ç»è¢«è¿«ç»ˆæ­¢äº†ï¼<br>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å·²ç»æŠŠOUTPUTé“¾ç­–ç•¥æ›´æ”¹ä¸ºDROPäº†ã€‚æ­¤æ—¶è™½ç„¶æœåŠ¡å™¨èƒ½æ¥æ”¶æ•°æ®ï¼Œä½†æ˜¯æ— æ³•å‘é€æ•°æ®ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># iptables -L</span></span><br><span class="line">Chain INPUT (policy DROP)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:ssh</span><br><span class="line">DROP       all  --  anywhere             anywhere            </span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy DROP)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination         </span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy DROP)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br></pre></td></tr></table></figure>
<h1 id="é…ç½®åº”ç”¨ç¨‹åºè§„åˆ™"><a href="#é…ç½®åº”ç”¨ç¨‹åºè§„åˆ™" class="headerlink" title="é…ç½®åº”ç”¨ç¨‹åºè§„åˆ™"></a>é…ç½®åº”ç”¨ç¨‹åºè§„åˆ™</h1><p>å°½ç®¡5.4èŠ‚å·²ç»ä»‹ç»äº†å¦‚ä½•åˆæ­¥é™åˆ¶é™¤SSHä»¥å¤–çš„å…¶ä»–è¿æ¥ï¼Œä½†æ˜¯é‚£æ˜¯åœ¨é“¾é»˜è®¤ç­–ç•¥ä¸ºACCEPTçš„æƒ…å†µä¸‹å®ç°çš„ï¼Œå¹¶ä¸”æ²¡æœ‰å¯¹è¾“å‡ºæ•°æ®åŒ…è¿›è¡Œé™åˆ¶ã€‚æœ¬èŠ‚åœ¨ä¸Šä¸€èŠ‚åŸºç¡€ä¸Šï¼Œä»¥SSHå’ŒHTTPæ‰€ä½¿ç”¨çš„ç«¯å£ä¸ºä¾‹ï¼Œæ•™å¤§å®¶å¦‚ä½•åœ¨é»˜è®¤é“¾ç­–ç•¥ä¸ºDROPçš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œé˜²ç«å¢™è®¾ç½®ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†å¼•è¿›ä¸€ç§æ–°çš„å‚æ•°-m stateï¼Œå¹¶æ£€æŸ¥æ•°æ®åŒ…çš„çŠ¶æ€å­—æ®µã€‚</p>
<h2 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.å…è®¸æ¥æ”¶è¿œç¨‹ä¸»æœºçš„SSHè¯·æ±‚</span></span><br><span class="line">iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.å…è®¸å‘é€æœ¬åœ°ä¸»æœºçš„SSHå“åº”</span></span><br><span class="line">iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-m state</code>: å¯ç”¨çŠ¶æ€åŒ¹é…æ¨¡å—ï¼ˆstate matching moduleï¼‰</li>
<li><code>â€“-state</code>: çŠ¶æ€åŒ¹é…æ¨¡å—çš„å‚æ•°ã€‚å½“SSHå®¢æˆ·ç«¯ç¬¬ä¸€ä¸ªæ•°æ®åŒ…åˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼ŒçŠ¶æ€å­—æ®µä¸ºNEWï¼›å»ºç«‹è¿æ¥åæ•°æ®åŒ…çš„çŠ¶æ€å­—æ®µéƒ½æ˜¯ESTABLISHED</li>
<li><code>â€“sport 22</code>: sshdç›‘å¬22ç«¯å£ï¼ŒåŒæ—¶ä¹Ÿé€šè¿‡è¯¥ç«¯å£å’Œå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ã€ä¼ é€æ•°æ®ã€‚å› æ­¤å¯¹äºSSHæœåŠ¡å™¨è€Œè¨€ï¼Œæºç«¯å£å°±æ˜¯22</li>
<li><code>â€“dport 22</code>: sshå®¢æˆ·ç«¯ç¨‹åºå¯ä»¥ä»æœ¬æœºçš„éšæœºç«¯å£ä¸SSHæœåŠ¡å™¨çš„22ç«¯å£å»ºç«‹è¿æ¥ã€‚å› æ­¤å¯¹äºSSHå®¢æˆ·ç«¯è€Œè¨€ï¼Œç›®çš„ç«¯å£å°±æ˜¯22</li>
</ul>
<p>å¦‚æœæœåŠ¡å™¨ä¹Ÿéœ€è¦ä½¿ç”¨SSHè¿æ¥å…¶ä»–è¿œç¨‹ä¸»æœºï¼Œåˆ™è¿˜éœ€è¦å¢åŠ ä»¥ä¸‹é…ç½®ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.é€å‡ºçš„æ•°æ®åŒ…ç›®çš„ç«¯å£ä¸º22</span></span><br><span class="line">iptables -A OUTPUT -o eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ¥æ”¶çš„æ•°æ®åŒ…æºç«¯å£ä¸º22</span></span><br><span class="line">iptables -A INPUT -i eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</span><br></pre></td></tr></table></figure>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>HTTPçš„é…ç½®ä¸SSHç±»ä¼¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.å…è®¸æ¥æ”¶è¿œç¨‹ä¸»æœºçš„HTTPè¯·æ±‚</span></span><br><span class="line">iptables -A INPUT -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.å…è®¸å‘é€æœ¬åœ°ä¸»æœºçš„HTTPå“åº”</span></span><br><span class="line">iptables -A OUTPUT -o eth0 -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT</span><br></pre></td></tr></table></figure>
<h2 id="å®Œæ•´çš„é…ç½®"><a href="#å®Œæ•´çš„é…ç½®" class="headerlink" title="å®Œæ•´çš„é…ç½®"></a>å®Œæ•´çš„é…ç½®</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.åˆ é™¤ç°æœ‰è§„åˆ™</span></span><br><span class="line">iptables -F</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.é…ç½®é»˜è®¤é“¾ç­–ç•¥</span></span><br><span class="line">iptables -P INPUT DROP</span><br><span class="line">iptables -P FORWARD DROP</span><br><span class="line">iptables -P OUTPUT DROP</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.å…è®¸è¿œç¨‹ä¸»æœºè¿›è¡ŒSSHè¿æ¥</span></span><br><span class="line">iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.å…è®¸æœ¬åœ°ä¸»æœºè¿›è¡ŒSSHè¿æ¥</span></span><br><span class="line">iptables -A OUTPUT -o eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br><span class="line">iptables -A INPUT -i eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.å…è®¸HTTPè¯·æ±‚</span></span><br><span class="line">iptables -A INPUT -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -o eth0 -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>iptables</tag>
      </tags>
  </entry>
  <entry>
    <title>kcptun æœåŠ¡å™¨é…ç½®è¯´æ˜</title>
    <url>/2019/11/11/kcp-tun-config/</url>
    <content><![CDATA[<h1 id="é…ç½®æ ·ä¾‹"><a href="#é…ç½®æ ·ä¾‹" class="headerlink" title="é…ç½®æ ·ä¾‹"></a>é…ç½®æ ·ä¾‹</h1><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;listen&quot;</span>: <span class="string">&quot;:8888&quot;</span>,</span><br><span class="line"><span class="attr">&quot;target&quot;</span>: <span class="string">&quot;127.0.0.1:1080&quot;</span>,</span><br><span class="line"><span class="attr">&quot;key&quot;</span>: <span class="string">&quot;password&quot;</span>,</span><br><span class="line"><span class="attr">&quot;crypt&quot;</span>: <span class="string">&quot;salsa20&quot;</span>,</span><br><span class="line"><span class="attr">&quot;mode&quot;</span>: <span class="string">&quot;fast&quot;</span>,</span><br><span class="line"><span class="attr">&quot;mtu&quot;</span>: <span class="number">1400</span>,</span><br><span class="line"><span class="attr">&quot;sndwnd&quot;</span>: <span class="number">1024</span>,</span><br><span class="line"><span class="attr">&quot;rcvwnd&quot;</span>: <span class="number">1024</span>,</span><br><span class="line"><span class="attr">&quot;datashard&quot;</span>: <span class="number">10</span>,</span><br><span class="line"><span class="attr">&quot;parityshard&quot;</span>: <span class="number">3</span>,</span><br><span class="line"><span class="attr">&quot;dscp&quot;</span>: <span class="number">46</span>,</span><br><span class="line"><span class="attr">&quot;nocomp&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="attr">&quot;acknodelay&quot;</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="attr">&quot;sockbuf&quot;</span>: <span class="number">16777217</span>,</span><br><span class="line"><span class="attr">&quot;smuxbuf&quot;</span>: <span class="number">16777217</span>,</span><br><span class="line"><span class="attr">&quot;streambuf&quot;</span>:<span class="number">16777217</span>,</span><br><span class="line"><span class="attr">&quot;smuxver&quot;</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">&quot;keepalive&quot;</span>: <span class="number">10</span>,</span><br><span class="line"><span class="attr">&quot;pprof&quot;</span>:<span class="literal">false</span>,</span><br><span class="line"><span class="attr">&quot;quiet&quot;</span>:<span class="literal">true</span>,</span><br><span class="line"><span class="attr">&quot;tcp&quot;</span>:<span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="é…ç½®è¯´æ˜"><a href="#é…ç½®è¯´æ˜" class="headerlink" title="é…ç½®è¯´æ˜"></a>é…ç½®è¯´æ˜</h1><table>
<thead>
<tr>
<th align="left">é…é¡¹</th>
<th align="left">å€¼</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">listen</td>
<td align="left">â€œ:33523â€</td>
<td align="left">kcp server å¼€æ”¾çš„ç«¯å£</td>
</tr>
<tr>
<td align="left">target</td>
<td align="left">â€œ127.0.0.1:33522â€</td>
<td align="left">æœ¬åœ°shadowsocks æœåŠ¡ç›‘å¬çš„ç«¯å£</td>
</tr>
<tr>
<td align="left">key</td>
<td align="left">â€œigwcwmtdâ€</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">crypt</td>
<td align="left">â€œsalsa20â€</td>
<td align="left">salsa20å¯¹ armèŠ¯ç‰‡å‹å¥½</td>
</tr>
<tr>
<td align="left">mode</td>
<td align="left">â€œfastâ€</td>
<td align="left">å¦‚ä¸æ˜¯ç«ŸæŠ€æ¸¸æˆï¼Œ<code>fast</code>è¶³çŸ£</td>
</tr>
<tr>
<td align="left">mtu</td>
<td align="left">1400</td>
<td align="left">ä¸é‡è¦ï¼Œcopyå³å¯</td>
</tr>
<tr>
<td align="left">sndwnd</td>
<td align="left">1024</td>
<td align="left">ä¸è¦ä½äº512ï¼Œä¹Ÿä¸è¦è¿‡é«˜</td>
</tr>
<tr>
<td align="left">rcvwnd</td>
<td align="left">1024</td>
<td align="left">åŒä¸Š</td>
</tr>
<tr>
<td align="left">datashard</td>
<td align="left">10</td>
<td align="left"><code>datashard</code>å’Œ<code>partyshared</code> ä¸¤ä¸ªæ•°å­—çš„æ¯”ï¼Œæ¶‰åŠåˆ°çº é”™ç†è®ºï¼Œ 3/10ï¼Œå®æµ‹æ²¡å•¥é—®é¢˜ã€‚è¿‡é«˜çš„æ¯”é‡ä¼šè¿‡åº¦æ”¾å¤§æµé‡</td>
</tr>
<tr>
<td align="left">parityshard</td>
<td align="left">3</td>
<td align="left">åŒä¸Š</td>
</tr>
<tr>
<td align="left">dscp</td>
<td align="left">46</td>
<td align="left">46 æ˜¯ç´§æ€¥æŒ‡é’ˆã€‚è®©ä½ çš„æµé‡åœ¨ç½‘åœ¨å…¬ç½‘ä¸Šæˆä¸º<code>VIP</code></td>
</tr>
<tr>
<td align="left">nocomp</td>
<td align="left">true</td>
<td align="left">ä¸å‹ç¼©</td>
</tr>
<tr>
<td align="left">acknodelay</td>
<td align="left">false</td>
<td align="left">ä¸ç­‰å¾…</td>
</tr>
<tr>
<td align="left">sockbuf</td>
<td align="left">16777217</td>
<td align="left">ä»¥ä¸‹ä¸‰ä¸ª<code>buf</code>æ˜¯ç¼“å­˜ï¼Œå¦‚æœæ˜¯æ‰‹æœºï¼Œè¦è®¾ç½®å°ç‚¹ï¼Œ1ï½2Må°±å¥½</td>
</tr>
<tr>
<td align="left">smuxbuf</td>
<td align="left">16777217</td>
<td align="left">åŒä¸Š</td>
</tr>
<tr>
<td align="left">streambuf</td>
<td align="left">16777217</td>
<td align="left">åŒä¸Š</td>
</tr>
<tr>
<td align="left">smuxver</td>
<td align="left">2</td>
<td align="left">è¿™é‡Œæ˜¯å¤šè·¯å¤ç”¨çš„åè®®ç‰ˆæœ¬ã€‚é€‰<code>2</code>ï¼Œæ›´ä¼˜</td>
</tr>
<tr>
<td align="left">keepalive</td>
<td align="left">10</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">pprof</td>
<td align="left">false</td>
<td align="left">è¿™æ˜¯debugï¼Œä¸éœ€è¦</td>
</tr>
<tr>
<td align="left">quiet</td>
<td align="left">true</td>
<td align="left">æ—¥å¿—ä¸éœ€è¦å¤ªè¯¦ç»†</td>
</tr>
<tr>
<td align="left">tcp</td>
<td align="left">false</td>
<td align="left">æ˜¯å¦ä¼ªè£…æˆ<code>tcp</code>è¿æ¥</td>
</tr>
</tbody></table>
<h2 id="mode-ç‰¹åˆ«è¯´æ˜"><a href="#mode-ç‰¹åˆ«è¯´æ˜" class="headerlink" title="mode ç‰¹åˆ«è¯´æ˜"></a><code>mode</code> ç‰¹åˆ«è¯´æ˜</h2><p><code>mode</code> é¡¹å…¶å®æ˜¯ <code>nodelay</code>ã€<code>interval</code>ã€<code>resend</code>ã€<code>nc</code> 4é¡¹çš„ä¸€ä¸ªç»„åˆã€‚å®ƒä»¬çš„å¯¹åº”å…³ç³»æ˜¯ï¼š</p>
<table>
<thead>
<tr>
<th align="left">mode</th>
<th align="left">nodelay</th>
<th align="left">interval</th>
<th align="left">resend</th>
<th align="left">nc</th>
</tr>
</thead>
<tbody><tr>
<td align="left">normal</td>
<td align="left">0</td>
<td align="left">40</td>
<td align="left">2</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">fast</td>
<td align="left">0</td>
<td align="left">30</td>
<td align="left">2</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">fast1</td>
<td align="left">1</td>
<td align="left">20</td>
<td align="left">2</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">fast2</td>
<td align="left">1</td>
<td align="left">10</td>
<td align="left">2</td>
<td align="left">1</td>
</tr>
</tbody></table>
<p>å¦‚æœä¸æ»¡æ„äºè‡ªå¸¦çš„4ä¸ª<code>mode</code>ã€‚å¯ä»¥å°†<code>mode</code>è®¾ç½®ä¸º<code>manual</code>ã€‚ç„¶åå°±èƒ½æ‰‹åŠ¨å®šåˆ¶è¿™4é¡¹å‚æ•°äº†ï¼</p>
]]></content>
      <tags>
        <tag>kcp</tag>
        <tag>tun</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaå¤šä¸ªå¼‚æ­¥ä»»åŠ¡è½¬åŒæ­¥</title>
    <url>/2020/03/10/java-async-sync/</url>
    <content><![CDATA[<p>Java[kotlin]å¯¹äºå¼‚æ­¥çš„ç½‘ç»œè¯·æ±‚ï¼Œä¸€èˆ¬é‡‡ç”¨å›è°ƒæ¥å®ç°å¼‚æ­¥ï¼<br>è™½ç„¶ï¼Œåƒ<code>OkHttp</code>åº“ï¼Œå·²ç»æ”¯æŒåˆ°äº†åŒæ­¥ï¼Œä½†å¶å°”è¿˜æ˜¯ä¼šç¢°åˆ°ä¸¤ç§ç»•ä¸è¿‡çš„æƒ…å†µï¼š</p>
<ul>
<li>ä¾ç„¶æœ‰å¾ˆå¤šå¿…ç„¶æ˜¯å¼‚æ­¥çš„åœºæ™¯æ— æ³•ç»•è¿‡ã€‚å¦‚ï¼šAndroidçš„è¯·æ±‚æƒé™ã€è°ƒç”¨ç›¸æœºç­‰ç­‰ã€‚</li>
<li>å¤šä»»åŠ¡å¹¶å‘æ§åˆ¶ã€‚<ul>
<li>å¹¶å‘ã€‚å¦‚ï¼šNä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œä»»åŠ¡ã€‚å½“Nä¸ªä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œåï¼Œå†æ‰§è¡Œåç»­é€»è¾‘ã€‚</li>
<li>å¯æ§çš„å¹¶å‘ã€‚å¦‚ï¼šæœ‰Nä¸ªä»»åŠ¡ï¼Œåœ¨Mä¸ªçº¿ç¨‹ä¸­å¹¶å‘æ‰§è¡Œã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>è¿™é‡Œæˆ‘è¦ç»•å¼€â€œçº¿ç¨‹åŒæ­¥é”â€æ–¹æ¡ˆã€‚è¿™ä¸œè¥¿å†™æ³•çº·ç¹å†—é•¿ï¼Œä¸”è€ƒéªŒâ€œæ™ºå•†â€ã€‚</p>
</blockquote>
<h1 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h1><p> å•ä¸ªå¼‚æ­¥ä¸ä¼šè®©ä»£ç ä¹¦å†™å¾—å¤šä¹ˆè€ƒéªŒæ™ºå•†ã€‚å½“æ•°é‡å˜æˆï¼š<code>x</code>åã€‚é—®é¢˜å°±å˜å¾—ä¸ä¸€æ ·äº†ã€‚å¦‚ï¼š</p>
<ul>
<li>å‡è®¾ä¸€ä¸ªå‰æï¼šæŸä¸šåŠ¡å¿…é¡»ä½¿ç”¨å›è°ƒæ¥å®Œæˆä¸€æ¬¡è¯·æ±‚ï¼Œç°æœ‰<code>n</code>ä¸ªè¯·æ±‚ï¼Œé€ä¸ªå®Œæˆã€‚</li>
</ul>
<p>å¼‚æ­¥å®ç°çš„ä»£ç æ ·ä¾‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> isSync = <span class="literal">false</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">sync</span><span class="params">(completion: () -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isSync) &#123;</span><br><span class="line">            isSync = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">val</span> lastId = database.table(<span class="string">&quot;msgs&quot;</span>).getLast()?.msg_id ?: <span class="string">&quot;&quot;</span></span><br><span class="line">            Thread(Runnable &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                       fetchNext(lastId, completion)</span><br><span class="line">                &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">                       e.printStackTrace()</span><br><span class="line">                       isSync = <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="string">&quot;SyncWorker&quot;</span>).start()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">fetchNext</span><span class="params">(lastId: <span class="type">String</span>, completion: () -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> req = NewRequest()</span><br><span class="line">        req.query.msgId = lastId</span><br><span class="line">        Client.send(req.build()) &#123; r, ok -&gt;</span><br><span class="line">            <span class="keyword">if</span> (ok) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!r.hasNext) &#123;</span><br><span class="line">                    <span class="comment">// æ•°æ®å·²å–å®Œ</span></span><br><span class="line">                    completion()</span><br><span class="line">                    isSync = <span class="literal">false</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// æœªå–å®Œï¼Œç»§ç»­å¾ªç¯</span></span><br><span class="line">                    <span class="keyword">val</span> msg = NewMsgRow(r.body)</span><br><span class="line">                    database.table(<span class="string">&quot;msgs&quot;</span>).insert(msg)</span><br><span class="line">                    fetchNext(m.msgId, completion)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// è¯·æ±‚å‡ºé”™ï¼Œæ•´ä¸ªæ”¾å¼ƒ!</span></span><br><span class="line">                completion()</span><br><span class="line">                isSync = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="å¼‚æ­¥çš„ç¼ºç‚¹"><a href="#å¼‚æ­¥çš„ç¼ºç‚¹" class="headerlink" title="å¼‚æ­¥çš„ç¼ºç‚¹"></a>å¼‚æ­¥çš„ç¼ºç‚¹</h2><ul>
<li>çƒ§è„‘ï¼Œä¹Ÿæ˜¯åŸ¹å…»Bugçš„æ¸©åºŠï¼</li>
<li>å®¹æ˜“æ»‹ç”ŸBugï¼Œè‡ªç„¶éš¾äºè°ƒè¯•ã€‚ä¸”éš¾ä»¥ç¡®ä¿æ²¡æœ‰bugï¼</li>
<li>é€’å½’å¯¼è‡´è°ƒç”¨æ ˆè¿‡æ·±ï¼Œåƒä¸å¿…è¦çš„å†…å­˜ï¼</li>
</ul>
<p>å¦‚æœæ˜¯åŒæ­¥çš„æƒ…å†µä¸‹ï¼Œä»£ç ä¼šå¾ˆä¼˜é›…ã€‚</p>
<p>åŒæ­¥ä»£ç æ ·ä¾‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> isSync = <span class="literal">false</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">sync</span><span class="params">()</span></span> &#123;</span><br><span class="line">        isSync = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">var</span> ok = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">while</span>(!ok)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">val</span> rs = NewReuest().query(<span class="string">&quot;msgId&quot;</span>,id).send()</span><br><span class="line">                <span class="keyword">val</span> msg = NewMsgRow(rs.body)</span><br><span class="line">                database.table(<span class="string">&quot;msgs&quot;</span>).insert(msg)</span><br><span class="line">            &#125;<span class="keyword">catch</span>(e:Exception)&#123;</span><br><span class="line">                ok = <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="å¼‚æ­¥è½¬åŒæ­¥"><a href="#å¼‚æ­¥è½¬åŒæ­¥" class="headerlink" title="å¼‚æ­¥è½¬åŒæ­¥"></a>å¼‚æ­¥è½¬åŒæ­¥</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿè¿˜æœ‰ä¸ªæ¦‚å¿µå¯ç”¨ï¼Œé‚£å°±æ˜¯ï¼šâ€œä¿¡å·å’Œé‡â€ã€‚<br>Javaçš„<code>Semaphore</code>ï¼Œåœ¨ä½¿ç”¨ <code>await</code>æ—¶ï¼Œéœ€è¦è°ƒæ•´JVMçš„optionï¼›ä¸æ˜¯ä¸ªå¥½é€‰æ‹©ï¼<br>ä¸è¿‡ï¼ŒJavaè¿˜æä¾›äº†å¦ä¸€ä¸ªä¸œè¥¿ï¼š<code>CountDownLatch</code>å¯ä¾›é€‰æ‹©ã€‚å®ƒçš„<code>await</code>å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p>
<p>ä»£ç æ ·ä¾‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚æ­¥è½¬åŒæ­¥</span></span><br><span class="line">    <span class="meta">@Throws(Exception::class)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">req</span><span class="params">(id:<span class="type">String</span>)</span></span>:Body&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªåªè¦ä¸€ä¸ªä¿¡å·çš„é”</span></span><br><span class="line">        <span class="keyword">val</span> c = CountDownLatch(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">var</span> e:Exception? = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">var</span> rs:Body = EmptyBody()</span><br><span class="line"></span><br><span class="line">        Client.send(NewRequest()) &#123; r, err -&gt;</span><br><span class="line">            <span class="keyword">if</span>(err) e = err</span><br><span class="line">            <span class="keyword">else</span> rs = r.body</span><br><span class="line">            <span class="comment">// é‡Šæ”¾é”</span></span><br><span class="line">            c.countDown()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç­‰å¾…ä¿¡å·</span></span><br><span class="line">        c.await()</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">null</span>) <span class="keyword">throw</span> e!!</span><br><span class="line">        <span class="keyword">return</span> rs!!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="å¼‚æ­¥å¹¶å‘æ§åˆ¶"><a href="#å¼‚æ­¥å¹¶å‘æ§åˆ¶" class="headerlink" title="å¼‚æ­¥å¹¶å‘æ§åˆ¶"></a>å¼‚æ­¥å¹¶å‘æ§åˆ¶</h1><p>è¿™ä¸ªä¿¡å·é‡çš„<code>Semaphore</code>å°±å¯ä»¥é€‚ç”¨äº†ã€‚</p>
<p>ç”¨æ³•ä¸¾ä¾‹ï¼š20ä¸ªä»»åŠ¡ï¼Œ5ä¸ªå¹¶å‘</p>
<p>ä»£ç æ ·ä¾‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">mutiTask</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»º5ä¸ªè½¦é“</span></span><br><span class="line">        <span class="keyword">val</span> s = Semaphore(<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0.</span><span class="number">.20</span>)&#123;</span><br><span class="line">            <span class="comment">// ç­‰ç»¿ç¯</span></span><br><span class="line">            s.acquire()</span><br><span class="line">            Client.req(NewRequest())&#123;rs,err -&gt;</span><br><span class="line">                <span class="comment">// å¤„ç†rs,err....</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment">// é€šè¿‡åé‡Šæ”¾è½¦é“</span></span><br><span class="line">                s.release()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>Java</tag>
        <tag>kotlin</tag>
        <tag>async</tag>
      </tags>
  </entry>
  <entry>
    <title>Laravel Notification æµ‹è¯„</title>
    <url>/2016/12/15/laravel-notification/</url>
    <content><![CDATA[<p>Laravel 5.3 æ–°å‡ºäº†ä¸ªå« <code>Notification</code> çš„æ¶ˆæ¯é€šçŸ¥åŠŸèƒ½ï¼å…ˆæ€»ï¼Œååˆ†å§ã€‚</p>
<h2 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h2><p>å®ƒç›¸å¯¹<code>event</code>çš„ä¼˜ç‚¹æ˜¯ï¼šæ›´ç®€å•ä¹Ÿæ›´å¥½åœ°éš”ç¦»äº†ä¸åŒçš„ä¸šåŠ¡ä»£ç ã€‚ä¸”ä¸€æ¬¡è§¦å‘ï¼Œå¤šç§â€™å§¿åŠ¿â€™è¿è¡Œï¼Œä¸åŒâ€™å§¿åŠ¿â€™ä»£ç ç‹¬ç«‹ã€‚</p>
<p>é€‚åˆäºå‘æ¯”è¾ƒå¤æ‚çš„è·¨ç«™æ¶ˆæ¯ï¼Œå¦‚ï¼šé‚®ä»¶ã€åŒæ­¥weiboã€OAç³»ç»Ÿã€ç¬¬ä¸‰æ–¹ä¸ªäººç¬”è®°Ever-noteç­‰ã€‚ä¸åªé€‚åˆå•å‘ï¼Œè¿˜é€‚åˆä¸åŒæ¸ é“å¹¶å‘ã€‚æ¯”å¦‚ï¼šåŒä¸€ä¸ªæ¶ˆæ¯åŒæ—¶å‘é€å‰è¾¹åˆ—å‡ºçš„æ‰€æœ‰æ¸ é“ã€‚</p>
<p>å®ƒè¿˜æœ‰ä¸ªä¼˜ç‚¹æ˜¯ï¼Œä¹Ÿèƒ½åšä¸€ä¸ªLogï¼Œè®°å½•æ‰€æœ‰çš„å‘é€ç»“æœã€‚è¿˜èƒ½æ”¯æŒæ£€æµ‹å¹¶è®°å½•ï¼š<strong>æ¥æ”¶è€…å¯¹æ¶ˆæ¯çš„æŸ¥çœ‹çŠ¶æ€</strong>ã€‚</p>
<p>ä¸è¶³çš„åœ°æ–¹æ˜¯ï¼šé»˜è®¤æ”¯æŒçš„å®ç”¨å·¥å…·åƒ<code>mail</code>ã€<code>nexmo</code>ã€<code>slack</code>ã€‚é™¤äº†<code>mail</code>ï¼Œå…¶å®ƒä¸¤ä¸ªï¼Œæˆ‘å¤©æœå­æ°‘éƒ½ç”¨ä¸ä¸Šã€‚åªèƒ½ç”¨ç‚¹æœ¬åœ°çš„æ¸ é“ï¼Œå¦‚ï¼š<code>database</code>ã€<code>broadcast</code>ã€‚<br>è™½ç„¶é»˜è®¤çš„æœ‰ç‚¹å°‘ï¼Œä½†å®˜æ–¹è¿˜æäº†ä¸ª<a class="link"   href="http://laravel-notification-channels.com/" >ç¬¬ä¸‰æ–¹æ¶ˆæ¯é›†åˆçš„ç½‘ç«™<i class="fas fa-external-link-alt"></i></a>ã€‚åœ¨è¿™é‡Œèƒ½æ‰¾åˆ°ä¸€å †å¥‡è‘©çš„ï¼Œå¸¸è§çš„ï¼Œæ‹¿æ¥å°±èƒ½ç”¨çš„ç¬¬ä¸‰æ–¹æ¶ˆæ¯æ‰©å±•ã€‚<strong>ä½†æ˜¯</strong>ï¼Œä¾æ—§å¾ˆå°‘æœ‰æˆ‘å¤©æœå¯ä»¥ç›´æ¥ç”¨çš„ã€‚ä¹è§‚åœ°çœ‹ï¼šç»™äº†ä½ æˆ‘ä¸€ä¸ªå®Œå–„çš„æœºä¼šï¼æ‚²è§‚çš„çœ‹ï¼šè‡ªå·±å†™æ‰æ˜¯ç‹é“ï¼æ€»ä¹‹ï¼šè¿˜æ˜¯è‡ªå·±å†™ï¼</p>
<h2 id="å¯¹è±¡ä»‹ç»"><a href="#å¯¹è±¡ä»‹ç»" class="headerlink" title="å¯¹è±¡ä»‹ç»"></a>å¯¹è±¡ä»‹ç»</h2><p>ç›¸å…³çš„ç±»æœ‰ï¼š</p>
<p><code>Notification</code>ï¼šå‘å‡ºä¸€ä¸ªæ¶ˆæ¯åï¼Œä¸šåŠ¡å°±äº¤ç»™å®ƒäº†ã€‚è¿™é‡Œç”Ÿæˆé€‚åˆä¸åŒæ¸ é“çš„æ¶ˆæ¯ï¼Œå¹¶äº¤ç»™ä¸åŒæ¸ é“å»å‘é€ã€‚</p>
<p><code>Channel</code>ï¼šè¿™é‡Œå®šä¹‰è¿™ä¸ªæ¸ é“å…·ä½“çš„å‘é€æµç¨‹</p>
<p><code>Message</code>ï¼šè¿™æ˜¯ä¸ªæ ¼å¼åŒ–ä¸åŒæ¶ˆæ¯çš„åŠ©æ‰‹ç±»ã€‚å¦‚æœæ¶ˆæ¯ä½“ç®€å•ï¼Œå¯ä»¥ä¸ç”¨å®ƒï¼Œç›´æ¥åœ¨<code>Notification</code>ä¸­æ‹¼åˆæ¶ˆæ¯ä½“ã€‚å¦‚æœæ¶ˆæ¯ä½“å¤æ‚ï¼Œå°±æœ‰å¿…è¦ä¸“é—¨ä¸ºæ ¼å¼åŒ–è¿™ä¸ªæ¶ˆæ¯å†™ä¸€ä¸ª<code>Message</code>Builder Helperã€‚</p>
<h3 id="ç±»ç»“æ„"><a href="#ç±»ç»“æ„" class="headerlink" title="ç±»ç»“æ„"></a>ç±»ç»“æ„</h3><p><code>Notification</code> è¿™ä¸ªç±»laravel çš„ artisan æœ‰æä¾›make</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">class DemoNotification extends Notification</span><br><span class="line">&#123;</span><br><span class="line">    use Queueable;</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * Create a new notification instance.</span><br><span class="line">     *</span><br><span class="line">     */</span><br><span class="line">    public function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        //</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è¿™é‡Œè¿”å›è¦å‘å¤šå°‘ä¸ªæ¸ é“</span><br><span class="line">     *</span><br><span class="line">     * @param  mixed  $notifiable</span><br><span class="line">     * @return array</span><br><span class="line">     */</span><br><span class="line">    public function via($notifiable)</span><br><span class="line">    &#123;</span><br><span class="line">        return [DemoChannel::class];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * åè¾¹æŒ¨ä¸ªæ¸ é“ç»™ç”Ÿæˆæ¶ˆæ¯ï¼Œå¦‚æœ‰å¿…è¦ï¼Œä½¿ç”¨MessageåŠ©æ‰‹</span><br><span class="line">     * è¿™é‡Œçš„å‘½åé»˜å¥‘åœ°ä½¿ç”¨ &#x27;to&#x27; + æ¸ é“å</span><br><span class="line">     */</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    public function toDemo($notifiable)</span><br><span class="line">    &#123;</span><br><span class="line">        return (new DemoMessage)</span><br><span class="line">                -&gt;title(&#x27;è¿™é‡Œæ˜¯æ ‡é¢˜&#x27;)</span><br><span class="line">                -&gt;body(&#x27;è¿™é‡Œæ˜¯æ¶ˆæ¯ä¸»ä½“&#x27;)</span><br><span class="line">                -&gt;from(&#x27;å‘é€è€…&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Channel</code> æ¯ä¸ªæ¸ é“å¿…é¡»å®ç°ä¸€ä¸ªsend($notifiable,Notification $notification) åŠ¨ä½œ</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">class DemoChannel</span><br><span class="line">&#123;</span><br><span class="line">    public function send($notifiable,Notification $notification)&#123;</span><br><span class="line">        $msg = $notification-&gt;toDemo($notifiable);</span><br><span class="line">        // åè¾¹å»å®ç°æ€ä¹ˆæŠŠè¿™ä¸ª$msgç»™æ‰”å‡ºå»ï¼</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Message</code> å‘½åé»˜å¥‘åœ°ä½¿ç”¨â€™Messageâ€™ç»“å°¾ï¼Œè¿™ä¸ªç±»æ²¡æœ‰çº¦æŸï¼Œæ²¡æœ‰ç»§æ‰¿ã€‚å®Œå…¨æŒ‰éœ€å‘æŒ¥ï¼</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">class DemoMessage</span><br><span class="line">&#123;</span><br><span class="line">    // æŒ‰ä¸åŒæ¶ˆæ¯çš„éœ€è¦è‡ªå·±å®ç°å•¦ï¼Œè¿™ä¸ªç±»æ²¡æœ‰çº¦æŸ</span><br><span class="line">    public function title($title)</span><br><span class="line">    &#123;&#125;</span><br><span class="line">    public function body($body)</span><br><span class="line">    &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>laravel</tag>
        <tag>notification</tag>
      </tags>
  </entry>
  <entry>
    <title>laravel é˜Ÿåˆ—ä¹‹å‘</title>
    <url>/2016/12/13/laravel-queue/</url>
    <content><![CDATA[<p>æ‰¹é‡å‘æ¶ˆæ¯ä¹‹ç±»çš„å·¥ä½œï¼Œå¾ˆæ˜¯é€‚åˆæ”¾åˆ°åç«¯ï¼Œæ…¢æ…¢å¤„ç†ã€‚é‚£ä½¿ç”¨laravelçš„Queueå’ŒJobï¼Œå°±æˆä¸ºå¿…é¡»ã€‚</p>
<p>ç®€å•è¿‡äº†ä¸€ä¸‹æ–‡æ¡£åï¼Œå°±å†™å¥½äº†å‘å¸ƒä¸Šçº¿äº†ã€‚æ„Ÿè§‰ç¡®æ˜¯ä¸é”™ã€‚</p>
<p>ä¸è¿‡è¿‘æœŸçªç„¶çˆ†äº†ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œæœ‰äº›ç¾¤å‘æ€»æ˜¯æ²¡å®Œæ²¡äº†çš„é‡å¤å‘é€ã€‚ä½†æ˜¯å½“æˆ‘æµ‹è¯•æ—¶ï¼Œæ€»æ˜¯ä¸€åˆ‡æ­£å¸¸ï¼</p>
<p>ä¸€æ—¶è’™äº†ä¸ªé€¼ï¼åˆæ˜¯debugï¼ˆé˜Ÿåˆ—çš„debugå¾ˆæ˜¯ç¹çä½æ•ˆï¼ï¼‰åˆæ˜¯Googleåˆæ˜¯ç™¾åº¦ã€‚ä¸€ç¿»æœç½—ï¼Œæœ‰äººè¯´æ˜¯æ—¶é—´çš„é—®é¢˜ã€‚</p>
<p>60s!</p>
<p>é˜Ÿåˆ—å°†ä¸€ä¸ªä»»åŠ¡å‘å‡ºåï¼Œå¦‚æœ60så†…æ²¡æ‰§è¡Œå®Œï¼Œå°±ä¼šè®¤ä¸ºå¤„ç†è¿‡ç¨‹å¼‚å¸¸ã€‚å®ƒä¼šæŠŠè¿™ä¸ªä»»åŠ¡å†é‡æ–°æ‰§è¡Œä¸€éï¼</p>
<p>å˜¿å˜¿äº†ï¼</p>
<p>ç¿»äº†ä¸‹æºç ï¼Œåœ¨<code>InteractsWithQueue</code>çš„<code>trait</code>é‡Œå‘ç°äº†ä¸€ä¸ª<code>delete</code>æ–¹æ³•ï¼</p>
<p>åœ¨æˆ‘çš„<code>Job</code>å¼€å§‹<code>handle</code>åï¼Œå…ˆæ‰§è¡Œä¸€ä¸‹<code>$this-&gt;delete();</code>æŠŠè¿™ä¸ªä»»åŠ¡åˆ é™¤ã€‚è¿™æ ·å³ä¾¿è¿‡äº†60såï¼Œå®ƒæƒ³é‡æ–°å¯åŠ¨ä¹Ÿæ²¡æœ‰äº†ã€‚è¿™é—®é¢˜ä¹Ÿå°±æš‚æ—¶è§£å†³äº†ï¼</p>
<p>ä½†æ˜¯ï¼å¦‚æœè¿™ä¸ªä»»åŠ¡å¤„ç†è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œä¹Ÿä¼šä¸§å¤±2æ¬¡é‡æ–°æ‰§è¡Œçš„æœºä¼šã€‚æ‰€ä»¥<em>Laravelçš„Jobä¸­æœ€å¥½åªå¤„ç†ä¸€ä»¶ç®€å•çš„åŸå­åŒ–çš„äº‹ã€‚ä¸è¦åœ¨æ‰¹é‡é‡Œå¤„ç†æ‰¹é‡ã€‚</em></p>
]]></content>
      <tags>
        <tag>laravel</tag>
        <tag>Job</tag>
        <tag>Queue</tag>
      </tags>
  </entry>
  <entry>
    <title>linuxå¸¸ç”¨Shellå‘½ä»¤</title>
    <url>/2021/01/18/linux-cmd/</url>
    <content><![CDATA[<ul>
<li>æ‰¾å‡ºæŒ‡å®šæ–‡ä»¶å¤¹ä¸‹æŒ‡å®šç±»å‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶å…¨éƒ¨åˆ é™¤<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find /home/user/mydir -name *.png | xargs rm -f</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ Let&#39;s Encrypt ç»™Nginxç½‘ç«™åŠ å¯†</title>
    <url>/2017/01/12/lets-encrypt-nginx/</url>
    <content><![CDATA[<p>ä½¿ç”¨<a class="link"   href="https://certbot.eff.org/#freebsd-nginx" >certbot<i class="fas fa-external-link-alt"></i></a>ç®¡ç†è¯ä¹¦ã€‚</p>
<p>åœ¨FreeBSDä¸­å®‰è£…ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">sudo pkg install certbot</span><br></pre></td></tr></table></figure>
<p>è·å–è¯ä¹¦ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">certbot certonly --webroot -w /var/www/example -d example.com </span><br></pre></td></tr></table></figure>
<p>å®Œäº‹åï¼Œè¯ä¹¦åœ¨ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">/usr/local/etc/letsencrypt/live/example.com/</span><br></pre></td></tr></table></figure>
<p>ç›®å½•ä¸­ã€‚</p>
<p>é…ç½®Nginx è™šæ‹Ÿæœºï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">    listen     80;</span><br><span class="line">    server_name example.com;</span><br><span class="line">    root    /var/www/example;</span><br><span class="line"></span><br><span class="line">    add_header Cache-Control no-store;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen  443 ssl;</span><br><span class="line">    server_name example.com;</span><br><span class="line">    root /var/www/example;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ssl                  on;</span><br><span class="line"></span><br><span class="line">    ssl_certificate /usr/local/etc/letsencrypt/live/example.com/fullchain.pem;</span><br><span class="line">    ssl_certificate_key /usr/local/etc/letsencrypt/live/example.com/privkey.pem;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    ssl_ciphers AES256+EECDH:AES256+EDH:!aNULL;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>OKï¼å®Œäº‹ï¼æœ€å</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br><span class="line">sudo nginx -s reload</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>nginx</tag>
        <tag>lets-encrypt</tag>
        <tag>ssl</tag>
        <tag>https</tag>
      </tags>
  </entry>
  <entry>
    <title>MacOS å‘½ä»¤æŸ¥è¯¢ç½‘ç»œç«¯å£å ç”¨æƒ…å†µ</title>
    <url>/2019/07/13/macos-find-port-by-cmd/</url>
    <content><![CDATA[<h2 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h2><blockquote>
<p>netstat -an | grep 80</p>
</blockquote>
<h2 id="lsof"><a href="#lsof" class="headerlink" title="lsof"></a>lsof</h2><blockquote>
<p>lsof -i:80</p>
</blockquote>
<blockquote>
<p>lsof -c nsqd</p>
</blockquote>
]]></content>
      <tags>
        <tag>MacOS</tag>
        <tag>lsof</tag>
        <tag>netstat</tag>
      </tags>
  </entry>
  <entry>
    <title>é¼ æ ‡å«è®¾è®¡</title>
    <url>/2021/01/26/mouse-pad/</url>
    <content><![CDATA[<p><img src="https://user-images.githubusercontent.com/1764005/105838242-ccfcef80-600a-11eb-8a26-b07c8c7932b4.png" alt="é¼ æ ‡å«"></p>
<p><a class="link"   href="https://github.com/blusewang/blog/files/5872975/psd.zip" >é¼ æ ‡å«.psd.zip<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>è®¾è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–°çš„å¼€å§‹</title>
    <url>/2017/06/11/new-start/</url>
    <content><![CDATA[<p>å‘Šåˆ«wordPressï¼ä¸æ˜ç™½è¿™è´§ä¸ºä»€ä¹ˆåªæ”¯æŒMySQLï¼pg4wpæ’ä»¶çš„æ”¯æŒèƒ½åŠ›ä¹Ÿæ˜¯å¼±ï¼</p>
]]></content>
  </entry>
  <entry>
    <title>ä¸ºä½•è¦æŠ›å¼ƒKafkaï¼Œé€‰æ‹©NSQï¼</title>
    <url>/2019/07/14/nsq-vs-kafka/</url>
    <content><![CDATA[<blockquote>
<p>è‡ªä»æŠ›PHPä»Goã€‚ä¸€ç›´ç›¸å®‰æ— äº‹ã€‚è¿‘æ¥é‡åˆ°å¤æ‚ä¸šåŠ¡æ—¶æ‰æƒ³èµ·æ—§çˆ±<code>Laravel Queue</code>ã€‚<br><br>æ›¿ä»£å“æœ‰ä¸¤ä¸ªï¼š<br><br>ä¸€ä¸ªæ˜¯åå£°å“å½»ä¸œè¥¿åŠçƒçš„æ—¶ä»£å® å„¿ï¼š<code>Kafka</code>ã€‚<br><br>å¦ä¸€ä¸ªæ˜¯ç©·å…‰è›‹æŸ¥ç†çš„é¦–é€‰ï¼š<code>NSQ</code>ã€‚</p>
</blockquote>
<h1 id="Letâ€™s-Rock"><a href="#Letâ€™s-Rock" class="headerlink" title="Letâ€™s Rock"></a>Letâ€™s Rock</h1><h2 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h2><h3 id="NSQ-è¿›ç¨‹æ¶æ„"><a href="#NSQ-è¿›ç¨‹æ¶æ„" class="headerlink" title="NSQ è¿›ç¨‹æ¶æ„"></a>NSQ è¿›ç¨‹æ¶æ„</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> +-----------------+        +---------------+</span><br><span class="line"> |                 |        |               |</span><br><span class="line"> |    nsqlookup    +&lt;-------+    nsqadmin   |</span><br><span class="line"> |                 |        |               |</span><br><span class="line"> +-------+---------+        +---------------+</span><br><span class="line">         |</span><br><span class="line">         |</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------+</span><br><span class="line">| +-------------+</span><br><span class="line">| | +--------------+</span><br><span class="line">| | |              |</span><br><span class="line">+---+     nsqd     |</span><br><span class="line">  +-+              |</span><br><span class="line">    +--------------+</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Kafka-è¿›ç¨‹æ¶æ„"><a href="#Kafka-è¿›ç¨‹æ¶æ„" class="headerlink" title="Kafka è¿›ç¨‹æ¶æ„"></a>Kafka è¿›ç¨‹æ¶æ„</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+----------------+</span><br><span class="line">|                |</span><br><span class="line">|    zookeeper   |</span><br><span class="line">|                |</span><br><span class="line">+--------+-------+</span><br><span class="line">         |</span><br><span class="line">         |</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------+</span><br><span class="line">| +-------------+</span><br><span class="line">| | +--------------+</span><br><span class="line">| | |              |</span><br><span class="line">+---+    kafka     |</span><br><span class="line">  +-+              |</span><br><span class="line">    +--------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="èµ„æºæ¶ˆè€—"><a href="#èµ„æºæ¶ˆè€—" class="headerlink" title="èµ„æºæ¶ˆè€—"></a>èµ„æºæ¶ˆè€—</h2><ul>
<li>ç¯å¢ƒï¼šFreeBSD12</li>
<li>æµ‹é‡å·¥å…·ï¼šhtop RES</li>
</ul>
<h3 id="NSQ"><a href="#NSQ" class="headerlink" title="NSQ"></a>NSQ</h3><table>
<thead>
<tr>
<th>è¿›ç¨‹</th>
<th>å¯åŠ¨æ—¶å ç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>nsqd</td>
<td>9.2MB</td>
</tr>
<tr>
<td>nsqlookup</td>
<td>8.5MB</td>
</tr>
</tbody></table>
<h3 id="Kafka"><a href="#Kafka" class="headerlink" title="Kafka"></a>Kafka</h3><table>
<thead>
<tr>
<th>è¿›ç¨‹</th>
<th>å¯åŠ¨æ—¶å ç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>kafka</td>
<td>299MB</td>
</tr>
<tr>
<td>zookeeper</td>
<td>58MB</td>
</tr>
</tbody></table>
<h2 id="è¿è¡Œä¸ç»´æŠ¤"><a href="#è¿è¡Œä¸ç»´æŠ¤" class="headerlink" title="è¿è¡Œä¸ç»´æŠ¤"></a>è¿è¡Œä¸ç»´æŠ¤</h2><table>
<thead>
<tr>
<th>\</th>
<th>NSQ</th>
<th>Kafka</th>
</tr>
</thead>
<tbody><tr>
<td>ä¾èµ–</td>
<td>æ— </td>
<td>LinuxåŸºç¡€åŒ…ã€bashã€jdkã€java</td>
</tr>
<tr>
<td>è€¦åˆ</td>
<td>æ— ï¼èƒ½ä»¥nsqdå•è¿›ç¨‹æä¾›å®Œæ•´æœåŠ¡ï¼Œåªåœ¨å¤šèŠ‚ç‚¹åˆ†å¸ƒå¼æ¨¡å¼ä¸‹éœ€è¦nsqlookup</td>
<td>ä¾èµ– zookeeper</td>
</tr>
<tr>
<td>æ—¥å¿—</td>
<td>æ ‡å‡†è¾“å‡ºï¼Œè‡ªè¡Œé‡å®šå‘</td>
<td>zookeeper 1ä»½æ—¥å¿—ï¼Œkafka 7ä»½æ—¥å¿—ï¼Œå…¶ä¸­ä¸¤ä»½æ—¥å¿—æŒ‰å°æ—¶è‡ªåŠ¨åˆ‡å‰²</td>
</tr>
<tr>
<td>é…ç½®</td>
<td>10é¡¹å·¦å³ï¼Œé»˜è®¤å³æ˜¯æœ€ä¼˜</td>
<td>10å¤šä¸ªç‹¬ç«‹é…ç½®æ–‡ä»¶ï¼Œæ•°ç™¾ä¸ªé…ç½®é¡¹</td>
</tr>
<tr>
<td>æ€§èƒ½ä¼˜åŒ–</td>
<td>é»˜è®¤å¼€å¯ pprofã€‚æ”¯æŒwebå¯è§†åŒ–å®æ—¶è§‚æµ‹å†…å­˜ã€åç¨‹ç­‰åŠ¨æ€</td>
<td>æ— </td>
</tr>
<tr>
<td>å¼‚å¸¸æ’æŸ¥</td>
<td>é”™è¯¯æ—¥å¿—ä¸­çš„æ ˆï¼Œæºç é‡å°ã€‚ä¸ä¾èµ–ç½‘ç»œé—®ç­”ä¹Ÿèƒ½åœ¨çŸ­æ—¶é—´å†…æ‰¾å‡ºé—®é¢˜</td>
<td>é”™è¯¯æ—¥å¿—ä¸­çš„æ ˆï¼Œæ·±åº¦çš„æ ˆï¼Œå·¨é‡æºç ï¼Œæ’æŸ¥éœ€è¦æ·±å…¥äº†è§£å…¶åŸç†ï¼Œå¤§é‡é˜…è¯»æºç ã€‚å¦åˆ™åªèƒ½é€šè¿‡äº’è”ç½‘ã€æŸ¥é˜…å‰äººç»éªŒæˆ–å¤§å¸ˆçº§äººè„‰ã€‚</td>
</tr>
</tbody></table>
<h2 id="ä¸šåŠ¡èƒ½åŠ›"><a href="#ä¸šåŠ¡èƒ½åŠ›" class="headerlink" title="ä¸šåŠ¡èƒ½åŠ›"></a>ä¸šåŠ¡èƒ½åŠ›</h2><table>
<thead>
<tr>
<th>\</th>
<th>NSQ</th>
<th>Kafka</th>
</tr>
</thead>
<tbody><tr>
<td>æ•°æ®å®‰å…¨</td>
<td>å•ä¸ªnsqdå®ä¾‹å†…çš„æ•°æ®ï¼Œä¸æ”¯å¼‚åœ°çƒ­å¤‡ï¼Œå®ä¾‹åœ¨æ­£å¸¸é€€å‡ºæ—¶ï¼Œä¼šåšåˆ·å…¥ç£ç›˜æ“ä½œï¼Œä¹Ÿæœ‰æ‰‹åŠ¨å¤‡ä»½å®ä¾‹æ•°æ®çš„å·¥å…·ã€‚</td>
<td>æ•°æ®å…¨åœ¨ç£ç›˜ã€‚å¤šä¸ªèŠ‚ç‚¹é—´è‡ªåŠ¨äº’ä¸ºå¤‡ä»½ã€‚</td>
</tr>
<tr>
<td>æ¶ˆæ¯é¡ºåº</td>
<td>ä¸ä¿è¯æœ‰åº</td>
<td>æ”¯æŒæœ‰æ¡ä»¶çš„æœ‰åº</td>
</tr>
<tr>
<td>æ¶ˆæ¯æŠ•é€’</td>
<td>è‡³å°‘ä¸€æ¬¡ï¼Œæ¶ˆè´¹è€…éœ€è‡ªè¡Œä¿æŒæ¶ˆæ¯å¤„ç†çš„å¹‚ç­‰</td>
<td>æ”¯æŒå‡†ç¡®çš„ä¸€æ¬¡</td>
</tr>
</tbody></table>
<ul>
<li>é™„åŠ èƒ½åŠ›</li>
</ul>
<table>
<thead>
<tr>
<th>\</th>
<th>NSQ</th>
<th>Kafka</th>
</tr>
</thead>
<tbody><tr>
<td>ç•Œé¢åŒ–ç®¡ç†</td>
<td>è‡ªå¸¦nsqadmin</td>
<td>æ— ï¼Œéœ€é¢å¤–å®‰è£…ç¬¬ä¸‰æ–¹åŒ…</td>
</tr>
<tr>
<td>åŸºäºhttpåè®®çš„pub</td>
<td>nsqdè‡ªå¸¦</td>
<td>æ— ï¼Œéœ€é¢å¤–å®‰è£…ç¬¬ä¸‰æ–¹åŒ…</td>
</tr>
</tbody></table>
<hr>
<h2 id="ä¸€ä¸ªGoerè§†è§’çš„ä½“éªŒ"><a href="#ä¸€ä¸ªGoerè§†è§’çš„ä½“éªŒ" class="headerlink" title="ä¸€ä¸ªGoerè§†è§’çš„ä½“éªŒ"></a>ä¸€ä¸ªGoerè§†è§’çš„ä½“éªŒ</h2><p>kafka çš„golang client å®˜æ–¹é¦–æ¨ saramaã€‚ä¸€æŸ¥å°±å‡ºç³™ç‚¹ï¼š<a class="link"   href="https://blog.wolfogre.com/posts/golang-consume-kafka/" >golang æ¶ˆè´¹ kafka çš„å‘<i class="fas fa-external-link-alt"></i></a><br>è¿™äº›åº“çš„ç‰ˆæœ¬ï¼Œ1.0éƒ½ä¸åˆ°ã€‚</p>
<p>è€Œ<a class="link"   href="https://github.com/nsqio/go-nsq" >go-nsq<i class="fas fa-external-link-alt"></i></a>æˆªè‡³å½“å‰å·²ç»å†16æ¬¡releaseè‡³v1.0.7ã€‚é€‚ç”¨åº¦ï¼Œäº²æµ‹ä¸ºä¸Šå¥½ï¼</p>
<h3 id="NATSé˜Ÿåˆ—"><a href="#NATSé˜Ÿåˆ—" class="headerlink" title="NATSé˜Ÿåˆ—"></a>NATSé˜Ÿåˆ—</h3><p>by the way é¡ºä¾¿æä¸€ä¸‹NATSé˜Ÿåˆ—ï¼Œä¹Ÿå¾ˆæœ‰åã€‚å®ƒçš„æ¶ˆæ¯æŠ•é€’æ—¢æ”¯æŒè‡³å°‘ä¸€æ¬¡ï¼Œä¹Ÿæ”¯æŒæœ€å¤šä¸€æ¬¡ï¼Œä¹Ÿæ— æ³•å‡†ç¡®çš„ä¸€æ¬¡ã€‚</p>
<h3 id="ä½•æ—¶è¯¥é€‰æ‹©Kafka"><a href="#ä½•æ—¶è¯¥é€‰æ‹©Kafka" class="headerlink" title="ä½•æ—¶è¯¥é€‰æ‹©Kafka"></a>ä½•æ—¶è¯¥é€‰æ‹©Kafka</h3><p>Kafkaéš¶å±äºApacheåŸºé‡‘ä¼šã€‚æ˜¯Apacheâ€œå…¨å®¶æ¡¶â€çš„ä¸€å‘˜ã€‚</p>
<p>Apacheå®¶æ—æ‹¥æœ‰é™¤äº†é˜Ÿåˆ—ä¹‹å¤–ï¼Œåœ¨å¯é è®¡ç®—å’Œå¤§æ•°æ®æ–¹é¢æœ‰ç€å¯é ã€å¼€æ”¾çš„æ•´ä½“è§£å†³æ–¹æ¡ˆã€‚å°±åƒARMçš„å…¬ç‰ˆã€‚</p>
<p>Javaå¼€å‘è€…æ˜¯ä¸ªéå¸ƒå…¨çƒçš„åºå¤§å·¥äººç¾¤ä½“ã€‚</p>
<p>å› æ­¤ï¼Œé€‰æ‹©Apacheä¸‹çš„äº§å“å…·æœ‰å·¥ä¸šåŒ–ç‰¹å¾ï¼Œæ˜¯ä¸€ä¸ªåªè¦<strong>è‚¯èŠ±é’±</strong>ï¼Œå°±ä¸€å®šèƒ½å®ç°çš„é«˜åº¦å¯å¤åˆ¶çš„ç”Ÿäº§æœºå™¨ã€‚</p>
<h3 id="èº«ä¸ºGoer-è‡ªè±ªåœ°é‡‡ç”¨NSQï¼"><a href="#èº«ä¸ºGoer-è‡ªè±ªåœ°é‡‡ç”¨NSQï¼" class="headerlink" title="èº«ä¸ºGoer è‡ªè±ªåœ°é‡‡ç”¨NSQï¼"></a>èº«ä¸ºGoer <strong>è‡ªè±ªåœ°é‡‡ç”¨<code>NSQ</code>ï¼</strong></h3><ul>
<li>åœ¨äº‘æœåŠ¡æˆç†Ÿçš„ä»Šå¤©ï¼Œä¸»æœºæ„å¤–æ–­ç”µï¼Œä¸”æ–­ç”µåç¡¬ç›˜ä¹Ÿæ„å¤–æ¶ˆå¤±çš„å¯èƒ½å‡ ä¹ä¸º0ã€‚å†åŠ ä¸Šé˜¿é‡Œäº‘çš„å®šæ—¶è‡ªåŠ¨å¿«ç…§ã€‚å€˜è‹¥æ˜¯é‡‘èã€ä¿é™©ç±»çš„ä¸šåŠ¡ï¼Œè¿˜å¯ä»¥é€šè¿‡å…¶å®ƒæ‰‹æ®µï¼Œå¦‚ï¼šæ–‡ä»¶åŒæ­¥å¤‡ä»½çš„æ–¹å¼åšçƒ­å¤‡ã€‚</li>
<li>æˆæœ¬ã€‚ä¸è®ºæ˜¯è¿ç»´æˆæœ¬ï¼Œè¿˜æ˜¯ç¡¬ä»¶æˆæœ¬ï¼ŒNSQéƒ½åŠæ‰“Kafkaï¼ç›¸æ¯”ä¹‹ä¸‹ä¿æŒå¹‚ç­‰çš„æˆæœ¬ï¼Œå°±ä¸æ˜¯äº‹å„¿äº†ã€‚</li>
</ul>
]]></content>
      <tags>
        <tag>Kafka</tag>
        <tag>NSQ</tag>
      </tags>
  </entry>
  <entry>
    <title>NSQçš„éƒ¨ç½²</title>
    <url>/2019/07/15/nsq-deploy/</url>
    <content><![CDATA[<h2 id="åŸæ–™"><a href="#åŸæ–™" class="headerlink" title="åŸæ–™"></a>åŸæ–™</h2><ul>
<li>ç³»ç»Ÿï¼šFreeBSD 12</li>
</ul>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pkg install nsq</span><br></pre></td></tr></table></figure>
<h3 id="ç¼–å†™é…ç½®æ–‡ä»¶"><a href="#ç¼–å†™é…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–å†™é…ç½®æ–‡ä»¶"></a>ç¼–å†™é…ç½®æ–‡ä»¶</h3><ul>
<li>NSQ é…ç½®æ–‡ä»¶æ ·ä¾‹ï¼š<a class="link"   href="https://github.com/nsqio/nsq/tree/master/contrib" >https://github.com/nsqio/nsq/tree/master/contrib<i class="fas fa-external-link-alt"></i></a></li>
<li>éƒ¨ç½²åœ¨<code>/usr/local/etc/</code>ä¸‹<ul>
<li>nsqd.conf</li>
<li>nsqlookup.conf</li>
<li>nsqadmin.conf</li>
</ul>
</li>
</ul>
<h3 id="åº”ç”¨é…ç½®æ–‡ä»¶"><a href="#åº”ç”¨é…ç½®æ–‡ä»¶" class="headerlink" title="åº”ç”¨é…ç½®æ–‡ä»¶"></a>åº”ç”¨é…ç½®æ–‡ä»¶</h3><p>åœ¨<code>/usr/local/etc/rc.d/</code>ä¸‹æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡ç®¡ç†è„šæœ¬ã€‚</p>
<p>ä¼šçœ‹åˆ°ä¸‹é¢çš„å¤´éƒ¨ï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># $FreeBSD: branches/2019Q2/net/nsq/files/nsqd.in 454856 2017-11-24 23:17:50Z dbaio $</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># PROVIDE: nsqd</span></span><br><span class="line"><span class="comment"># REQUIRE: LOGIN</span></span><br><span class="line"><span class="comment"># KEYWORD: shutdown</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add the following lines to /etc/rc.conf to enable nsqd:</span></span><br><span class="line"><span class="comment"># nsqd_enable=&quot;YES&quot;</span></span><br><span class="line"><span class="comment"># nsqd_args=&quot;&lt;set as needed&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤å°†</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># nsqd_enable=&quot;YES&quot;</span></span><br><span class="line"><span class="comment"># nsqd_args=&quot;&lt;set as needed&gt;&quot;</span></span><br></pre></td></tr></table></figure>
<p>æ”¹ä¸ºï¼š</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">nsqd_enable=<span class="string">&quot;YES&quot;</span></span><br><span class="line">nsqd_args=<span class="string">&quot;--config=/usr/local/etc/nsqd.conf&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p><code>service nsqd start</code></p>
]]></content>
      <tags>
        <tag>NSQ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¼–è¯‘OpenWRT</title>
    <url>/2020/03/10/openwrt-compile/</url>
    <content><![CDATA[<p>ä¹‹å‰ç¼–è¯‘OpenWRTæ—¶æœ‰å¾ˆå¤šé¡¾è™‘ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>å¤ªå¤šä¾èµ–ï¼Œæ‹…å¿ƒæŠŠè‡ªå·±MacOSè£…å¤ªå¤šä¸æ˜ç”¨å¤„çš„åŒ…ã€‚å°†æ¥æ— æ³•æ¸…ç†</li>
<li>æ‹…å¿ƒæä¸æ‡‚ç¼–è¯‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é™Œç”Ÿæ¦‚å¿µã€‚æ¯”å¦‚ï¼šå‡ºä¸€ä¸ªé—®é¢˜ï¼Œgoogleä¸€ä¸‹ï¼Œå¾—åˆ°äº†10ä¸ªé—®é¢˜ï¼</li>
<li>ä¸çŸ¥é“ç¼–è¯‘ç»“æœæ˜¯ä»€ä¹ˆã€‚å¦‚ä½•æŠŠç¼–è¯‘ç»“æœå˜æˆæŒ‡å®šçš„ç³»ç»Ÿé•œåƒã€‚ä¸ç›¸ä¿¡<code>make</code>èƒ½ç›´æ¥å‡ºé•œåƒã€‚</li>
</ul>
<p>äº‹å®ä¸Šï¼ŒOpenWRT å›¢é˜Ÿæ˜¯ç¾¤éå¸¸å®åœ¨çš„äººï¼åªéœ€è¦ä¸€æ¬¡<code>make</code>å¤šç‰ˆæœ¬çš„IMGé•œåƒå’Œé€‰ä¸­çš„è½¯ä»¶åŒ…ã€‚å…¨ç¼–è¯‘å‡ºæ¥å¹¶æ‰“å¥½åŒ…ï¼Œè¿˜æ•´ç†å¾—éå¸¸æ•´é½ï¼</p>
<p><a class="link"   href="https://openwrt.org/zh-cn/doc/howto/build" >å®˜æ–¹çš„ä¸­æ–‡ç¼–è¯‘è¯´æ˜<i class="fas fa-external-link-alt"></i></a>è¿™é‡Œå±•ç¤ºäº†å‡†å¤‡å¥½åçš„ç¼–è¯‘è¿‡ç¨‹ã€‚ç”±æ­¤æ–‡å¯è§ï¼Œç¡®å®ä¸éš¾ï¼å½“ç„¶ï¼Œä»…å‡­æ­¤ä¸€æ–‡ï¼Œä¸è¶³ä»¥æŒ‡å¯¼å®Œæˆç¼–è¯‘ï¼</p>
<p>ä¸‹è¾¹è®°å½•ä¸€ä¸‹æˆ‘çš„ç¼–è¯‘ç»å†ã€‚</p>
<h1 id="è§„åˆ’"><a href="#è§„åˆ’" class="headerlink" title="è§„åˆ’"></a>è§„åˆ’</h1><p>é€‰æ‹©åœ¨è™šæ‹Ÿæœºé‡Œç¼–è¯‘ã€‚å…å¾—æ±¡æŸ“OSã€‚</p>
<ul>
<li>è™šæ‹Ÿæœºé€‰æ‹©VirtualBoxï¼›å› ä¸ºå…è´¹ç¨³å¥ã€‚</li>
<li>ç¼–è¯‘OSï¼Œé€‰æ‹©Alpine Linuxï¼›å› ä¸ºå®ƒå°ä¸”ä¾¿äºå®‰è£…ã€‚<ul>
<li>OpenWRTç¼–è¯‘æ”¯æŒå‡ ä¹æ‰€æœ‰å¸¸è§Linuxå‘è¡Œç‰ˆå’ŒMacOSã€‚FreeBSDå®˜æ–¹æ–‡æ¡£ç«‹äº†é¡¹ï¼Œä½†æ²¡æœ‰å†™ï¼Œå°±æ­¤ç•¥è¿‡ã€‚Windowsæ²¡æœ‰çœ‹åˆ°ç›¸å…³æ–‡æ¡£ã€‚</li>
</ul>
</li>
</ul>
<h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul>
<li>è™šæ‹Ÿæœºå°½é‡å¤šç»™å‡ ä¸ªCPUæ ¸å¿ƒï¼Œå› ä¸ºOpenWRTé¡¹ç›®ç›¸å½“å¤§ï¼æ›´å¤šçš„æ ¸å¿ƒèƒ½å‹ç¼©ç¼–è¯‘æ—¶é—´ã€‚</li>
<li>è™šæ‹Ÿæœºç¡¬ç›˜ç»™15GBä»¥ä¸Šï¼Œæœ€å¥½20GBä»¥ä¸Šã€‚</li>
<li>ç»™è£…å¥½çš„OSå»ºç«‹ä¸€ä¸ªæ–°ç”¨æˆ·ã€‚OpenWRTå®˜æ–¹ä¸æ¨èåœ¨<code>root</code>è´¦å·ä¸‹ç¼–è¯‘ã€‚</li>
<li>æºç ä¸­ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ï¼Œå¤šæ•°åœ¨æµ·å¤–ã€‚ä¸€æ¶èˆ’é€‚çš„å°é£æœºï¼Œæ˜¯ç†æƒ³çš„é€‰æ‹©ï¼›ç”šè‡³æ˜¯å¿…é¡»ï¼</li>
</ul>
<h2 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h2><p>ä»¥ä¸‹è¦æ±‚ï¼Œä¸åœ¨æœ¬æ–‡æ¢è®¨èŒƒå›´ã€‚</p>
<ul>
<li>è¦ä¼šç”¨VirtualBoxã€‚</li>
<li>è¦ä¼šå®‰è£…Alpine Linuxã€‚</li>
<li>è¦ä¼šç”¨gitã€‚ç†è§£åˆ†æ”¯å’Œæ ‡ç­¾çš„æ¦‚å¿µå’Œç”¨æ³•ã€‚</li>
<li>è‡ªå¤‡å°é£æœºã€‚</li>
</ul>
<h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul>
<li>è™šæ‹Ÿæœºç¯å¢ƒå‡†å¤‡å‚è€ƒï¼š<a class="link"   href="https://openwrt.org/docs/guide-developer/build-system/install-buildsystem" >Build system â€“ Installation<i class="fas fa-external-link-alt"></i></a></li>
<li>ç¼–è¯‘è¿‡ç¨‹åŠé€‰é¡¹å‚è€ƒï¼š<a class="link"   href="https://openwrt.org/docs/guide-developer/build-system/use-buildsystem" >Build system â€“ Usage<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<h1 id="é‡ç‚¹æç¤ºï¼š"><a href="#é‡ç‚¹æç¤ºï¼š" class="headerlink" title="é‡ç‚¹æç¤ºï¼š"></a>é‡ç‚¹æç¤ºï¼š</h1><ul>
<li>ç¯å¢ƒå‡†å¤‡ï¼Œåœ¨è£…å®ŒOSåï¼Œå…¶å®å¾ˆç®€å•ã€‚åªè¦åœ¨<a class="link"   href="https://openwrt.org/docs/guide-developer/build-system/install-buildsystem" >Build system â€“ Installation<i class="fas fa-external-link-alt"></i></a>æ–‡ç« ä¸­å¤åˆ¶ä¸€ä¸‹å¯¹åº”çš„å®‰è£…æŒ‡ä»¤ï¼Œæ‰§è¡Œä¸€ä¸‹ï¼›å†æ‰¾ä¸ªåœ°æ–¹cloneå‡ºæºç å³å¯ã€‚</li>
<li><code>git tag</code>æŸ¥æ‰¾éœ€è¦çš„ç‰ˆæœ¬ã€‚<code>git checkout</code>éœ€è¦çš„ç‰ˆæœ¬ã€‚</li>
<li><code>./scripts/feeds</code> feeds æŒ‡ä»¤æ˜¯ç®¡ç†Apkï¼ˆOpenWRTä¸Šçš„å®‰è£…åŒ…ï¼‰çš„ã€‚å°±åƒMacOSä¸Šçš„<code>brew</code>ã€‚åœ¨<code>menuconfig</code>ä¹‹å‰å€¼å¾—æ›´æ–°ä¸€ä¸‹ï¼Œ<code>./scripts/feeds update -a</code>ã€‚</li>
<li>è‡ªå·±çš„å®‰è£…åŒ…å°†æ¥ä¹Ÿæ˜¯åœ¨è¿™é‡Œåˆ›å»ºå’Œç®¡ç†ã€ç¼–è¯‘ã€‚</li>
<li><code>make menuconfig</code> æœ‰UIç•Œé¢ï¼Œå¯åœ¨UIç•Œé¢ä¸Šé€‰æ‹©è¦ç¼–è¯‘çš„é•œåƒçš„ç›®æ ‡è®¾å¤‡ã€‚å¦‚ï¼šé€‰æ‹©<code>brcm2708</code>æ˜¯<code>Raspberry Pi</code>ç±»å‹çš„èŠ¯ç‰‡ï¼Œå­ç±»å‹å¯¹åº”<code>Raspberry Pi</code>çš„ä¸åŒModelç‰ˆæœ¬ï¼Œå¦‚ï¼š<code>bcm2710</code>æ˜¯<code>Raspberry Pi 3</code>çš„èŠ¯ç‰‡å‹å·ã€‚</li>
<li><code>make defconfig</code> è®¾ç½®é»˜è®¤é¡¹</li>
<li><code>make kernel_menuconfig</code> æœ›æ–‡ç”Ÿä¹‰ï¼Œå†…æ ¸é…ç½®ï¼Œä¸€èˆ¬ä¸éœ€è¦ã€‚</li>
<li><code>make download</code> ä¸‹è½½æºç ç¼–è¯‘è¿‡ç¨‹ä¸­ä¾èµ–çš„å·¥å…·ã€‚</li>
<li>åœ¨<code>make download</code>å‰ï¼Œé…ç½®ä¸€ä¸‹<code>wget</code>çš„<code>http_proxy``https_proxy``ftp_proxy</code>ï¼Œå¹¶å¯ç”¨<code>proxy</code>ã€‚<code>wget</code>é…ç½®æ–‡ä»¶åœ¨ï¼š<code>/etc/wgetrc</code></li>
<li><code>make</code> </li>
<li>å‚æ•°<code>-j3</code>ï¼Œå°±æ˜¯3ä¸ªçº¿ç¨‹å¹¶å‘ç¼–è¯‘ï¼Œè¿™ä¸ªæ•°å­—å–å†³äºCPUã€‚</li>
<li>å‚æ•°<code>V=s</code>ï¼Œæ˜¯æ˜¾ç¤ºè¯¦ç»†ã€‚</li>
<li>å‚æ•°<code>package/cups/compile</code>ï¼Œæ˜¯ç¼–è¯‘å•ä¸ªåº”ç”¨ã€‚</li>
</ul>
<h1 id="æˆ‘çš„ç¼–è¯‘æˆæœ"><a href="#æˆ‘çš„ç¼–è¯‘æˆæœ" class="headerlink" title="æˆ‘çš„ç¼–è¯‘æˆæœ"></a>æˆ‘çš„ç¼–è¯‘æˆæœ</h1><h2 id="å›ºä»¶ç‰¹ç‚¹"><a href="#å›ºä»¶ç‰¹ç‚¹" class="headerlink" title="å›ºä»¶ç‰¹ç‚¹"></a>å›ºä»¶ç‰¹ç‚¹</h2><ul>
<li>å›ºä»¶å‹å·ï¼š    <strong>Raspberry Pi 4 Model B Rev 1.2</strong></li>
<li>1GB æ ¹ç©ºé—´ã€‚</li>
<li>é•œåƒå†…ç½®äº†USBè½¬rj45é©±åŠ¨</li>
<li>é»˜è®¤æ”¯æŒ<code>bbr</code>ã€<code>tcpdump</code></li>
<li>æ”¯æŒ<code>v2ray</code>ï¼Œåœ¨é…ç½®å¥½æºåï¼Œ<code>opkg update &amp;&amp; opkg install v2ray</code>å°±èƒ½å¾—åˆ°ã€‚</li>
<li>å¹¿å‘Šè¿‡æ»¤</li>
<li>åˆ†æµ</li>
<li>å±è”½å¤§å‚éƒ¨åˆ†äº§å“çš„æ—¥å¿—æ”¶é›†</li>
<li>å‡ºå£é…ç½®æ ·ä¾‹</li>
<li>ç¼–è¯‘äº†packageä¸­éƒ¨åˆ†æˆ‘è®¤ä¸ºå¸¸ç”¨çš„åŒ…ï¼Œå¦‚ï¼š<code>luci-app-statistics</code>ã€<code>6to4</code>ã€<code>htop</code>ã€<code>curl</code>ã€<code>fdisk</code>ã€<code>cfdisk</code>ã€<code>ffmpeg</code>ã€<code>luci-app-samba</code>ç­‰ã€‚</li>
</ul>
<h2 id="å›ºä»¶æº"><a href="#å›ºä»¶æº" class="headerlink" title="å›ºä»¶æº"></a>å›ºä»¶æº</h2><p>å›ºä»¶ä¸‹è½½ã€å‡çº§ï¼š<a class="link"   href="http://openwrt.wangjunfeng.com.cn/targets/bcm27xx/bcm2711/" >http://openwrt.wangjunfeng.com.cn/targets/bcm27xx/bcm2711/<i class="fas fa-external-link-alt"></i></a></p>
<p><code>/etc/opkg/distfeeds.conf</code> æºé…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">src&#x2F;gz jf_core http:&#x2F;&#x2F;openwrt.wangjunfeng.com.cn&#x2F;targets&#x2F;bcm27xx&#x2F;bcm2711&#x2F;packages</span><br><span class="line">src&#x2F;gz jf_base http:&#x2F;&#x2F;openwrt.wangjunfeng.com.cn&#x2F;packages&#x2F;aarch64_cortex-a72&#x2F;base</span><br><span class="line">src&#x2F;gz jf_luci http:&#x2F;&#x2F;openwrt.wangjunfeng.com.cn&#x2F;packages&#x2F;aarch64_cortex-a72&#x2F;luci</span><br><span class="line">src&#x2F;gz jf_packages http:&#x2F;&#x2F;openwrt.wangjunfeng.com.cn&#x2F;packages&#x2F;aarch64_cortex-a72&#x2F;packages</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>openWRT</tag>
        <tag>ç¼–è¯‘</tag>
      </tags>
  </entry>
  <entry>
    <title>OpenWRTå®ç°å†…ç½‘tcpè¿æ¥è¯·æ±‚æ•´å½¢ æ­å»ºé€¼çœŸå¼€å‘ç¯å¢ƒ</title>
    <url>/2020/08/04/openwrt-ipv6-firewall-forward/</url>
    <content><![CDATA[<h1 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h1><h2 id="å¤´ç–¼çš„é…ç½®"><a href="#å¤´ç–¼çš„é…ç½®" class="headerlink" title="å¤´ç–¼çš„é…ç½®"></a>å¤´ç–¼çš„é…ç½®</h2><p>å¼€å‘è€…æœ¬åœ°å¼€å‘ä¸€æ¬¾ç½‘ç»œåº”ç”¨æ—¶ï¼Œä¸€èˆ¬æ˜¯åœ¨æµ‹è¯•æ—¶ï¼Œä½¿ç”¨æµ‹è¯•åŸŸå/IPã€‚å‘å¸ƒæ—¶ä½¿ç”¨æ­£å¼åŸŸå/IPã€‚</p>
<p>çœ‹ä¼¼ç®€å•çš„å°æ“ä½œã€‚ä½†åœ¨å¤šè½®è¿­ä»£æ—¶ï¼Œè¿™ä¸ªå°æ“ä½œä¸€ä½†å‡ºé”™ï¼Œä¼šå‡ºå¤§é—®é¢˜ã€‚</p>
<p>å¦‚æœå¼€å‘ç¯å¢ƒé…ç½®ä¸ç”Ÿäº§ç¯å¢ƒå®Œå…¨ä¸€æ ·ï¼Œé‚£å°±çœäº‹è®¸å¤šã€‚</p>
<p>åœ¨æœ‰è‡ªå·±å¯æ§çš„å†…ç½‘è·¯ç”±æƒ…å†µä¸‹ï¼Œå®ç°èµ·æ¥ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼šDNSåŠ«æŒã€IPåŠ«æŒã€‚</p>
<h2 id="DNSåŠ«æŒ"><a href="#DNSåŠ«æŒ" class="headerlink" title="DNSåŠ«æŒ"></a>DNSåŠ«æŒ</h2><p>åªéœ€åœ¨ç™»å…¥OpenWRTåï¼ŒæŠŠåŸŸåæ–°çš„è§£æå†™å…¥ <code>/etc/hosts</code> ã€‚å† <code>/etc/init.d/dnsmasq reload</code> é‡è½½ä¸€ä¸‹<code>dnsmasq</code>å°±å¥½äº†ã€‚ç®€å•å¥½ç”¨ï¼</p>
<h2 id="IPåŠ«æŒ"><a href="#IPåŠ«æŒ" class="headerlink" title="IPåŠ«æŒ"></a>IPåŠ«æŒ</h2><p>è¿™ä¸ªç›¸å¯¹å¤æ‚ä¸€äº›ã€‚å› ä¸ºåœ¨OpenWRTçš„ <code>ç½‘ç»œ - é˜²ç«å¢™ - NAT è§„åˆ™</code> åªæ”¯æŒé‡å†™æºåœ°å€ï¼Œä¸æ”¯æŒé‡å†™ç›®æ ‡åœ°å€ã€‚</p>
<p>è¿™å°±å¾—æ‰‹åŠ¨å†™<code>ç½‘ç»œ - é˜²ç«å¢™ - è‡ªå®šä¹‰è§„åˆ™</code>äº†ï¼</p>
<h3 id="IPv4åŠ«æŒ"><a href="#IPv4åŠ«æŒ" class="headerlink" title="IPv4åŠ«æŒ"></a>IPv4åŠ«æŒ</h3><p>IPv4çš„è§„åˆ™ç›´æ¥å†™å°±å¯ä»¥ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">iptables -t nat -A PREROUTING -i br-lan -d 1.2.3.4 -p tcp -m tcp --dport 443 -m comment --comment &quot;dev&quot; -j DNAT --to-destination 192.168.1.2:443</span><br></pre></td></tr></table></figure>
<h3 id="IPv6åŠ«æŒ"><a href="#IPv6åŠ«æŒ" class="headerlink" title="IPv6åŠ«æŒ"></a>IPv6åŠ«æŒ</h3><p>IPv6å°±éº»çƒ¦äº›äº†ã€‚å› ä¸ºIPv6è®¾è®¡ç›®æ ‡å°±æ˜¯å¼ƒç”¨<code>NAT</code>ï¼ˆå› ä¸ºæœ‰å‡ ä¹æ— ç©·çš„åœ°å€èµ„æºï¼‰ã€‚<br>è™½ç„¶æŒ‰æ ‡å‡†åº”è¯¥ä¸ç”¨ï¼Œä½†ä¾æ—§æœ‰<code>çƒ­å¿ƒäºº</code>å¯¹å®ƒè¿›è¡Œäº†å®ç°ã€‚</p>
<p>åœ¨<code>ç³»ç»Ÿ - è½¯ä»¶åŒ…</code>é‡Œæœç´¢å¹¶å®‰è£…ï¼š<code>kmod-ipt-nat</code> <code>ip6tables-mod-nat</code>ã€‚è¿™å°±å…·å¤‡äº†å¯¹IPv6è¿›è¡Œ<code>NAT</code>çš„èƒ½åŠ›äº†ï¼</p>
<p>ä½†ä¸èƒ½ç›´æ¥å†™è§„åˆ™ï¼›éœ€å…ˆå¼€å¯å‘ä½å†…ç½‘çš„v6çš„ä¼ªè£…ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">ip6tables -t nat -I POSTROUTING -o br-lan -j MASQUERADE</span><br></pre></td></tr></table></figure>
<p>å†ç»™ä»å†…ç½‘å‘å‡ºçš„åŒ…å†™å…·ä½“è§„åˆ™ï¼›ä¾‹å¦‚ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">ip6tables -t nat -A PREROUTING -i br-lan -d 2408:4002:xx::xx -p tcp -m tcp --dport 443 -m comment --comment &quot;dev&quot; -j DNAT --to-destination [2408:8207:xx:xx::2]:443</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ipv6</tag>
        <tag>ip6tables</tag>
        <tag>OpenWRT</tag>
      </tags>
  </entry>
  <entry>
    <title>RaspberryPIä¸Šå®‰è£…OpenWRT</title>
    <url>/2019/12/04/openwrt-on-raspberry-pi/</url>
    <content><![CDATA[<h1 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h1><p>å®¶ç”¨ç½‘ç»œæ‹“æ‰‘è®¾è®¡</p>
<pre class="mermaid">graph LR
lt((è”é€šå®½å¸¦))
subgraph Raspberry PI
openwrt(OpenWRT)
end
tp(TP-Link)
mac(Laptop)
phone(Phone)
subgraph Raspberry PI 2
osmc(OSMC Dodi)
end
tv(TV)
disk[(USB ç¡¬ç›˜)]

lt ---|å…‰çŒ«æ¡¥æ¥| openwrt
openwrt ---|USBè½¬ç½‘çº¿| tp
openwrt --- disk
tp -. wifi .- mac
tp -. wifi .- phone
tp ---|ç½‘çº¿| osmc
osmc ---|HDMI| tv 
openwrt -. wifi .- mac
openwrt -. wifi .- phone</pre>

<p>è·¯ç”±å™¨è¿æ¥RPIç”±ç½‘çº¿æ¥å£ã€‚RPIè¿æ¥ç”µè§†ç”±HDMIæ¥å£ã€‚</p>
<h1 id="é…ä»¶å‡†å¤‡"><a href="#é…ä»¶å‡†å¤‡" class="headerlink" title="é…ä»¶å‡†å¤‡"></a>é…ä»¶å‡†å¤‡</h1><p>å”¯ç‹¬RPIè¿æ¥è·¯ç”±å™¨ã€‚é¢å¤–éœ€è¦ä¸€ä¸ª USBè½¬ç½‘å£ã€‚<br>æ·˜å®ä¹‹ï¼š<br><img src="https://gd4.alicdn.com/imgextra/i4/4282361926/O1CN0184Ycaa1Q69NjPfQVD_!!4282361926.png_400x400.jpg" alt="image"><br><a class="link"   href="https://item.taobao.com/item.htm?spm=a1z09.2.0.0.2b562e8d64yuA7&id=597724398426&_u=416uj6v1a71" >æ ‘è“æ´¾USB2.0 HUB ç½‘å¡åŠ hub åˆ†çº¿å™¨è½¬RJ45å¤–ç½®æœ‰çº¿ç½‘å¡ USBç½‘å£<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="åˆ·OS"><a href="#åˆ·OS" class="headerlink" title="åˆ·OS"></a>åˆ·OS</h1><p>OpenWRT å®˜æ–¹æä¾›äº†è¯¦ç»†çš„è§£è¯´ã€‚<br><a class="link"   href="https://openwrt.org/toh/raspberry_pi_foundation/raspberry_pi" >OpenWrt Project: Raspberry Pi<i class="fas fa-external-link-alt"></i></a></p>
<h1 id="è®¾ç½®"><a href="#è®¾ç½®" class="headerlink" title="è®¾ç½®"></a>è®¾ç½®</h1><p>å¯åŠ¨åã€‚é€šè¿‡webè¿æ¥è‡³OpenWRTã€‚</p>
<h2 id="è®¾ç½®USTCæº"><a href="#è®¾ç½®USTCæº" class="headerlink" title="è®¾ç½®USTCæº"></a>è®¾ç½®USTCæº</h2><p>åœ¨ã€ç³»ç»Ÿã€‘-ã€è½¯ä»¶åŒ…ã€‘-ã€é…ç½®ã€‘å°†è½¯ä»¶æºå…¨æ›¿æ¢ä¸ºUSTCæºã€‚</p>
<ul>
<li><p><a class="link"   href="https://mirrors.ustc.edu.cn/help/lede.html" >USTCé…ç½®å¸®åŠ©<i class="fas fa-external-link-alt"></i></a><br>é…ç½®æ•ˆæœï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">src/gz openwrt_core http://mirrors.ustc.edu.cn/lede/releases/18.06.5/targets/arm_arm1176jzf-s_vfp/packages</span><br><span class="line">src/gz openwrt_base http://mirrors.ustc.edu.cn/lede/releases/18.06.5/packages/arm_arm1176jzf-s_vfp/base</span><br><span class="line">src/gz openwrt_luci http://mirrors.ustc.edu.cn/lede/releases/18.06.5/packages/arm_arm1176jzf-s_vfp/luci</span><br><span class="line">src/gz openwrt_packages http://mirrors.ustc.edu.cn/lede/releases/18.06.5/packages/arm_arm1176jzf-s_vfp/packages</span><br><span class="line">src/gz openwrt_routing http://mirrors.ustc.edu.cn/lede/releases/18.06.5/packages/arm_arm1176jzf-s_vfp/routing</span><br><span class="line">src/gz openwrt_telephony http://mirrors.ustc.edu.cn/lede/releases/18.06.5/packages/arm_arm1176jzf-s_vfp/telephony</span><br></pre></td></tr></table></figure>
<h2 id="å®‰è£…éœ€è¦çš„åŒ…"><a href="#å®‰è£…éœ€è¦çš„åŒ…" class="headerlink" title="å®‰è£…éœ€è¦çš„åŒ…"></a>å®‰è£…éœ€è¦çš„åŒ…</h2></li>
<li><p>ä¸­æ–‡è¯­è¨€åŒ…ï¼šluci-i18n-base-zh-cn</p>
</li>
<li><p>USBè½¬ç½‘å£ï¼škmod-usb-net-rtl8152</p>
</li>
<li><p>å¼€å¯BBRï¼škmod-tcp-bbr</p>
</li>
</ul>
<h2 id="ç¼–è¯‘V2ray"><a href="#ç¼–è¯‘V2ray" class="headerlink" title="ç¼–è¯‘V2ray"></a>ç¼–è¯‘V2ray</h2><p>v2rayçš„armç‰ˆå¯¹ä¸åŒç‰ˆæœ¬èŠ¯ç‰‡æ”¯æŒä¸å®Œæ•´ã€‚è¾£ä¹ˆï¼Œè‡ªå·±åŠ¨æ‰‹ï¼<br>æŸ¥çœ‹èŠ¯ç‰‡ä¿¡æ¯ï¼š<code>cat /proc/cpuinfo</code><br>å‚è€ƒ<a class="link"   href="https://www.v2ray.com/developer/intro/compile.html#manualbuild" >æ‰‹å·¥æ„å»º<i class="fas fa-external-link-alt"></i></a><br>å‚è€ƒ<a class="link"   href="https://github.com/golang/go/wiki/GoArm" >golang ARMèŠ¯ç‰‡æ„å»ºæ”¯æŒæƒ…å†µ<i class="fas fa-external-link-alt"></i></a></p>
<ul>
<li>æºç å‡†å¤‡ï¼š<code>go get github.com/v2ray/v2ray-core</code></li>
<li>ç¼–è¯‘<code>v2ray</code>ï¼š<code>GOPROXY=https://goproxy.io CGO_ENABLED=0 GOOS=linux GOARCH=arm GOARM=6 go build -o $HOME/v2ray -ldflags &quot;-s -w&quot;</code></li>
<li>ç¼–è¯‘<code>v2ctl</code>ï¼š<code>GOPROXY=https://goproxy.io CGO_ENABLED=0 GOOS=linux GOARCH=arm GOARM=6 go build -o $HOME/v2ctl -ldflags &quot;-s -w&quot; -tags confonly </code></li>
</ul>
]]></content>
      <tags>
        <tag>OpenWRT</tag>
        <tag>RaspberryPi</tag>
      </tags>
  </entry>
  <entry>
    <title>OpenWRT åœ¨ RaspberryPI æ’­æ”¾éŸ³é¢‘</title>
    <url>/2020/07/06/openwrt-on-raspberrypi-play-audio/</url>
    <content><![CDATA[<p>RaspberryPI ä¸åªèƒ½æ»¡è¶³è·¯ç”±è®¡ç®—éœ€è¦ï¼Œè¿˜èƒ½ç”¨äºå¤šåª’ä½“ï¼Œå¦‚ï¼šæ’ä¸ŠéŸ³ç®±æ”¾éŸ³ä¹ï¼</p>
<h1 id="OpenWrtç¼–è¯‘è¦æ±‚"><a href="#OpenWrtç¼–è¯‘è¦æ±‚" class="headerlink" title="OpenWrtç¼–è¯‘è¦æ±‚"></a>OpenWrtç¼–è¯‘è¦æ±‚</h1><h2 id="å†…æ ¸é©±åŠ¨ç±»è¦æ±‚ï¼š"><a href="#å†…æ ¸é©±åŠ¨ç±»è¦æ±‚ï¼š" class="headerlink" title="å†…æ ¸é©±åŠ¨ç±»è¦æ±‚ï¼š"></a>å†…æ ¸é©±åŠ¨ç±»è¦æ±‚ï¼š</h2><ul>
<li>Kernel modules &gt; Sound Support &gt; kmod-sound-core</li>
<li>Kernel modules &gt; Sound Support &gt; kmod-sound-arm-bcm2835<h2 id="è½¯ä»¶è¦æ±‚"><a href="#è½¯ä»¶è¦æ±‚" class="headerlink" title="è½¯ä»¶è¦æ±‚"></a>è½¯ä»¶è¦æ±‚</h2></li>
<li>Sound &gt; alsa-utils</li>
<li>Sound &gt; madplay</li>
</ul>
<h1 id="Raspberry-PI-è®¾ç½®"><a href="#Raspberry-PI-è®¾ç½®" class="headerlink" title="Raspberry PI è®¾ç½®"></a>Raspberry PI è®¾ç½®</h1><h2 id="å¼€æ”¾è®¾å¤‡"><a href="#å¼€æ”¾è®¾å¤‡" class="headerlink" title="å¼€æ”¾è®¾å¤‡"></a>å¼€æ”¾è®¾å¤‡</h2><p>åœ¨ <code>/boot/config.txt</code> é‡Œæ·»åŠ å¦‚ä¸‹è¡Œï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">dtparam=audio=on</span><br></pre></td></tr></table></figure>
<p>ä½¿Raspberry PIå¼€æ”¾éŸ³é¢‘ç¡¬ä»¶ã€‚ä¸ç„¶æœ‰é©±åŠ¨ç¨‹åºï¼Œä½†æ‰¾ä¸åˆ°éŸ³é¢‘è®¾å¤‡ï¼</p>
<h2 id="è®¾ç½®éŸ³é¢‘è¾“å‡º"><a href="#è®¾ç½®éŸ³é¢‘è¾“å‡º" class="headerlink" title="è®¾ç½®éŸ³é¢‘è¾“å‡º"></a>è®¾ç½®éŸ³é¢‘è¾“å‡º</h2><p>é€šè¿‡<code>amixer</code>å‘½ä»¤å®Œæˆï¼š</p>
<p><code>$ amixer cset numid=3 1</code> ï¼šæŒ‡å®šéŸ³é¢‘è¾“å‡ºæ¥å£ä¸º 3.5mm è€³æœºæ¥å£<br><code>$ amixer cset numid=3 2</code> ï¼šæŒ‡å®šéŸ³é¢‘è¾“å‡ºæ¥å£ä¸º HDMI</p>
<h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> madplay music.mp3</span></span><br><span class="line">  MPEG Audio Decoder 0.15.2 (beta) - Copyright (C) 2000-2004 Robert Leslie et al.</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>OpenWRT</tag>
        <tag>RaspberryPi</tag>
        <tag>éŸ³é¢‘</tag>
      </tags>
  </entry>
  <entry>
    <title>plan 9 æ•ˆåº” - ä¸ºä»€ä¹ˆåŠŸèƒ½æ²¡åï¼Œä½ å°±ä¸è¯¥å»é‡æ„å®ƒï¼</title>
    <url>/2019/08/05/plan-9-effect/</url>
    <content><![CDATA[<p>Plan-9æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ã€å¾ˆå…ˆè¿›çš„ï¼Œè€Œä¸”å®Œå…¨æ˜¯å…¨æ–°å®ç°çš„Unixç³»ç»Ÿï¼Œå®ƒçš„ç›®çš„å°±æ˜¯è¦æœ€ç»ˆè§£å†³Unixæœ€åˆçš„è¯ºè¨€ï¼šä¸€åˆ‡çš†ä¸ºæ–‡ä»¶ã€‚ä½ å¬è¯´è¿‡è¿™å¥—ç³»ç»Ÿå—ï¼Ÿæ²¡æœ‰ï¼Ÿé‚£å¥½ï¼Œä¸‹é¢å°±æ˜¯ä¸ºä»€ä¹ˆã€‚</p>
<p>æˆ‘ååˆ†ç¡®ä¿¡ä½ ä¸çŸ¥é“Plan-9æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œå¹¶ä¸”å¾ˆæœ‰å¯èƒ½ä½ è¿˜æ˜¯ç¬¬ä¸€æ¬¡å¬è¯´è¿™ä¸ªåå­—ã€‚</p>
<p>Plan-9æ˜¯ä¸€æ¬¾ç¥å¥‡çš„æ–°ç‰ˆUnixï¼Œå‡ ä¹æ˜¯ç”±70å¹´ä»£å½“åˆå¼€å‘Unixç³»ç»Ÿçš„åŒä¸€ä¸ªå›¢é˜Ÿå¼€å‘çš„ã€‚å®ƒçš„ç¡®æ˜¯ä¸€æ¬¾éå¸¸é…·çš„æ“ä½œç³»ç»Ÿã€‚å®ƒè·ŸUnixéå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒä¸æ˜¯Unixï¼Œå®ƒçº æ­£äº†Unixç³»ç»Ÿé‡Œå¾ˆå¤šä¸ä¸€è‡´çš„ã€å¤æ€ªçš„ã€è‡³ä»Šä»ç„¶å­˜åœ¨çš„ç‰¹æ€§ã€‚</p>
<p>Unixåœ¨å½“åˆç«‹é¡¹æ—¶æœ‰ä¸ªè¿™æ ·çš„è®¸è¯ºï¼šç³»ç»Ÿé‡Œä»»ä½•çš„ä¸œè¥¿éƒ½æ˜¯â€˜æ–‡ä»¶â€™â€”â€”æ ¹æ®æŸäº›æ–‡ä»¶çš„å®šä¹‰ã€‚ä¾‹å¦‚ï¼Œsocketsï¼Œä¹Ÿè®¸ç§°ä½œç½‘ç»œè¿æ¥æ›´åˆé€‚ï¼Œå®ƒä»¬å°±ä¸æ˜¯æ–‡ä»¶ï¼Œè¿›ç¨‹ä¹Ÿä¸æ˜¯æ–‡ä»¶ã€‚</p>
<p>åœ¨Plan-9ä¸­ï¼Œæ‰€æœ‰çš„è¿™äº›é—®é¢˜éƒ½è§£å†³äº†ï¼å…ˆè¿›çš„9Pè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿåè®®æœ€ç»ˆè®©æ‰€æœ‰ä¸œè¥¿éƒ½æˆä¸ºäº†æ–‡ä»¶ã€‚ç›®å½•å˜æˆäº†â€œå‘½åç©ºé—´â€ï¼Œèµ„æºè¢«æ˜ å°„æˆäº†æ–‡ä»¶ã€‚å¤šä¹ˆç¥å¥‡ï¼ç°åœ¨ï¼Œä½ å¯ä»¥é€šè¿‡å¯¹/procç›®å½•(ç°åœ¨åº”è¯¥æˆå…¶ä¸ºä¸€ä¸ªå‘½åç©ºé—´)é‡Œçš„ä¸€ä¸ªæ–‡ä»¶ä½¿ç”¨â€œcatâ€å‘½ä»¤æ¥æŸ¥çœ‹è¿›ç¨‹çš„æƒ…å†µã€‚åŒæ ·ï¼Œæ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥çš„æ–¹å¼å˜æˆäº†æ‰“å¼€/net/tcpç›®å½•é‡Œçš„ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™å°±æ˜¯å®ƒã€‚â€iotclâ€ç³»ç»Ÿè°ƒç”¨åœ¨è¿™ä¸ªç³»ç»Ÿé‡Œå®Œå…¨è¢«æ ¹é™¤äº†ï¼Œå› ä¸ºåŸºäºæ“ä½œç³»ç»Ÿä¸Šçš„ç°ä»£æ–‡ä»¶å½¢å¼ä¸­çš„è¿™ç§æ€ªèƒå·²ç»ä¸å†éœ€è¦äº†ã€‚</p>
<h2 id="é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä½ ä»æ¥æ²¡æœ‰å¬è¯´è¿‡è¿™æ ·ä¸€æ¬¾ç¥å¥‡çš„æ“ä½œç³»ç»Ÿå‘¢ï¼Ÿ"><a href="#é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä½ ä»æ¥æ²¡æœ‰å¬è¯´è¿‡è¿™æ ·ä¸€æ¬¾ç¥å¥‡çš„æ“ä½œç³»ç»Ÿå‘¢ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä½ ä»æ¥æ²¡æœ‰å¬è¯´è¿‡è¿™æ ·ä¸€æ¬¾ç¥å¥‡çš„æ“ä½œç³»ç»Ÿå‘¢ï¼Ÿ"></a>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä½ ä»æ¥æ²¡æœ‰å¬è¯´è¿‡è¿™æ ·ä¸€æ¬¾ç¥å¥‡çš„æ“ä½œç³»ç»Ÿå‘¢ï¼Ÿ</h2><p>ä½ ä»æ¥æ²¡æœ‰å¬è¯´è¿‡å®ƒçš„åŸå› æ˜¯ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€æ¬¾æˆåŠŸçš„æ“ä½œç³»ç»Ÿã€‚è¿™æ€ä¹ˆå¯èƒ½å‘¢ï¼Ÿæ˜¯è¿™æ ·çš„ï¼Œæ˜¯å› ä¸ºPlan-9å®é™…ä¸Šæ²¡æœ‰è§£å†³ä»»ä½•é—®é¢˜ã€‚åœ¨Unixä¸–ç•Œé‡Œï¼Œä»æ¥æ²¡æœ‰äººæŠ±æ€¨è¯´Unixæ²¡æœ‰å…‘ç°å½“åˆå…³äºæ–‡ä»¶æŠ½è±¡çš„è¯ºè¨€ã€‚</p>
<p>åœ¨éšåçš„æ—¥å­é‡Œï¼ŒPlan-9é‡Œçš„/procæ–‡ä»¶ç³»ç»Ÿæ¦‚å¿µè¢«äººç§»æ¤åˆ°åˆ°äº†Solarisç­‰å¾ˆå¤šå…¶ä»–å•†ä¸šç‰ˆUnixç³»ç»Ÿé‡Œ(Linuxä¹Ÿé‡‡ç”¨äº†å®ƒ)ã€‚ Plan-9é‡Œå¦å¤–ä¸€ä¸ªéå¸¸è‘—åçš„é¦–åˆ›â€”â€”UTF-8â€”â€”è¢«è¿…é€Ÿçš„è¢«ä¼—å¤šå…¶å®ƒæ“ä½œç³»ç»Ÿé‡‡ç”¨ï¼Œä¸ä»…ä»…æ˜¯Unixå®¶æ—ã€‚åœ¨æ‰€æœ‰çš„æ“ä½œç³»ç»Ÿé‡Œï¼Œå³ä½¿å­˜åœ¨ä¸€äº›ç”±äºå„ç§åŸå› æ²¡æœ‰é‡‡ç”¨UTF-8çš„ï¼Œå®ƒä»¬ä¹Ÿå¼€å‘å‡ºæ¥å°†UTF-8å’Œæœ¬åœ°ç¼–ç è½¬æ¢çš„ç¨‹åºåº“ã€‚</p>
<p>Plan-9çš„å¯¹äºç½‘ç»œé€šä¿¡çš„ç‰¹æ®Šçš„å¤„ç†æ–¹å¼éœ€è¦åœ¨è¿™é‡Œç‰¹åˆ«çš„è¯´æ˜ä¸€ä¸‹ã€‚è™½ç„¶ç”¨åŸºäºå‘½åç©ºé—´/æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼æ¥ä»£æ›¿ä¸“ç”¨APIæ¥å¤„ç†ç½‘ç»œæ“ä½œï¼Œå¬èµ·æ¥å¾ˆå¸å¼•äººï¼Œä½†æ˜¯æ•´ä¸ªUnixä¸–ç•Œï¼Œä¸ä»…æ‰€æœ‰äººéƒ½å·²ç»æ¥å—äº†ä½¿ç”¨ä¼¯å…‹åˆ©Socket APIåšä¸ºæ ‡å‡†æ–¹å¼æ¥è¿›è¡Œç½‘ç»œç¼–ç¨‹ï¼Œç”šè‡³Windowså¹³å°ä¹Ÿå®ç°äº†å‡ ä¹ç›¸åŒçš„APIé‡Œç®€åŒ–å„ç§ç½‘ç»œåº”ç”¨å‘Windowsä¸Šç§»æ¤â€”â€”è™½ç„¶å­˜åœ¨ä¸€äº›å°é—®é¢˜ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼ŒPlan-9å‘æ˜çš„è¿™ç§ä¸ä¼—ä¸åŒçš„ç½‘ç»œç¼–ç¨‹ç¼–ç¨‹æ–¹å¼åœ¨è¯ç”Ÿä¹‹æ—¥å°±æ³¨å®šäº†æ¯«æ— ç”¨å¤„ã€‚å› ä¸ºåœ¨å½“æ—¶ï¼Œå¤§éƒ¨åˆ†åšç½‘ç»œç¼–ç¨‹çš„äººéƒ½å·²ç»è½¬å‘äº†æ›´é«˜çš„ç½‘ç»œæŠ½è±¡å±‚ã€‚RPCå’ŒCorbaå·²ç»è¯ç”Ÿï¼Œæ‰€æœ‰çš„éœ€è¦è·Ÿè¿œç¨‹æœåŠ¡å™¨é€šä¿¡çš„åº”ç”¨å…¨éƒ½è½¬å‘äº†å®ƒä»¬ã€‚ç¨‹åºå‘˜ä¸ºäº†è·Ÿè¿œç¨‹æœåŠ¡é€šä¿¡æ—¶éœ€è¦æ‰“å¼€socketsçš„æœºä¼šè¶Šæ¥è¶Šå°‘ï¼Œæ‰€æœ‰çš„ä»–ä»¬éƒ½å·²ç»ä¹ æƒ¯äº†ä½¿ç”¨Berkeley APIã€‚(æ—æ³¨ï¼šæ›¾ç»æœ‰ä¸€ä¸ªPOSIXæ¨¡æ‹Ÿå±‚ï¼Œå«åšAPEâ€œANSI/POSIX Environmentâ€ï¼Œè¯•å›¾å°†Plan-9ä¸Šçš„æŸäº›åŠŸèƒ½æ˜ å°„åˆ°POSIXå¯¹åº”çš„åŠŸèƒ½ä¸Šã€‚è¿™ä¸ªæ¨¡æ‹Ÿå±‚ä¸€ç›´éƒ½æ²¡å®ç°ï¼Œå› ä¸ºä¸€äº›åº”ç”¨â€”â€”ä¾‹å¦‚X11â€”â€”çš„è¿ç§»è¿‡äºå¤æ‚ï¼Œä¸å¯èƒ½å®Œæˆã€‚â€œç»´æŒå®ƒæ­£ç¡®è¿è¡Œçš„å·¥ä½œé‡å¤ªè¿‡å·¨å¤§â€â€”â€”ç»´åŸºç™¾ç§‘ã€‚)</p>
<p>Plan-9çš„ä¸€ä¸ªæœ€ä¸»è¦çš„é—®é¢˜å‡ºåœ¨AT&amp;Tå’ŒUnixå¹•åçš„è¿™ç¾¤äººèº«ä¸Šï¼Œå°½ç®¡ä»–ä»¬éƒ½æ˜¯æ‰åæ¨ªæº¢çš„ç§‘å­¦å®¶å’Œç¨‹åºå‘˜ï¼Œä½†ä»–ä»¬ä¸æ‡‚å¾—å¦‚ä½•å»å¼€å‘å•†ä¸šè½¯ä»¶ï¼Œè€ŒAT&amp;Tä¹Ÿä»æ¥æ²¡æ‰“ç®—è¿›å…¥è½¯ä»¶ä¸šã€‚è¿™äº›ï¼Œæˆ‘æ‰¿è®¤å¬èµ·æ¥æœ‰äº›å¤§ä¸æ•¬ï¼Œä½†äº‹å®å°±æ˜¯è¿™æ ·ã€‚ä»–ä»¬ä½¿ç”¨è½¯ä»¶ï¼Œä»–ä»¬å–œæ¬¢å¼€å‘å†…éƒ¨è½¯ä»¶æ¥è¿è¡Œä»–ä»¬çš„é«˜ç«¯ç½‘ç»œè®¾å¤‡ï¼Œä½†æ˜¯ä»–ä»¬å´ä»æ¥ä¸å»å¼€å‘è¦å–ç»™åˆ«äººçš„è½¯ä»¶ï¼Œè€Œä¸”è·ŸSunï¼ŒIBMï¼Œå¾®è½¯ç­‰å•†ä¸šå…¬å¸ä¸ä¸€æ ·ï¼Œè¿™ä»æ¥ä¸æ˜¯ä»–ä»¬çš„èµ„é‡‘çš„ä¸»è¦æ¥æºã€‚è¿™å°±æ„å‘³ç€ä»–ä»¬ä¸éœ€è¦æœ‰å¤–éƒ¨ä¸–ç•Œéœ€è¦ä»€ä¹ˆæ ·çš„è½¯ä»¶çš„æ„è¯†ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒSunå…¬å¸å°±éœ€è¦è¿™æ ·çš„æ„è¯†ï¼Œæ‰€ä»¥ä»–ä»¬å¼€å‘å‡ºäº†RPCã€‚ä»–ä»¬è®¤è¯†åˆ°äººä»¬åœ¨è¿›è¡Œç½‘ç»œç¼–ç¨‹æ—¶å¾ˆç—›è‹¦ï¼Œä»–ä»¬çœ‹åˆ°äº†åˆ›å»ºä¸€ä¸ªç½‘ç»œæŠ½è±¡å±‚çš„å•†ä¸šæœºä¼šï¼šâ€œå—¨ï¼Œå¤§ä¼™ä»¬ï¼ŒSunOSæœ‰ä¸€ä¸ªå¾ˆé…·çš„ä¸œè¥¿ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿä¸ç›´æ¥è·Ÿsocketsæ‰“äº¤é“å°±å¯ä»¥å¼€å‘å‡ºç½‘ç»œåº”ç”¨ï¼ä½ ç»å¯¹åº”è¯¥ä½¿ç”¨SunOSâ€ã€‚</p>
<p>è¿˜æœ‰ï¼Œåœ¨Plan-9ä¸­ï¼Œå¾ˆå¤šâ€œå¥½çš„è€çš„ä¸œè¥¿â€è¢«åˆ é™¤äº†ï¼Œå¤§é‡çš„è·Ÿå…¶å®ƒUnixä¸å…¼å®¹çš„ä¸œè¥¿è¢«åŠ å…¥äº†ç³»ç»Ÿã€‚è¿™å‡ ä¹æ‰“æ¶ˆäº†ä¼—å¤šå…¬å¸è¯•å›¾å°†ä»–ä»¬çš„åº”ç”¨è¿ç§»åˆ°Plan-9çš„å¿µå¤´ã€‚å¦‚æœä½ ä¸çŸ¥é“è¿™æ ·ä¸€ä¸ªæ–°ç³»ç»Ÿæ˜¯å¦èƒ½å¤Ÿè·å¾—æˆåŠŸï¼Œé‚£ä¸ºä»€ä¹ˆè¦è€—è´¹äº†å¤§é‡çš„å·¥ä½œæŠŠè‡ªå·±çš„åº”ç”¨è¿ç§»åˆ°è¿™ä¸ªæ–°å¹³å°ä¸Šå‘¢ï¼Ÿè¿™å°±æ˜¯å…¸å‹çš„é¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡é—®é¢˜ï¼šä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„ä»·å€¼å°±åœ¨äºä¸Šé¢æœ‰å¤§é‡åº”ç”¨å¯è¿è¡Œï¼Œæ— å®ƒã€‚å¦‚æœä¸€ä¸ªç³»ç»Ÿå¾ˆæ–°ï¼Œä½ è¦åšçš„æ˜¯å¿…é¡»å‘å±•ä¸€ä¸ªèƒ½å¤Ÿæ”¯æŒå„ç§åº”ç”¨çš„ç”Ÿæ€ç³»ç»Ÿï¼Œé€šè¿‡å®ƒä»¬è®©è¿™ä¸ªç³»ç»Ÿå˜å¾—æœ‰ä»·å€¼ã€‚åªæœ‰ä¸¤æ¡è·¯èƒ½åšåˆ°è¿™æ ·ã€‚ç¬¬ä¸€ä¸ªå°±æ˜¯è®©è¿™ä¸ªç³»ç»Ÿè·Ÿç›®å‰ç°å­˜çš„ç³»ç»Ÿä¿æŒæœ€å¤§çš„å…¼å®¹ï¼Œä¹Ÿå°±æ˜¯Unixï¼Œ POSIX å’Œ Motif è¿™äº›ç³»ç»Ÿã€‚ç¬¬äºŒä¸ªå°±æ˜¯åˆ›å»ºè‡ªå·±çš„ç”Ÿæ€ç³»ç»Ÿï¼Œä»¥æ­¤æ¥æå‡æ–°ç³»ç»Ÿçš„ä»·å€¼ï¼Œå¾®è½¯Windowså’ŒOfficeåŠå…¬ç³»ç»Ÿè½¯ä»¶å°±æ˜¯å…¸å‹ä¾‹å­ã€‚</p>
<h2 id="æˆ‘ä»¬åº”è¯¥ä»Plan-9çš„å†å²æ•™è®­ä¸­æ€»ç»“å‡ºä¸€äº›ç»éªŒå—ï¼Ÿ"><a href="#æˆ‘ä»¬åº”è¯¥ä»Plan-9çš„å†å²æ•™è®­ä¸­æ€»ç»“å‡ºä¸€äº›ç»éªŒå—ï¼Ÿ" class="headerlink" title="æˆ‘ä»¬åº”è¯¥ä»Plan-9çš„å†å²æ•™è®­ä¸­æ€»ç»“å‡ºä¸€äº›ç»éªŒå—ï¼Ÿ"></a>æˆ‘ä»¬åº”è¯¥ä»Plan-9çš„å†å²æ•™è®­ä¸­æ€»ç»“å‡ºä¸€äº›ç»éªŒå—ï¼Ÿ</h2><p>å½“ç„¶ï¼Œæˆ‘ä»¬è‡³å°‘å¯ä»¥è·å¾—ä¸‹é¢è¿™äº›ï¼š</p>
<ul>
<li>é¦–å…ˆæ˜¯ï¼Œä¸è¦è¯•å›¾å»ä¿®æ”¹é‚£äº›æ²¡æœ‰åæˆ–ä½ è®¤ä¸ºä¸å¤Ÿå¥½çš„ä¸œè¥¿ï¼Œå¦‚æœè¦ä¿®ï¼Œåªå»ä¿®æ”¹å‡ºé—®é¢˜çš„éƒ¨åˆ†ï¼Œä¸è¦å»ä¿®æ”¹çœ‹èµ·æ¥å¾ˆç¬¨â€”â€”ä½†äº‹å®ä¸Šæ˜¯åœ¨æŒ‰è¦æ±‚å·¥ä½œçš„ä¸œè¥¿ã€‚ä¾‹å¦‚ï¼ŒUTF-8æ˜¯ä¸ªéå¸¸æ£’çš„åˆ›æ„ï¼Œä½ éœ€è¦å®ƒï¼Œä½†ä½ å¯ä»¥ç”¨ç¨‹åºåº“æˆ–å­ç³»ç»Ÿå®ç°å®ƒï¼Œè¿™æ ·å…¶å®ƒç³»ç»Ÿä¹Ÿèƒ½ä½¿ç”¨å®ƒï¼Œè€Œä¸æ˜¯å»åŸºäºè¿™ä¸ªç¼–ç å¼€å‘å‡ºä¸€å¥—å…¨æ–°çš„æ“ä½œç³»ç»Ÿã€‚</li>
<li>ç¬¬äºŒä¸ªæ˜¯ï¼Œåœ¨å¼€å‘ä¸€ä¸ªä½ çš„ç³»ç»Ÿå‰ï¼Œå…ˆå»ææ¸…æ¥šå®ƒæ˜¯å¦æœ‰å¸‚åœºï¼Œæˆ–è€…äººä»¬æ˜¯å¦éœ€è¦è¿™ä¸ªä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œ/net/tcpæ–‡ä»¶ç³»ç»Ÿç»å¯¹æ˜¯ä¸€ä¸ªç²¾å½©çš„çº¯å­¦æœ¯è¯¾é¢˜ï¼Œå¦‚æœæ˜¯æ—©å‡ å¹´ï¼Œå®ƒä¸€å®šèƒ½å®ŒèƒœBerkeley socketsï¼Œä½†ä¸åº”è¯¥æ˜¯åœ¨ç›´æ¥ä½¿ç”¨Socketçš„äººç¾¤å·²ç»æ²¡å‰©å‡ ä¸ªçš„æ—¶å€™ã€‚</li>
<li>ç¬¬ä¸‰ï¼Œè¦ä¹ˆå®Œå…¨çš„ç‹¬ç«‹è‡ªä¸»ï¼Œè¦ä¹ˆè·Ÿç°æœ‰çš„ç³»ç»Ÿä¿æŒæœ€å¤§å…¼å®¹ã€‚ä½†Plan-9å´å¤„åœ¨å®ƒå®Œå…¨ä¸åº”è¯¥çš„ä½ç½®ï¼šä¸­é—´ã€‚è¿™å¥—ç³»ç»Ÿæ—¢ä¸è·Ÿç°æœ‰çš„æ‰€æœ‰Unixç³»ç»Ÿå…¼å®¹ï¼ŒåŒæ—¶ä¹Ÿä¸æä¾›å…¶å®ƒUnixç³»ç»Ÿä¸­éƒ½æœ‰çš„ã€å¿…è¦çš„å·¥å…·ã€‚æ²¡æœ‰é«˜çº§æ–‡æœ¬ç¼–è¾‘å™¨ã€è¡¨æ ¼è½¯ä»¶ã€CADç¨‹åºå’ŒæœåŠ¡å™¨è½¯ä»¶ã€‚å®ƒå°±æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç©ºç›’å­ï¼Œå´æ²¡æœ‰æä¾›ä»»ä½•æ–¹æ³•è®©äººä»¬å®¹æ˜“çš„æŠŠä¸œè¥¿æ”¾è¿›å»ã€‚</li>
</ul>
<p>è¿™äº›çœ‹èµ·æ¥éƒ½æ˜¯ä¸€äº›éå¸¸é«˜å±‚çš„ä¸œè¥¿ï¼Œå¹¶ä¸æ˜¯ç‰¹åˆ«è·Ÿç¨‹åºå‘˜çš„æ—¥å¸¸å¼€å‘ç›¸å…³ã€‚çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼Œä½†äº‹å®è¿œéå¦‚æ­¤ã€‚ç°å¦‚ä»Šï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“çš„å¼€åˆ›è‡ªå·±çš„äº‹ä¸šï¼Œå¼€å§‹å‘ç”¨æˆ·æä¾›æŸç§çš„æœåŠ¡ã€‚ç„¶è€Œï¼Œä½ çš„æœåŠ¡æ˜¯ä¸€ä¸ªæœ‰ä»·å€¼çš„äº§å“ï¼Ÿè¿˜æ˜¯å˜æˆäº†å¦å¤–ä¸€ä¸ªPlan-9ä¼ å¥‡ï¼Ÿè¿™å¹¶ä¸æ˜¯å¾ˆå®¹æ˜“åˆ¤æ–­çš„äº‹ã€‚ä¾‹å¦‚ï¼Œä½ çš„æ‰“ç®—å¼€å‘ä¸€ä¸ªæŠ¥è¡¨ç³»ç»Ÿï¼Œæ¥å±•ç°ç›‘æ§æ•°æ®æˆ–å…¶å®ƒä»»ä½•å¯è§†çš„çŠ¶æ€ï¼Œå¦‚æœä½ æ²¡æœ‰æä¾›ç”¨å®ƒå°†è¿™äº›æŠ¥è¡¨å¯¼å…¥åˆ°Excelçš„åŠŸèƒ½ï¼Œé‚£ä½ åœ¨å†™ç¬¬ä¸€è¡Œä»£ç å‰å°±è¾“äº†ã€‚å¦‚æœä½ æ‰“ç®—å¼€å‘ä¸€ä¸ªæ–°çš„Webç¤¾äº¤åº”ç”¨ï¼Œè€Œä½ æ²¡æœ‰æä¾›ä½¿ç”¨Fackbookã€Twitteræˆ–LinkedInç™»å½•çš„æ–¹å¼ï¼Œé‚£ä½ åœ¨æ­å»ºWEBæœåŠ¡å™¨å‰å°±è¾“äº†ã€‚å¦‚æœä½ webæœåŠ¡ä¸­ä¿¡æ¯çš„å¯¼å‡ºæ–¹å¼æ²¡æœ‰é‡‡ç”¨RSSæˆ–ATOMï¼Œè€Œæ˜¯é‡‡ç”¨äº†ä¸€ç§å…¨æ–°çš„æ ¼å¼ï¼ŒçŒœä¼šæ€ä¹ˆæ ·ï¼Ÿä½ åœ¨å¸å¼•åˆ°ç¬¬ä¸€ä¸ªç”¨æˆ·å‰å°±è¾“äº†ã€‚ä½†æ˜¯ï¼Œæ¯”ç€ä¸€åˆ‡æ›´é‡è¦çš„æ˜¯ï¼šä½ çš„äº§å“çœŸæ­£çš„è§£å†³äº†ä¸€ä¸ªç°å®å­˜åœ¨çš„é—®é¢˜å—ï¼Ÿ</p>
<p>ç¿»è¯‘è‡ªï¼š<a class="link"   href="http://www.di.unipi.it/~nids/docs/the_plan-9_effect.html" >The Plan-9 Effect or why you should not fix it if it ainâ€™t broken<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>plan9</tag>
        <tag>æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>PostgreSQL å¤–éƒ¨è¡¨</title>
    <url>/2018/09/07/postgres_fdw/</url>
    <content><![CDATA[<p>æ˜¯æ—¶å€™ç”¨ä¸€ä¸‹PGå¤–éƒ¨è¡¨äº†ã€‚è¿™äº›å¹´è¿‡å»ï¼Œè¿™åŠŸèƒ½åº”è¯¥æ˜¯ç¨³å®šäº†çš„ã€‚</p>
<h2 id="å¼€å¯"><a href="#å¼€å¯" class="headerlink" title="å¼€å¯"></a>å¼€å¯</h2><p>é¦–å…ˆç¡®å®šcontribæ˜¯å¦æœ‰å®‰è£…ã€‚å¦‚æœæ²¡æœ‰è¦å…ˆå®‰è£…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pkg install postgresql10-contrib</span><br></pre></td></tr></table></figure>
<p>ç„¶åå¼€å¯æ‰©å±•</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> EXTENSION postgres_fdw;</span><br></pre></td></tr></table></figure>
<h2 id="åˆ›å»ºè¿œç¨‹æœåŠ¡"><a href="#åˆ›å»ºè¿œç¨‹æœåŠ¡" class="headerlink" title="åˆ›å»ºè¿œç¨‹æœåŠ¡"></a>åˆ›å»ºè¿œç¨‹æœåŠ¡</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SERVER server156</span><br><span class="line">  <span class="keyword">FOREIGN</span> DATA WRAPPER postgres_fdw</span><br><span class="line">OPTIONS (host <span class="string">&#x27;192.168.1.156&#x27;</span>,dbname <span class="string">&#x27;bossdb&#x27;</span>,port <span class="string">&#x27;5432&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸ªå‘,å°±æ˜¯å¦‚æœ192.168.1.156è¿ä¸ä¸Šçš„æƒ…å†µä¸‹ä¸Šé¢è¯­å¥ä¹Ÿä¼šæ‰§è¡ŒæˆåŠŸ.å…¶å®çœŸæ­£çš„è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨æ˜¯è¦ç­‰åˆ°åé¢dmlæ‰§è¡Œæ—¶æ‰ä¼šè¿æ¥</p>
<h2 id="åˆ›å»ºç”¨æˆ·æ˜ å°„"><a href="#åˆ›å»ºç”¨æˆ·æ˜ å°„" class="headerlink" title="åˆ›å»ºç”¨æˆ·æ˜ å°„"></a>åˆ›å»ºç”¨æˆ·æ˜ å°„</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> MAPPING <span class="keyword">FOR</span> postgres</span><br><span class="line">  SERVER server156</span><br><span class="line">  OPTIONS (<span class="keyword">user</span> <span class="string">&#x27;postgres&#x27;</span>,password <span class="string">&#x27;000000&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå¦‚æœè¾“é”™äº†ä¹Ÿä¸ä¼šçŸ¥é“ã€‚</p>
<h2 id="åˆ›å»ºè¿œç¨‹è¡¨"><a href="#åˆ›å»ºè¿œç¨‹è¡¨" class="headerlink" title="åˆ›å»ºè¿œç¨‹è¡¨"></a>åˆ›å»ºè¿œç¨‹è¡¨</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FOREIGN</span> <span class="keyword">TABLE</span> if <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> qbit_test (</span><br><span class="line">  id <span class="type">INTEGER</span>  ,</span><br><span class="line">  name <span class="type">CHARACTER</span> <span class="type">VARYING</span>(<span class="number">50</span>),</span><br><span class="line">  class <span class="type">CHARACTER</span> <span class="type">VARYING</span>(<span class="number">50</span>),</span><br><span class="line">  <span class="type">time</span> <span class="type">CHARACTER</span> <span class="type">VARYING</span>(<span class="number">50</span>)</span><br><span class="line">)</span><br><span class="line">  SERVER server156</span><br><span class="line">OPTIONS (schema_name <span class="string">&#x27;public&#x27;</span>,table_name <span class="string">&#x27;qbit_test&#x27;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>FDW</tag>
        <tag>å¤–éƒ¨è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu ä¸Šå®‰è£… PostgreSQL 10</title>
    <url>/2018/04/09/postgresql-10-install-ubuntu/</url>
    <content><![CDATA[<h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ul>
<li>æ”¯æŒä¸­æ–‡</li>
<li>è‡ªå®šä¹‰æ—¥å¿—</li>
<li>åˆå§‹å¯†ç </li>
</ul>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å…ˆæŒ‰<a class="link"   href="https://www.postgresql.org/download/linux/ubuntu/" >PostgreSQL<i class="fas fa-external-link-alt"></i></a>å®˜æ–¹æŒ‡å¼•åœ¨Ubuntuä¸Šå®‰è£…å¥½æº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install language-pack-zh-hans postgresql-10 postgresql-server-dev-10</span><br><span class="line">sudo vim /etc/default/locale</span><br><span class="line"><span class="comment"># + LANG=zh_CN.utf8</span></span><br><span class="line">sudo su - postgres</span><br><span class="line">initdb data10 -E utf8 --locale=zh_CN.UTF-8</span><br><span class="line">vim data10/postgresql.conf</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>Ubuntu</tag>
        <tag>initdb</tag>
      </tags>
  </entry>
  <entry>
    <title>PostgreSQL 12 å˜æ›´ç‚¹è¯„</title>
    <url>/2019/10/28/postgresql-12/</url>
    <content><![CDATA[<p>PostgreSQL 12 äº2019å¹´10æœˆ3æ—¥ã€‚ä¹‹å‰åªé˜…è¯»äº†å®ƒçš„<a class="link"   href="https://www.postgresql.org/about/press/presskit12/zh/#original_release" >ä¸­æ–‡æ¦‚è¦è¯´æ˜<i class="fas fa-external-link-alt"></i></a><br>äº†è§£åˆ°äº†å¾ˆå¤šçš„æ€§èƒ½æå‡ã€‚<br> ä½†åœ¨é˜…è¯»<a class="link"   href="https://www.postgresql.org/docs/12/release-12.html" >å®Œæ•´å‘è¡Œè¯´æ˜<i class="fas fa-external-link-alt"></i></a>åï¼Œäº†è§£åˆ°äº†æ›´å¤šçš„æœ‰ç”¨çš„å˜æ›´ã€‚<br> ä»¥ä¸‹æŒ‘é€‰ä¸€äº›æˆ‘å…³å¿ƒçš„ï¼Œåšä¸€ä¸‹ä»‹ç»ã€‚</p>
<h1 id="æµå¤åˆ¶å’Œæ¢å¤"><a href="#æµå¤åˆ¶å’Œæ¢å¤" class="headerlink" title="æµå¤åˆ¶å’Œæ¢å¤"></a>æµå¤åˆ¶å’Œæ¢å¤</h1><h2 id="åºŸå¼ƒäº†recvoery-confã€‚"><a href="#åºŸå¼ƒäº†recvoery-confã€‚" class="headerlink" title="åºŸå¼ƒäº†recvoery.confã€‚"></a>åºŸå¼ƒäº†<code>recvoery.conf</code>ã€‚</h2><ul>
<li>å°†å…¶åŠŸèƒ½å¹¶å…¥äº†<code>postgresql.conf</code>ã€‚</li>
<li>ä½¿ç”¨<code>recovery.signal</code>æˆ–<code>standby.signal</code>æ–‡ä»¶æ¥æ ‡è®°å½“å‰å®ä¾‹çš„çŠ¶æ€ã€‚</li>
<li>ä½¿ç”¨<code>promove_trigger_file</code>å‚æ•° æ›¿ä»£äº†æ—§çš„ <code>trigger_file</code>å‚æ•°ã€‚</li>
<li>æ·»åŠ <code>pg_promote()</code>å‡½æ•°ï¼Œå¯ä»¥åœ¨ä¸æ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼Œå°†ä»åº“ï¼Œç›´æ¥å‡çº§ä¸ºä¸»åº“ã€‚</li>
</ul>
<h2 id="pg-basebackup-æ“ä½œè¡Œä¸ºå˜æ›´"><a href="#pg-basebackup-æ“ä½œè¡Œä¸ºå˜æ›´" class="headerlink" title="pg_basebackup æ“ä½œè¡Œä¸ºå˜æ›´"></a><code>pg_basebackup</code> æ“ä½œè¡Œä¸ºå˜æ›´</h2><p>ä½¿ç”¨<code>pg_basebackup -R ...</code>å®ŒæˆåŸºå‡†å¤‡ä»½åï¼Œåœ¨å¤‡ä»½å¥½çš„æ•°æ®æ–‡ä»¶å¤¹ä¸­ï¼Œæ²¡æœ‰äº†<code>recovery.conf</code>ã€‚<br>ä¼šå¤šå‡ºä¸€ä¸ª<code>standby.signal</code>ç©ºæ–‡ä»¶ã€‚ä¸”åœ¨<code>postgresql.conf</code>ä¸­æ‰¾ä¸åˆ° <code>primary_conninfo</code>é¡¹çš„é…ç½®ã€‚<br>æ­¤é¡¹é…ç½®ä¼šè‡ªåŠ¨åˆ›å»ºåœ¨<code>postgresql.auto.conf</code>æ–‡ä»¶ä¸­ã€‚</p>
<h1 id="é»˜è®¤å¼€å¯JIT"><a href="#é»˜è®¤å¼€å¯JIT" class="headerlink" title="é»˜è®¤å¼€å¯JIT"></a>é»˜è®¤å¼€å¯<code>JIT</code></h1><p>ä½†åœ¨<code>FreeBSD 12.0</code>ä¸Šï¼Œ<code>pkg</code>åŒ…ä¸­ï¼Œä¾æ—§é»˜è®¤é€‰æ‹©ä¿å®ˆåœ°å…³é—­äº†<code>JIT</code>æ”¯æŒã€‚</p>
<h1 id="æˆæƒæ§åˆ¶"><a href="#æˆæƒæ§åˆ¶" class="headerlink" title="æˆæƒæ§åˆ¶"></a>æˆæƒæ§åˆ¶</h1><h1 id="æ”¯æŒæœåŠ¡ç«¯æ ¸éªŒè¯ä¹¦åŸŸå"><a href="#æ”¯æŒæœåŠ¡ç«¯æ ¸éªŒè¯ä¹¦åŸŸå" class="headerlink" title="æ”¯æŒæœåŠ¡ç«¯æ ¸éªŒè¯ä¹¦åŸŸå"></a>æ”¯æŒæœåŠ¡ç«¯æ ¸éªŒè¯ä¹¦åŸŸå</h1><p>åœ¨<code>pg_hba.conf</code>ä¸­é€šè¿‡é…ç½®<code>clientcert=verify-full</code>å®ç°ã€‚è¿™è®©æœåŠ¡å™¨æ›´å®‰å…¨ï¼å®Œæ•´åœ°å®ç°äº†SSLå®‰å…¨ä¼ è¾“ã€‚ä»æºå¤´å µä½äº†ç¬¬ä¸‰æ–¹é€šè¿‡éæ³•è¯ä¹¦è¿æ¥æœåŠ¡ï¼</p>
<h1 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h1><h2 id="bteeå¢å¼º"><a href="#bteeå¢å¼º" class="headerlink" title="bteeå¢å¼º"></a><code>btee</code>å¢å¼º</h2><p>å…è®¸è¾ƒå°çš„å¤šåˆ—<code>btree</code>ç´¢å¼•ï¼Œå¤šåˆ—ç´¢å¼•ã€‚æé«˜äº†<code>btree</code>çš„ç´¢å¼•æ€§èƒ½å’Œç©ºé—´åˆ©ç”¨ç‡ã€‚å‡å°‘é”å®šå¼€é”€ï¼Œè¿›ä¸€æ­¥æé«˜äº†<code>btree</code>æ’å…¥é€Ÿåº¦ã€‚</p>
<h2 id="è¡¨åˆ†åŒºå¢å¼º"><a href="#è¡¨åˆ†åŒºå¢å¼º" class="headerlink" title="è¡¨åˆ†åŒºå¢å¼º"></a>è¡¨åˆ†åŒºå¢å¼º</h2><p>æ›´å¥½çš„åˆ†è¡¨æ€§èƒ½</p>
<h2 id="reindex-æ”¯æŒ-concurently"><a href="#reindex-æ”¯æŒ-concurently" class="headerlink" title="reindex æ”¯æŒ concurently"></a><code>reindex</code> æ”¯æŒ <code>concurently</code></h2><p>æ”¯æŒå¼‚æ­¥é‡å»ºç´¢å¼•</p>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
      </tags>
  </entry>
  <entry>
    <title>PostgreSQL BRINç´¢å¼• æ—¥å¿—å‹æ•°æ®ç´¢å¼•ç¥å™¨</title>
    <url>/2020/06/29/postgresql-brin-index/</url>
    <content><![CDATA[<p>ä¸€å¼ éšç€æ—¶é—´å¢é•¿çš„è¡¨ã€‚å½“è¡¨çš„ä½“ç§¯è¾¾åˆ°æ•°GBæˆ–æ•°åGBåã€‚ä½ ä¼šå‘ç°<code>BTREE</code>ç´¢å¼•ä¹Ÿä¹Ÿæœ‰æ•°GBæˆ–æ•°åGBï¼›BTREEç´¢å¼•å°ºå¯¸æœ‰æ—¶èƒ½è¾¾åˆ°è¡¨æœ¬èº«å°ºå¯¸çš„70%å·¦å³ï¼</p>
<p>å½“ç´¢å¼•çš„å°ºå¯¸æ¥è¿‘æˆ–è¶…è¿‡ç³»ç»Ÿå†…å­˜ä¸€åŠæ—¶ã€‚æŸ¥è¯¢ä½¿ç”¨äº†ç´¢å¼•ï¼Œé€Ÿåº¦ä¹Ÿä¼šæ…¢åˆ°ä»¤äººæ— æ³•å¿å—ï¼</p>
<p>æ­¤æ—¶ä¸€èˆ¬çš„æƒ³æ³•æ˜¯ï¼šåˆ†è¡¨ï¼å°†è¡¨æŒ‰ä¸åŒæ—¶é—´æ®µæ‹†å¼€ã€‚è¿™æ ·æŸ¥è¯¢æ—¶å°±ä¸éœ€è¦æ‰«ææ•´ä¸ªç´¢å¼•äº†ï¼é€Ÿåº¦å°±ä¸Šæ¥äº†ã€‚</p>
<p>å…¶å®ï¼Œæ­¤æ—¶PostgreSQLè¿˜æœ‰ä¸ªæ›´æœ‰æ„æ€çš„ç´¢å¼•ï¼Œç®€ç›´æ˜¯ä»æ ¹æœ¬ä¸Šé‡æ–°å®šä¹‰äº†è¿™ä¸ªé—®é¢˜ï¼å®ƒå°±æ˜¯ï¼š</p>
<h2 id="BRINç´¢å¼•"><a href="#BRINç´¢å¼•" class="headerlink" title="BRINç´¢å¼•"></a><code>BRIN</code>ç´¢å¼•</h2><p>é€šè¿‡<a href="http://postgres.cn/docs/12/brin-intro.html"><code>BRIN</code>ç´¢å¼•çš„å®˜æ–¹ä»‹ç»</a>ï¼Œå¾—çŸ¥ï¼Œå®ƒçš„ç´¢å¼•å®ç°æ˜¯å®Œå…¨å¦ä¸€ç§æ€è·¯ï¼š</p>
<p><code>BRIN</code>ç´¢å¼•ï¼Œæ˜¯æŒ‰å†™å…¥ç£ç›˜çš„æ•°æ®å—ï¼Œåšç´¢å¼•çš„ã€‚å®ƒè®°å½•è¿™å¼ è¡¨ï¼Œç´¢å¼•å­—æ®µåœ¨è¿™ä¸ªæ•°æ®å—ä¸Šçš„æœ€å¤§å€¼ä¸æœ€å°å€¼ï¼›ä¹Ÿå«è¿™ä¸ªå­—æ®µçš„åŒºé—´ã€‚</p>
<p>è¿™å°±å¤§å¤§å‡å°‘äº†ç´¢å¼•çš„å¤æ‚åº¦ï¼Œæé«˜äº†æŸ¥è¯¢é€Ÿåº¦ã€‚</p>
<p>æ¥å…·ä½“ä½“éªŒä¸€ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">cashier<span class="operator">=</span><span class="operator">&gt;</span> \dt<span class="operator">+</span> log.table_name</span><br><span class="line">                           å…³è”åˆ—è¡¨</span><br><span class="line"> æ¶æ„æ¨¡å¼ <span class="operator">|</span>    åç§°    <span class="operator">|</span>  ç±»å‹  <span class="operator">|</span>  æ‹¥æœ‰è€…  <span class="operator">|</span>  å¤§å°   <span class="operator">|</span>  æè¿°</span><br><span class="line"><span class="comment">----------+------------+--------+----------+---------+---------</span></span><br><span class="line"> log      <span class="operator">|</span> table_name <span class="operator">|</span> æ•°æ®è¡¨ <span class="operator">|</span> postgres <span class="operator">|</span> <span class="number">6908</span> MB <span class="operator">|</span> gdbåº”ç”¨</span><br><span class="line">(<span class="number">1</span> è¡Œè®°å½•)</span><br><span class="line"></span><br><span class="line">cashier<span class="operator">=</span><span class="operator">&gt;</span> \di<span class="operator">+</span> log.table_name_log_at_idx</span><br><span class="line">                                    å…³è”åˆ—è¡¨</span><br><span class="line"> æ¶æ„æ¨¡å¼ <span class="operator">|</span>         åç§°          <span class="operator">|</span> ç±»å‹ <span class="operator">|</span>  æ‹¥æœ‰è€…  <span class="operator">|</span>   æ•°æ®è¡¨   <span class="operator">|</span>  å¤§å°  <span class="operator">|</span> æè¿°</span><br><span class="line"><span class="comment">----------+-----------------------+------+----------+------------+--------+------</span></span><br><span class="line"> log      <span class="operator">|</span> table_name_log_at_idx <span class="operator">|</span> ç´¢å¼• <span class="operator">|</span> postgres <span class="operator">|</span> table_name <span class="operator">|</span> <span class="number">272</span> kB <span class="operator">|</span></span><br><span class="line">(<span class="number">1</span> è¡Œè®°å½•)</span><br><span class="line"></span><br><span class="line">cashier<span class="operator">=</span><span class="operator">&gt;</span> explain analyze <span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> log.table_name <span class="keyword">where</span> log_at <span class="keyword">between</span> <span class="string">&#x27;2020-01-01 12:00:00&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2020-01-01 12:01:00&#x27;</span>;</span><br><span class="line">                                                                          QUERY PLAN</span><br><span class="line"><span class="comment">---------------------------------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"> Aggregate  (cost<span class="operator">=</span><span class="number">15547.84</span>.<span class="number">.15547</span><span class="number">.85</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">1</span> width<span class="operator">=</span><span class="number">8</span>) (actual <span class="type">time</span><span class="operator">=</span><span class="number">46.691</span>.<span class="number">.46</span><span class="number">.700</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">1</span> loops<span class="operator">=</span><span class="number">1</span>)</span><br><span class="line">   <span class="operator">-</span><span class="operator">&gt;</span>  Bitmap Heap Scan <span class="keyword">on</span> table_name  (cost<span class="operator">=</span><span class="number">109.06</span>.<span class="number">.15547</span><span class="number">.55</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">116</span> width<span class="operator">=</span><span class="number">0</span>) (actual <span class="type">time</span><span class="operator">=</span><span class="number">3.063</span>.<span class="number">.46</span><span class="number">.153</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">113</span> loops<span class="operator">=</span><span class="number">1</span>)</span><br><span class="line">         Recheck Cond: ((log_at <span class="operator">&gt;=</span> <span class="string">&#x27;2020-01-01 12:00:00+08&#x27;</span>::<span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone) <span class="keyword">AND</span> (log_at <span class="operator">&lt;=</span> <span class="string">&#x27;2020-01-01 12:01:00+08&#x27;</span>::<span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone))</span><br><span class="line">         <span class="keyword">Rows</span> Removed <span class="keyword">by</span> Index Recheck: <span class="number">124960</span></span><br><span class="line">         Heap Blocks: lossy<span class="operator">=</span><span class="number">3848</span></span><br><span class="line">         <span class="operator">-</span><span class="operator">&gt;</span>  Bitmap Index Scan <span class="keyword">on</span> table_name_log_at_idx  (cost<span class="operator">=</span><span class="number">0.00</span>.<span class="number">.109</span><span class="number">.03</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">4059</span> width<span class="operator">=</span><span class="number">0</span>) (actual <span class="type">time</span><span class="operator">=</span><span class="number">1.384</span>.<span class="number">.1</span><span class="number">.389</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">39680</span> loops<span class="operator">=</span><span class="number">1</span>)</span><br><span class="line">               Index Cond: ((log_at <span class="operator">&gt;=</span> <span class="string">&#x27;2020-01-01 12:00:00+08&#x27;</span>::<span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone) <span class="keyword">AND</span> (log_at <span class="operator">&lt;=</span> <span class="string">&#x27;2020-01-01 12:01:00+08&#x27;</span>::<span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone))</span><br><span class="line"> Planning <span class="type">Time</span>: <span class="number">0.106</span> ms</span><br><span class="line"> Execution <span class="type">Time</span>: <span class="number">46.797</span> ms</span><br><span class="line">(<span class="number">9</span> è¡Œè®°å½•)</span><br><span class="line"></span><br><span class="line">cashier<span class="operator">=</span><span class="operator">&gt;</span> explain analyze <span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> log.table_name <span class="keyword">where</span> log_at <span class="keyword">between</span> <span class="string">&#x27;2020-01-01 12:00:00&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2020-01-01 12:01:00&#x27;</span> <span class="keyword">and</span> body_size<span class="operator">&gt;</span><span class="number">100</span>;</span><br><span class="line">                                                                          QUERY PLAN</span><br><span class="line"><span class="comment">---------------------------------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"> Aggregate  (cost<span class="operator">=</span><span class="number">15557.94</span>.<span class="number">.15557</span><span class="number">.95</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">1</span> width<span class="operator">=</span><span class="number">8</span>) (actual <span class="type">time</span><span class="operator">=</span><span class="number">49.396</span>.<span class="number">.49</span><span class="number">.405</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">1</span> loops<span class="operator">=</span><span class="number">1</span>)</span><br><span class="line">   <span class="operator">-</span><span class="operator">&gt;</span>  Bitmap Heap Scan <span class="keyword">on</span> table_name  (cost<span class="operator">=</span><span class="number">109.06</span>.<span class="number">.15557</span><span class="number">.69</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">97</span> width<span class="operator">=</span><span class="number">0</span>) (actual <span class="type">time</span><span class="operator">=</span><span class="number">3.574</span>.<span class="number">.48</span><span class="number">.848</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">101</span> loops<span class="operator">=</span><span class="number">1</span>)</span><br><span class="line">         Recheck Cond: ((log_at <span class="operator">&gt;=</span> <span class="string">&#x27;2020-01-01 12:00:00+08&#x27;</span>::<span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone) <span class="keyword">AND</span> (log_at <span class="operator">&lt;=</span> <span class="string">&#x27;2020-01-01 12:01:00+08&#x27;</span>::<span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone))</span><br><span class="line">         <span class="keyword">Rows</span> Removed <span class="keyword">by</span> Index Recheck: <span class="number">125418</span></span><br><span class="line">         <span class="keyword">Filter</span>: (body_size <span class="operator">&gt;</span> <span class="number">100</span>)</span><br><span class="line">         <span class="keyword">Rows</span> Removed <span class="keyword">by</span> <span class="keyword">Filter</span>: <span class="number">12</span></span><br><span class="line">         Heap Blocks: lossy<span class="operator">=</span><span class="number">3862</span></span><br><span class="line">         <span class="operator">-</span><span class="operator">&gt;</span>  Bitmap Index Scan <span class="keyword">on</span> table_name_log_at_idx  (cost<span class="operator">=</span><span class="number">0.00</span>.<span class="number">.109</span><span class="number">.03</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">4059</span> width<span class="operator">=</span><span class="number">0</span>) (actual <span class="type">time</span><span class="operator">=</span><span class="number">2.176</span>.<span class="number">.2</span><span class="number">.180</span> <span class="keyword">rows</span><span class="operator">=</span><span class="number">39680</span> loops<span class="operator">=</span><span class="number">1</span>)</span><br><span class="line">               Index Cond: ((log_at <span class="operator">&gt;=</span> <span class="string">&#x27;2020-01-01 12:00:00+08&#x27;</span>::<span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone) <span class="keyword">AND</span> (log_at <span class="operator">&lt;=</span> <span class="string">&#x27;2020-01-01 12:01:00+08&#x27;</span>::<span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone))</span><br><span class="line"> Planning <span class="type">Time</span>: <span class="number">0.901</span> ms</span><br><span class="line"> Execution <span class="type">Time</span>: <span class="number">49.624</span> ms</span><br><span class="line">(<span class="number">11</span> è¡Œè®°å½•)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å¯è§ï¼š</p>
<ul>
<li>åœ¨ä¸€å¼ 6.9GBæ•°æ®çš„è¡¨ä¸Šï¼ŒæŒ‰åˆ›å»ºæ—¶é—´å»º<code>BRIN</code>ç´¢å¼•ï¼Œå»ºæˆåï¼Œç´¢å¼•åªæœ‰272KBï¼</li>
<li>åœ¨åšä¸­è¿œè·ç¦»çš„<code>between</code>æŸ¥è¯¢ã€‚åªè¦<code>46ms</code>ï¼</li>
<li>å¸¦æ—¶é—´æ®µçš„å¤šæ¡ä»¶æŸ¥è¯¢ï¼Œä¹Ÿåªè¦<code>49ms</code>ï¼</li>
</ul>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>ç´¢å¼•</tag>
      </tags>
  </entry>
  <entry>
    <title>Citusï¼ŒPostgreSQLçš„æœ€ä½³åˆ†å¸ƒå¼æ”¹é€ ï¼</title>
    <url>/2020/08/14/postgresql-citus/</url>
    <content><![CDATA[<p>å¯¹äºä¸€ç›´å·¥ä½œåœ¨å…³ç³»å‹æ•°æ®åº“ï¼Œä¸”åŠŸèƒ½å¼ºå¤§çš„PostgreSQLçš„å¼€å‘è€…æ¥è¯´ã€‚<br>Citus æ— ç–‘æ˜¯ç»™ä»–ä»¬æ’ä¸Šäº†ä¸€å¯¹ç«ç®­ï¼è®©å…³ç³»å‹æ•°æ®åº“çš„ç”¨æˆ·ï¼Œä¹Ÿèƒ½ç¿±ç¿”åœ¨å¤§æ•°æ®çš„æ—¶ä»£ã€‚</p>
<p>Citus æ­£åœ¨è¢«å¾ˆå¤šå¤§æ•°æ®æœºæ„ä½¿ç”¨ï¼Œæ—¥å‡æ›´æ–°5ï½10äº¿è®°å½•ï¼Œç”šè‡³æœ‰åœ¨70ä¸ªèŠ‚ç‚¹ä¸Šï¼Œè¿è¡Œæ•°æ®è§„æ¨¡è¾¾1.4PBï¼</p>
<p>Citus é€‚ç”¨äºå¤šç§Ÿæˆ·ã€å®æ—¶åˆ†æåœºæ™¯ã€‚ï¼ˆè¿™ä¹Ÿæ­£æ˜¯æˆ‘è¿«åˆ‡éœ€è¦çš„ï¼ï¼‰</p>
<p>ä¸‹è¾¹ä»‹ç»Citusçš„ä¸Šæ‰‹ç»å†ã€‚</p>
<h1 id="è¯•éªŒæ¶æ„"><a href="#è¯•éªŒæ¶æ„" class="headerlink" title="è¯•éªŒæ¶æ„"></a>è¯•éªŒæ¶æ„</h1><pre class="mermaid">graph TB
  m[(citus0)]
  slave1[(citus1)]
  slave2[(citus2)]
  m---slave1
  m---slave2</pre>

<h1 id="å‡†å¤‡ä¸»æœº"><a href="#å‡†å¤‡ä¸»æœº" class="headerlink" title="å‡†å¤‡ä¸»æœº"></a>å‡†å¤‡ä¸»æœº</h1><p>åˆ†å¸ƒå¼ï¼Œè‡³å°‘ä¸¤å°ä»¥ä¸Šä¸»æœºã€‚</p>
<ul>
<li>åè°ƒèŠ‚ç‚¹ï¼Œè´Ÿè´£ç»Ÿç­¹ã€‚ä¸»æœºåï¼šcitus0</li>
<li>å·¥ä½œèŠ‚ç‚¹ï¼Œè´Ÿè´£å­˜å‚¨è®¡ç®—ã€‚ä¸»æœºåï¼šcitus1ã€citus2</li>
</ul>
<h1 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="headerlink" title="ç¼–è¯‘å®‰è£…"></a>ç¼–è¯‘å®‰è£…</h1><p>åœ¨æ¯ä¸€å°æœºå™¨ä¸Šï¼ŒæŒ‰ä»¥ä¸‹æ“ä½œåŒæ ·å‚æ•°å®‰è£…ã€‚</p>
<h2 id="ç‰ˆæœ¬"><a href="#ç‰ˆæœ¬" class="headerlink" title="ç‰ˆæœ¬"></a>ç‰ˆæœ¬</h2><ul>
<li>OSï¼šFreeBSD-12.1-RELEASE-AMD64<ul>
<li><a class="link"   href="https://www.freebsd.org/releases/12.1R/announce.html" >https://www.freebsd.org/releases/12.1R/announce.html<i class="fas fa-external-link-alt"></i></a></li>
</ul>
</li>
<li>PostgreSQLï¼š12.3<ul>
<li><a class="link"   href="https://www.postgresql.org/ftp/source/v12.3/" >https://www.postgresql.org/ftp/source/v12.3/<i class="fas fa-external-link-alt"></i></a></li>
</ul>
</li>
<li>Citusï¼š9.4.0<ul>
<li><a class="link"   href="https://github.com/citusdata/citus/releases/tag/v9.4.0" >https://github.com/citusdata/citus/releases/tag/v9.4.0<i class="fas fa-external-link-alt"></i></a></li>
</ul>
</li>
</ul>
<h2 id="ç¼–è¯‘å‚æ•°"><a href="#ç¼–è¯‘å‚æ•°" class="headerlink" title="ç¼–è¯‘å‚æ•°"></a>ç¼–è¯‘å‚æ•°</h2><h3 id="PostgreSQL-12-3-ç¼–è¯‘"><a href="#PostgreSQL-12-3-ç¼–è¯‘" class="headerlink" title="PostgreSQL 12.3 ç¼–è¯‘"></a>PostgreSQL 12.3 ç¼–è¯‘</h3><p>ç¼–è¯‘ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">kg install llvm90 gettext curl gmake</span><br><span class="line">./configure &#x27;--with-libraries=/usr/local/lib&#x27; &#x27;--with-includes=/usr/local/include&#x27; &#x27;--enable-thread-safety&#x27; &#x27;--disable-debug&#x27; &#x27;--enable-nls&#x27; &#x27;--without-pam&#x27; &#x27;--with-openssl&#x27; &#x27;--without-llvm&#x27; &#x27;--without-gssapi&#x27; &#x27;--prefix=/usr/local&#x27; &#x27;--localstatedir=/var&#x27; &#x27;--mandir=/usr/local/man&#x27; &#x27;--infodir=/usr/local/share/info/&#x27; &#x27;--build=amd64-portbld-freebsd12.1&#x27; &#x27;build_alias=amd64-portbld-freebsd12.1&#x27; &#x27;CC=cc&#x27; &#x27;CFLAGS=-O2 -pipe  -fstack-protector-strong -fno-strict-aliasing &#x27; &#x27;LDFLAGS= -L/usr/local/lib -lpthread -L/usr/local/lib  -fstack-protector-strong &#x27; &#x27;LIBS=&#x27; &#x27;CPPFLAGS=-I/usr/local/include&#x27; &#x27;CXX=c++&#x27; &#x27;CXXFLAGS=-O2 -pipe -fstack-protector-strong -fno-strict-aliasing  &#x27; &#x27;CPP=cpp&#x27; &#x27;PKG_CONFIG=pkgconf&#x27; &#x27;LDFLAGS_SL=&#x27;</span><br><span class="line">make world</span><br><span class="line">make install-world</span><br><span class="line">adduser postgres</span><br></pre></td></tr></table></figure>
<h3 id="Citus-9-4-0-ç¼–è¯‘"><a href="#Citus-9-4-0-ç¼–è¯‘" class="headerlink" title="Citus 9.4.0 ç¼–è¯‘"></a>Citus 9.4.0 ç¼–è¯‘</h3><p>ç¼–è¯‘</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./configure &#x27;LDFLAGS= -L/usr/local/lib -lpthread -L/usr/local/lib  -fstack-protector-strong &#x27; CPPFLAGS=-I/usr/local/include</span><br><span class="line">gmake</span><br><span class="line">gmake install</span><br></pre></td></tr></table></figure>
<h1 id="è®¾ç½®å¹¶å¯ç”¨Citus"><a href="#è®¾ç½®å¹¶å¯ç”¨Citus" class="headerlink" title="è®¾ç½®å¹¶å¯ç”¨Citus"></a>è®¾ç½®å¹¶å¯ç”¨Citus</h1><h2 id="æ‰€æœ‰ä¸»æœºä¸Šçš„å…±åŒæ“ä½œ"><a href="#æ‰€æœ‰ä¸»æœºä¸Šçš„å…±åŒæ“ä½œ" class="headerlink" title="æ‰€æœ‰ä¸»æœºä¸Šçš„å…±åŒæ“ä½œ"></a>æ‰€æœ‰ä¸»æœºä¸Šçš„å…±åŒæ“ä½œ</h2><p>æ³¨æ„ï¼š**<em>ä»¥ä¸‹æ‰€æœ‰æ“ä½œéƒ½åœ¨è¦æ¯ä¸ªèŠ‚ç‚¹ä¸»æœºä¸Šå®Œæ•´æ“ä½œå®Œã€‚åŒ…æ‹¬å»ºåº“å’Œå¯ç”¨<code>citus</code>ã€‚ä¸”ä¸€å®šæ˜¯å…ˆå»ºåº“ï¼Œè¿›å…¥<code>main</code>åº“åå†å¯åŠ¨<code>citus</code>æ‰©å±•**</em></p>
<ul>
<li>åˆå§‹åŒ–æ•°æ®åº“<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">su postgres</span><br><span class="line">initdb data</span><br></pre></td></tr></table></figure></li>
<li>é…ç½®<code>postgresql.conf</code><blockquote>
<p>listen_addresses = â€˜*â€™</p>
<p>port = 5432</p>
<p>shared_buffers = 256MB # æŒ‰éœ€è°ƒèŠ‚</p>
<p>shared_preload_libraries = â€˜citusâ€™ # å…³é”®é…ç½®</p>
</blockquote>
</li>
<li>é…ç½®<code>pg_hba.conf</code><blockquote>
<p>host    all             all             192.168.1.1/24          trust  # å¼€æ”¾å†…ç½‘è®¿é—®</p>
</blockquote>
</li>
<li>å¯åŠ¨PostgreSQL<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">pg_ctl -D data start</span><br></pre></td></tr></table></figure></li>
<li>å»ºåº“å¹¶å¯ç”¨Citus<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">psql</span><br><span class="line">create database main;</span><br><span class="line">\c main</span><br><span class="line">create extension citus;</span><br></pre></td></tr></table></figure>
<h2 id="åè°ƒèŠ‚ç‚¹ä¸Šçš„æ“ä½œ"><a href="#åè°ƒèŠ‚ç‚¹ä¸Šçš„æ“ä½œ" class="headerlink" title="åè°ƒèŠ‚ç‚¹ä¸Šçš„æ“ä½œ"></a>åè°ƒèŠ‚ç‚¹ä¸Šçš„æ“ä½œ</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">psql main</span><br><span class="line">select master_add_node(&#x27;citus1&#x27;,5432);</span><br><span class="line">select master_add_node(&#x27;citus2&#x27;,5432);</span><br><span class="line"></span><br><span class="line">main=# select master_get_active_worker_nodes();</span><br><span class="line"> master_get_active_worker_nodes</span><br><span class="line">--------------------------------</span><br><span class="line"> (citus1,5432)</span><br><span class="line"> (citus2,5432)</span><br><span class="line">(2 è¡Œè®°å½•)</span><br></pre></td></tr></table></figure>
<h1 id="ä½¿ç”¨Citus"><a href="#ä½¿ç”¨Citus" class="headerlink" title="ä½¿ç”¨Citus"></a>ä½¿ç”¨Citus</h1>ç°åœ¨åªè¦åœ¨åè°ƒèŠ‚ç‚¹<code>citus0</code>ä¸Šçš„<code>main</code>åº“ä¸­å»ºè¡¨ã€‚æ‰€æœ‰å·¥ä½œèŠ‚ç‚¹éƒ½ä¼šè‡ªåŠ¨åˆ›å»ºåˆ†è¡¨ã€‚</li>
</ul>
<p>åœ¨åè°ƒèŠ‚ç‚¹ä¸Šå­˜å‚¨ä¼šå°†æ•°æ®åˆ†å‘åˆ°ä¸åŒçš„å·¥ä½œèŠ‚ç‚¹ä¸Šã€‚æŸ¥è¯¢ä¹Ÿæ˜¯åœ¨å¤šä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šåˆ†å¸ƒæŸ¥è¯¢äº†ã€‚</p>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>Citus</tag>
      </tags>
  </entry>
  <entry>
    <title>PostgreSQL æ€§èƒ½ä¼˜åŒ–</title>
    <url>/2016/12/15/postgresql-config/</url>
    <content><![CDATA[<pre><code>PostgreSQL ä¸€ä¸ªè¿æ¥ä¸€ä¸ªè¿›ç¨‹ï¼Œåº”ç”¨ç»™WEBæœåŠ¡å°±å‹åŠ›å±±å¤§äº†ã€‚
å¤‡ç‚¹è´§ä»¥å¤‡å±±æ´ªæ¥ä¸´ï¼</code></pre>
<p><em>ä»¥ä¸‹æ•´ç†è‡ªï¼š<a class="link"   href="http://blog.gdsyzx.edu.cn/sense/?p=460#content" >Senseâ€™s Blog<i class="fas fa-external-link-alt"></i></a></em></p>
<h1 id="æœåŠ¡å™¨å‚æ•°é…ç½®"><a href="#æœåŠ¡å™¨å‚æ•°é…ç½®" class="headerlink" title="æœåŠ¡å™¨å‚æ•°é…ç½®"></a>æœåŠ¡å™¨å‚æ•°é…ç½®</h1><p>é…ç½®æ–‡ä»¶postgres.confä¸­çš„å¾ˆå¤šè®¾ç½®éƒ½ä¼šå½±å“æ€§èƒ½ï¼Œ</p>
<h2 id="shared-buffers"><a href="#shared-buffers" class="headerlink" title="shared_buffers"></a>shared_buffers</h2><p>è¿™æ˜¯æœ€é‡è¦çš„å‚æ•°ï¼Œpostgresqlé€šè¿‡shared_bufferså’Œå†…æ ¸/ç£ç›˜æ‰“äº¤é“ã€‚</p>
<p>å› æ­¤åº”è¯¥å°½é‡å¤§ï¼Œè®©æ›´å¤šçš„æ•°æ®ç¼“å­˜åœ¨shared_buffersä¸­ï¼Œé€šå¸¸è®¾ç½®ä¸ºå®é™…RAMçš„10ï¼…æ˜¯åˆç†çš„ï¼Œæ¯”å¦‚50000(400M)</p>
<h2 id="work-mem"><a href="#work-mem" class="headerlink" title="work_mem"></a>work_mem</h2><p>åœ¨pgsql 8.0ä¹‹å‰å«åšsort_memã€‚postgresqlåœ¨æ‰§è¡Œæ’åºæ“ä½œæ—¶ï¼Œ</p>
<p>ä¼šæ ¹æ®work_memçš„å¤§å°å†³å®šæ˜¯å¦å°†ä¸€ä¸ªå¤§çš„ç»“æœé›†æ‹†åˆ†ä¸ºå‡ ä¸ªå°çš„å’Œwork_memæŸ¥ä¸å¤šå¤§å°çš„ä¸´æ—¶æ–‡ä»¶ã€‚</p>
<p>æ˜¾ç„¶æ‹†åˆ†çš„ç»“æœæ˜¯é™ä½äº†æ’åºçš„é€Ÿåº¦ã€‚å› æ­¤å¢åŠ work_memæœ‰åŠ©äºæé«˜æ’åºçš„é€Ÿåº¦ã€‚é€šå¸¸è®¾ç½®ä¸ºå®é™…RAMçš„2%-4%ï¼Œæ ¹æ®éœ€è¦æ’åºç»“æœé›†çš„å¤§å°è€Œå®šï¼Œæ¯”å¦‚81920(80M)</p>
<h2 id="effective-cache-size"><a href="#effective-cache-size" class="headerlink" title="effective_cache_size"></a>effective_cache_size</h2><p>æ˜¯postgresqlèƒ½å¤Ÿä½¿ç”¨çš„æœ€å¤§ç¼“å­˜ï¼Œ<br>è¿™ä¸ªæ•°å­—å¯¹äºç‹¬ç«‹çš„pgsqlæœåŠ¡å™¨è€Œè¨€åº”è¯¥è¶³å¤Ÿå¤§ï¼Œæ¯”å¦‚4Gçš„å†…å­˜ï¼Œå¯ä»¥è®¾ç½®ä¸º3.5G(437500)</p>
<h2 id="maintence-work-mem"><a href="#maintence-work-mem" class="headerlink" title="maintence_work_mem"></a>maintence_work_mem</h2><p>è¿™é‡Œå®šä¹‰çš„å†…å­˜åªæ˜¯åœ¨CREATE INDEX, VACUUMç­‰æ—¶ç”¨åˆ°ï¼Œå› æ­¤ç”¨åˆ°çš„é¢‘ç‡ä¸é«˜ï¼Œä½†æ˜¯å¾€å¾€è¿™äº›æŒ‡ä»¤æ¶ˆè€—æ¯”è¾ƒå¤šçš„èµ„æºï¼Œ</p>
<p>å› æ­¤åº”è¯¥å°½å¿«è®©è¿™äº›æŒ‡ä»¤å¿«é€Ÿæ‰§è¡Œå®Œæ¯•ï¼šç»™maintence_work_memå¤§çš„å†…å­˜ï¼Œæ¯”å¦‚512M(524288)</p>
<h2 id="max-connections"><a href="#max-connections" class="headerlink" title="max_connections"></a>max_connections</h2><p>é€šå¸¸ï¼Œmax_connectionsçš„ç›®çš„æ˜¯é˜²æ­¢max_connections * work_memè¶…å‡ºäº†å®é™…å†…å­˜å¤§å°ã€‚</p>
<p>æ¯”å¦‚ï¼Œå¦‚æœå°†work_memè®¾ç½®ä¸ºå®é™…å†…å­˜çš„2%å¤§å°ï¼Œåˆ™åœ¨æç«¯æƒ…å†µä¸‹ï¼Œå¦‚æœæœ‰50ä¸ªæŸ¥è¯¢éƒ½æœ‰æ’åºè¦æ±‚ï¼Œè€Œä¸”éƒ½ä½¿ç”¨2ï¼…çš„å†…å­˜ï¼Œåˆ™ä¼šå¯¼è‡´swapçš„äº§ç”Ÿï¼Œç³»ç»Ÿæ€§èƒ½å°±ä¼šå¤§å¤§é™ä½ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœæœ‰4Gçš„å†…å­˜ï¼ŒåŒæ—¶å‡ºç°50ä¸ªå¦‚æ­¤å¤§çš„æŸ¥è¯¢çš„å‡ ç‡åº”è¯¥æ˜¯å¾ˆå°çš„ã€‚ä¸è¿‡ï¼Œè¦æ¸…æ¥šmax_connectionså’Œwork_memçš„å…³ç³»ã€‚</p>
<p>æœ‰å…³å‚æ•°çš„è§£é‡Šå¯è§ï¼š <a class="link"   href="http://www.postgres.cn/docs/9.5/runtime-config.html" >http://www.postgres.cn/docs/9.5/runtime-config.html<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="ç¡¬ä»¶çš„é€‰æ‹©"><a href="#ç¡¬ä»¶çš„é€‰æ‹©" class="headerlink" title="ç¡¬ä»¶çš„é€‰æ‹©"></a>ç¡¬ä»¶çš„é€‰æ‹©</h2><p>ç”±äºè®¡ç®—æœºç¡¬ä»¶å¤§å¤šæ•°æ˜¯å…¼å®¹çš„ï¼Œäººä»¬æ€»æ˜¯å€¾å‘äºç›¸ä¿¡æ‰€æœ‰è®¡ç®—æœºç¡¬ä»¶è´¨é‡ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p>
<p>äº‹å®ä¸Šä¸æ˜¯ï¼Œ ECC RAMï¼ˆå¸¦å¥‡å¶æ ¡éªŒçš„å†…å­˜ï¼‰ï¼ŒSCSI ï¼ˆç¡¬ç›˜ï¼‰å’Œä¼˜è´¨çš„ä¸»æ¿æ¯”ä¸€äº›ä¾¿å®œè´§è¦æ›´åŠ å¯é ä¸”å…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚</p>
<p>PostgreSQLå‡ ä¹å¯ä»¥è¿è¡Œåœ¨ä»»ä½•ç¡¬ä»¶ä¸Šï¼Œä½†å¦‚æœå¯é æ€§å’Œæ€§èƒ½å¯¹ä½ çš„ç³»ç»Ÿå¾ˆé‡è¦ï¼Œä½ å°±éœ€è¦å…¨é¢çš„ç ”ç©¶ä¸€ä¸‹ä½ çš„ç¡¬ä»¶é…ç½®äº†ã€‚</p>
<p>è®¡ç®—æœºç¡¬ä»¶å¯¹æ€§èƒ½çš„å½±å“å¯æµè§ˆ <a class="link"   href="http://candle.pha.pa.us/main/writings/pgsql/hw_performance/index.html" >http://candle.pha.pa.us/main/writings/pgsql/hw_performance/index.html<i class="fas fa-external-link-alt"></i></a> å’Œ <a class="link"   href="http://www.powerpostgresql.com/PerfList/%E3%80%82" >http://www.powerpostgresql.com/PerfList/ã€‚<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="è¿æ¥æ—¶æ”¶åˆ°â€œSorry-too-many-clientsâ€æ¶ˆæ¯ï¼Ÿ"><a href="#è¿æ¥æ—¶æ”¶åˆ°â€œSorry-too-many-clientsâ€æ¶ˆæ¯ï¼Ÿ" class="headerlink" title="è¿æ¥æ—¶æ”¶åˆ°â€œSorry, too many clientsâ€æ¶ˆæ¯ï¼Ÿ"></a>è¿æ¥æ—¶æ”¶åˆ°â€œSorry, too many clientsâ€æ¶ˆæ¯ï¼Ÿ</h2><p>è¿™è¡¨ç¤ºä½ å·²è¾¾åˆ°ç¼ºçœ100ä¸ªå¹¶å‘åå°è¿›ç¨‹æ•°çš„é™åˆ¶ï¼Œ</p>
<p>ä½ éœ€è¦é€šè¿‡ä¿®æ”¹postgresql.confæ–‡ä»¶ä¸­çš„max_connectionså€¼æ¥ å¢åŠ postmasterçš„åå°å¹¶å‘å¤„ç†æ•°ï¼Œä¿®æ”¹åéœ€é‡æ–°å¯åŠ¨postmasterã€‚</p>
<h1 id="SQLæŸ¥è¯¢"><a href="#SQLæŸ¥è¯¢" class="headerlink" title="SQLæŸ¥è¯¢"></a>SQLæŸ¥è¯¢</h1><p>æ£€æŸ¥æ•°æ®æ£€ç´¢çš„ç´¢å¼•æ˜¯å¦å»ºç«‹ï¼Œå‡¡æ˜¯éœ€è¦æŸ¥æ‰¾çš„å­—æ®µå°½é‡å»ºç«‹ç´¢å¼•ï¼Œç”šè‡³æ˜¯è”åˆç´¢å¼•ï¼›</p>
<p>åˆ›å»ºç´¢å¼•ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼å’Œéƒ¨åˆ†ç´¢å¼•ï¼›</p>
<p>ä½¿ç”¨COPYè¯­å¥ä»£æ›¿å¤šä¸ªInsertè¯­å¥ï¼›</p>
<p>å°†å¤šä¸ªSQLè¯­å¥ç»„æˆä¸€ä¸ªäº‹åŠ¡ä»¥å‡å°‘æäº¤äº‹åŠ¡çš„å¼€é”€ï¼›</p>
<p>ä»ä¸€ä¸ªç´¢å¼•ä¸­æå–å¤šæ¡è®°å½•æ—¶ä½¿ç”¨CLUSTERï¼›</p>
<p>ä»ä¸€ä¸ªæŸ¥è¯¢ç»“æœä¸­å–å‡ºéƒ¨åˆ†è®°å½•æ—¶ä½¿ç”¨LIMITï¼›</p>
<p>ä½¿ç”¨é¢„ç¼–è¯‘å¼æŸ¥è¯¢ï¼ˆPrepared Query)ï¼›</p>
<p>ä½¿ç”¨ANALYZEä»¥ä¿æŒç²¾ç¡®çš„ä¼˜åŒ–ç»Ÿè®¡ï¼›</p>
<p>å®šæœŸä½¿ç”¨ VACUUM æˆ– pg_autovacuum</p>
<p>è¿›è¡Œå¤§é‡æ•°æ®æ›´æ”¹æ—¶å…ˆåˆ é™¤ç´¢å¼•ï¼ˆç„¶åé‡å»ºç´¢å¼•ï¼‰</p>
<h1 id="ç¨‹åºç»éªŒ"><a href="#ç¨‹åºç»éªŒ" class="headerlink" title="ç¨‹åºç»éªŒ"></a>ç¨‹åºç»éªŒ</h1><p>æ£€æŸ¥ç¨‹åºï¼Œæ˜¯å¦ä½¿ç”¨äº†è¿æ¥æ± ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ï¼Œå°½å¿«ä½¿ç”¨å§ï¼›</p>
<p>ç»§ç»­æ£€æŸ¥ç¨‹åºï¼Œè¿æ¥ä½¿ç”¨åï¼Œæ˜¯å¦äº¤è¿˜ç»™äº†è¿æ¥æ± ï¼›</p>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨postgresqlçš„file-fdwæ‰©å±•åˆ†ænginxæ—¥å¿—</title>
    <url>/2019/07/10/postgresql-file-fdw-analysis-nginx-log/</url>
    <content><![CDATA[<h1 id="åŸæ–™"><a href="#åŸæ–™" class="headerlink" title="åŸæ–™"></a>åŸæ–™</h1><h2 id="PostgreSQL-æ–¹é¢"><a href="#PostgreSQL-æ–¹é¢" class="headerlink" title="PostgreSQL æ–¹é¢"></a>PostgreSQL æ–¹é¢</h2><p>PostgreSQLçš„file_fdwä½¿ç”¨è¯´æ˜ï¼š<br><a class="link"   href="http://www.postgres.cn/docs/11/file-fdw.html" >file_fdw ä¸­æ–‡æ–‡æ¡£<i class="fas fa-external-link-alt"></i></a></p>
<h2 id="nginx-æ–¹é¢"><a href="#nginx-æ–¹é¢" class="headerlink" title="nginx æ–¹é¢"></a>nginx æ–¹é¢</h2><p>nginx éƒ¨åˆ†å˜é‡è¯´æ˜ï¼š</p>
<ul>
<li>$remote_addr  å®¢æˆ·ç«¯IP</li>
<li>$time_local   è¯»èµ·æ¥ä¸å¤ªèˆ’æœçš„æ—¶é—´</li>
<li>$time_iso8601 æ¯”è¾ƒèˆ’æœçš„æ—¶é—´</li>
<li>$request_time ä»acceptåˆ°å‘å®Œç›¸åº”æ•°æ®ï¼Œè€—è´¹çš„æ—¶é—´ï¼Œå•ä½ï¼šç§’</li>
<li>$upstream_response_time   nginxæ”¶åˆ°è¯·æ±‚äº¤ç»™å…¶å®ƒåº”ç”¨å¤„ç†å¹¶å¾—åˆ°ç»“æœçš„æ—¶é—´ï¼Œå•ä½ï¼šç§’</li>
<li>$body_bytes_sent  å“åº”åŒ…ä½“çš„å°ºå¯¸ï¼Œå•ä½ï¼šå­—èŠ‚</li>
<li>$request  è¯·æ±‚æè¿°</li>
<li>$status   å“åº”çš„çŠ¶æ€ç </li>
</ul>
<p><strong><code>$request_time</code>ã€<code>$upstream_response_time</code>çš„è®°å½•å€¼ä¸ä¸€å®šæ˜¯æ•°å­—ï¼Œæœ‰æ—¶ä¼šæ˜¯<code>-</code></strong></p>
<h1 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h1><h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><p>PostgreSQLå¯¹å¤„ç†CSVæ¯”è¾ƒæ“…é•¿ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æŠŠnginxçš„æ—¥å¿—å®šåˆ¶æˆCSVçš„æ ·å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">log_format  csv_log &#39;$remote_addr, $time_iso8601, $request_time, $upstream_response_time, $body_bytes_sent, $request, $status&#39;;</span><br></pre></td></tr></table></figure>
<p>åœ¨éœ€è¦çš„serverä¸‹åº”ç”¨è¿™ä¸ªæ ¼å¼ï¼Œ<strong>è¦ç¡®ä¿åº”ç”¨åçš„æ—¥å¿—æ–‡ä»¶ä¸­åªæœ‰ä¸€ç§æ ¼å¼çš„æ—¥å¿—</strong>ã€‚</p>
<h2 id="PostgreSQL"><a href="#PostgreSQL" class="headerlink" title="PostgreSQL"></a>PostgreSQL</h2><p><code>psql</code> è¿›å…¥</p>
<p>åˆ¤æ–­æ˜¯å¦å®‰è£…æ‰©å±•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">\dx</span><br><span class="line">                                     List <span class="keyword">of</span> installed extensions</span><br><span class="line">        Name        <span class="operator">|</span> Version <span class="operator">|</span>   Schema   <span class="operator">|</span>                        Description</span><br><span class="line"><span class="comment">--------------------+---------+------------+-----------------------------------------------------------</span></span><br><span class="line"> file_fdw           <span class="operator">|</span> <span class="number">1.0</span>     <span class="operator">|</span> public     <span class="operator">|</span> <span class="keyword">foreign</span><span class="operator">-</span>data wrapper <span class="keyword">for</span> flat file access</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>å®‰è£…æ‰©å±•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> extension file_fdw</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºæœåŠ¡ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SERVER nginx_log <span class="keyword">FOREIGN</span> DATA WRAPPER file_fdw;</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºå¤–éƒ¨è¡¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">foreign</span> <span class="keyword">table</span> app_log (</span><br><span class="line"> ip inet,</span><br><span class="line"> create_at <span class="type">timestamp</span> <span class="keyword">with</span> <span class="type">time</span> zone,</span><br><span class="line"> request_cost text,</span><br><span class="line"> stream_cost text,</span><br><span class="line"> body_size <span class="type">integer</span>,</span><br><span class="line"> request text,</span><br><span class="line"> status <span class="type">integer</span></span><br><span class="line"> ) server nginx_log options ( filename <span class="string">&#x27;/your/nginx/log/path/file.log&#x27;</span>, format <span class="string">&#x27;csv&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>ä½“éªŒï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> client_ip,create_at,request_cost,upstream_cost,pg_size_pretty(body_size::<span class="type">bigint</span>) body_length,request <span class="keyword">from</span> app_log <span class="keyword">where</span> body_size<span class="operator">&gt;</span><span class="number">1024</span><span class="operator">*</span><span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">  client_ip  <span class="operator">|</span>       create_at        <span class="operator">|</span> request_cost <span class="operator">|</span> upstream_cost <span class="operator">|</span> body_length <span class="operator">|</span>                           request</span><br><span class="line"><span class="comment">-------------+------------------------+--------------+---------------+-------------+--------------------------------------------------------------</span></span><br><span class="line"> <span class="number">58.19</span><span class="number">.94</span><span class="number">.70</span> <span class="operator">|</span> <span class="number">2019</span><span class="number">-07</span><span class="number">-09</span> <span class="number">11</span>:<span class="number">05</span>:<span class="number">37</span><span class="operator">+</span><span class="number">08</span> <span class="operator">|</span>  <span class="number">0.984</span>       <span class="operator">|</span>  <span class="number">0.113</span>        <span class="operator">|</span> <span class="number">1470</span> kB     <span class="operator">|</span>  <span class="keyword">GET</span> <span class="operator">/</span>v4<span class="number">.3</span><span class="number">.1</span><span class="operator">/</span>sync<span class="operator">/</span>member_pockets?<span class="keyword">at</span><span class="operator">=</span><span class="number">-999</span><span class="operator">&amp;</span>sid<span class="operator">=</span><span class="number">205118</span> HTTP<span class="operator">/</span><span class="number">2.0</span></span><br><span class="line"> <span class="number">58.19</span><span class="number">.94</span><span class="number">.70</span> <span class="operator">|</span> <span class="number">2019</span><span class="number">-07</span><span class="number">-09</span> <span class="number">11</span>:<span class="number">05</span>:<span class="number">38</span><span class="operator">+</span><span class="number">08</span> <span class="operator">|</span>  <span class="number">0.810</span>       <span class="operator">|</span>  <span class="number">0.149</span>        <span class="operator">|</span> <span class="number">1470</span> kB     <span class="operator">|</span>  <span class="keyword">GET</span> <span class="operator">/</span>v4<span class="number">.3</span><span class="number">.1</span><span class="operator">/</span>sync<span class="operator">/</span>member_pockets?<span class="keyword">at</span><span class="operator">=</span><span class="number">-999</span><span class="operator">&amp;</span>sid<span class="operator">=</span><span class="number">205118</span> HTTP<span class="operator">/</span><span class="number">2.0</span></span><br><span class="line">(<span class="number">2</span> <span class="keyword">rows</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>nginx</tag>
        <tag>file-fdw</tag>
        <tag>log</tag>
      </tags>
  </entry>
  <entry>
    <title>FreeBSD ä¸Šåˆå§‹åŒ– PostgreSQL 96</title>
    <url>/2017/07/12/postgresql-init/</url>
    <content><![CDATA[<h2 id="ç–¼ç‚¹"><a href="#ç–¼ç‚¹" class="headerlink" title="ç–¼ç‚¹"></a>ç–¼ç‚¹</h2><ul>
<li><code>postgres</code> è¿™ä¸ªç”¨æˆ·åï¼Œæ‰“èµ·æ¥éº»çƒ¦ï¼Œä¸åŠ<code>pgsql</code>æ–¹ä¾¿ã€‚</li>
<li><code>initdb</code> å‡ºæ¥çš„åº“é»˜è®¤æ˜¯è‹±æ–‡çš„</li>
</ul>
<h2 id="è®¾ç½®"><a href="#è®¾ç½®" class="headerlink" title="è®¾ç½®"></a>è®¾ç½®</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ee /etc/csh.cshrc</span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span> ll	ls -lAF</span><br><span class="line"><span class="built_in">alias</span> ls	ls -FG</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">setenv LANG         zh_CN.UTF-8</span><br><span class="line">setenv LC_CTYPE     zh_CN.UTF-8</span><br><span class="line">setenv LC_ALL       zh_CN.UTF-8</span><br></pre></td></tr></table></figure>
<p><code>adduser</code> pgsql</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">su pgsql</span><br><span class="line">initdb data96 -E utf8 --locale=zh_CN.UTF-8</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼š<code>pg_upgrade -d main/ -D /var/db/postgres/data96/ -b /var/server/pgsql94/bin/ -B /usr/local/bin/ -U pgsql</code></p>
<p>è¿™æ˜¯ä¸€ä¸ªæˆåŠŸç‡ä½ã€æ“ä½œå¤æ‚ã€è¿‡ç¨‹ç¹çã€ç¯å¢ƒè¦æ±‚é«˜ çš„äº‹æƒ…ã€‚</p>
<p>å¦‚æœå‡çº§æ•°æ®åº“ï¼Œè¿˜æ˜¯<code>pg_dump</code> <code>pg_restore</code>æ¥å¾—æ–¹ä¾¿ã€‚</p>
<p>å¯¹äºå¤æ‚å…³ç³»çš„åº“ï¼Œ<code>pg_upgrade</code>ä¹Ÿä¼šå‡ºç°ä¸»é”®ä¸¢å¤±ä¹‹ç±»çš„å¥‡æ€ªäº‹æƒ…ã€‚</p>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>FreeBSD</tag>
        <tag>initdb</tag>
      </tags>
  </entry>
  <entry>
    <title>PostgreSQL SSL åŠ å¯†ä¼ è¾“é…ç½®</title>
    <url>/2019/10/26/postgresql-ssl/</url>
    <content><![CDATA[<h1 id="ç­¾åè¯ä¹¦"><a href="#ç­¾åè¯ä¹¦" class="headerlink" title="ç­¾åè¯ä¹¦"></a>ç­¾åè¯ä¹¦</h1><h2 id="å¿«é€Ÿæµ‹è¯•è¯ä¹¦"><a href="#å¿«é€Ÿæµ‹è¯•è¯ä¹¦" class="headerlink" title="å¿«é€Ÿæµ‹è¯•è¯ä¹¦"></a>å¿«é€Ÿæµ‹è¯•è¯ä¹¦</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl req -new -x509 -days 365 -nodes -text -out server.crt \</span><br><span class="line">  -keyout server.key -subj &quot;&#x2F;CN&#x3D;dbhost.yourdomain.com&quot;</span><br></pre></td></tr></table></figure>
<p>ç„¶å</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chmod og-rwx server.key</span><br></pre></td></tr></table></figure>
<h2 id="ç”Ÿäº§ç¯å¢ƒè¯ä¹¦"><a href="#ç”Ÿäº§ç¯å¢ƒè¯ä¹¦" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒè¯ä¹¦"></a>ç”Ÿäº§ç¯å¢ƒè¯ä¹¦</h2><ul>
<li>åˆ›å»ºæ ¹å¯†é’¥<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl req -new -nodes -text -out root.csr \</span><br><span class="line">  -keyout root.key -subj &quot;&#x2F;CN&#x3D;root.yourdomain.com&quot;</span><br><span class="line">chmod og-rwx root.key</span><br></pre></td></tr></table></figure></li>
<li>åˆ›å»ºæ ¹è¯ä¹¦<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl x509 -req -in root.csr -text -days 3650 \</span><br><span class="line">  -extfile &#x2F;etc&#x2F;ssl&#x2F;openssl.cnf -extensions v3_ca \</span><br><span class="line">  -signkey root.key -out root.crt</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œçš„<code>-extensions v3_ca</code>ä¸­çš„<code>v3_ca</code> æ˜¯åœ¨ <code>/etc/ssl/openssl.cnf</code>æ–‡ä»¶ä¸­çš„ä¸€ä¸ªé…ç½®ã€‚é…ç½®è¦æ±‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ v3_ca ]</span><br><span class="line">basicConstraints &#x3D; critical,CA:TRUE</span><br><span class="line">subjectKeyIdentifier &#x3D; hash</span><br><span class="line">authorityKeyIdentifier &#x3D; keyid:always,issuer:always</span><br></pre></td></tr></table></figure></blockquote>
</li>
<li>åˆ›å»ºæœåŠ¡å™¨å¯†é’¥å¹¶ç­¾å<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl req -new -nodes -text -out server.csr \</span><br><span class="line">  -keyout server.key -subj &quot;&#x2F;CN&#x3D;dbhost.yourdomain.com&quot;</span><br><span class="line">chmod og-rwx server.key</span><br><span class="line"></span><br><span class="line">openssl x509 -req -in server.csr -text -days 365 \</span><br><span class="line">  -CA root.crt -CAkey root.key -CAcreateserial \</span><br><span class="line">  -out server.crt</span><br></pre></td></tr></table></figure></li>
<li>åˆ›å»ºå®¢æˆ·ç«¯å¯†é’¥å¹¶ç­¾å<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl req -new -nodes -text -out client.csr \</span><br><span class="line">  -keyout client.key -subj &quot;&#x2F;CN&#x3D;postgres&quot;</span><br><span class="line">chmod og-rwx client.key</span><br><span class="line"></span><br><span class="line">openssl x509 -req -in client.csr -text -days 365 \</span><br><span class="line">  -CA root.crt -CAkey root.key -CAcreateserial \</span><br><span class="line">  -out client.crt</span><br></pre></td></tr></table></figure></li>
<li>ä½¿ç”¨ <code>JDBC</code> è¿æ¥æ—¶ï¼Œkeyéœ€è¦è½¬æ¢ä¸ºder<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">openssl pkcs8 -topk8 -inform PEM -in client.key -outform DER -nocrypt -out client.key.der</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>SSL</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€å¼ å›¾æå®šå„ç§SQL JOINS</title>
    <url>/2017/07/22/sql-join/</url>
    <content><![CDATA[<p><img src="https://user-images.githubusercontent.com/1764005/28487907-12e08682-6ecf-11e7-9a18-1f229476f0ae.jpg"></p>
]]></content>
      <tags>
        <tag>PostgreSQL</tag>
        <tag>SQL</tag>
        <tag>JOIN</tag>
      </tags>
  </entry>
  <entry>
    <title>swoole ç¼–è¯‘é…ç½®</title>
    <url>/2017/06/05/swoole-configure/</url>
    <content><![CDATA[<p>./configure â€“enable-sockets â€“enable-openssl â€“enable-thread â€“enable-swoole â€“enable-ringbuffer â€“with-swoole â€“enable-picohttpparser â€“with-openssl-dir=/usr/local â€“with-jemalloc-dir=/usr/local</p>
<p><a class="link"   href="https://github.com/jemalloc/jemalloc" >https://github.com/jemalloc/jemalloc<i class="fas fa-external-link-alt"></i></a></p>
<p>./configure â€“enable-autogen  â€“with-jemalloc-prefix=je_</p>
<p>make -j</p>
<p>sudo make install_bin install_include install_lib</p>
<p><a class="link"   href="https://github.com/h2o/picohttpparser" >https://github.com/h2o/picohttpparser<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>PHP</tag>
        <tag>Swoole</tag>
      </tags>
  </entry>
  <entry>
    <title>tcpdump ä½¿ç”¨æŠ€å·§</title>
    <url>/2020/02/05/tcpdump/</url>
    <content><![CDATA[<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒéHTTPåè®®çš„ç½‘ç»œåˆ†æï¼Œåœ¨æœåŠ¡å™¨ç«¯ç”¨<code>tcpdump</code>æ¯”è¾ƒå¤šï¼Œåœ¨å®¢æˆ·ç«¯ç”¨wiresharkæ¯”è¾ƒå¤šï¼Œä¸¤ä¸ªæŠ“åŒ…è½¯ä»¶çš„è¯­æ³•æ˜¯ä¸€æ ·çš„ã€‚</p>
<h2 id="ä¸€ã€åŸºæœ¬è¯­æ³•"><a href="#ä¸€ã€åŸºæœ¬è¯­æ³•" class="headerlink" title="ä¸€ã€åŸºæœ¬è¯­æ³•"></a>ä¸€ã€åŸºæœ¬è¯­æ³•</h2><h3 id="1-1ã€è¿‡æ»¤ä¸»æœº"><a href="#1-1ã€è¿‡æ»¤ä¸»æœº" class="headerlink" title="1.1ã€è¿‡æ»¤ä¸»æœº"></a>1.1ã€è¿‡æ»¤ä¸»æœº</h3><ul>
<li>æŠ“å–æ‰€æœ‰ç»è¿‡eth1ï¼Œç›®çš„æˆ–æºåœ°å€æ˜¯192.168.1.1çš„ç½‘ç»œæ•°æ®</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 host 192.168.1.1</span><br></pre></td></tr></table></figure>
<ul>
<li>æŒ‡å®šæºåœ°å€</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 src host 192.168.1.1</span><br></pre></td></tr></table></figure>
<ul>
<li>æŒ‡å®šç›®çš„åœ°å€</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 dst host 192.168.1.1</span><br></pre></td></tr></table></figure>
<h3 id="1-2ã€è¿‡æ»¤ç«¯å£"><a href="#1-2ã€è¿‡æ»¤ç«¯å£" class="headerlink" title="1.2ã€è¿‡æ»¤ç«¯å£"></a>1.2ã€è¿‡æ»¤ç«¯å£</h3><ul>
<li>æŠ“å–æ‰€æœ‰ç»è¿‡eth1ï¼Œç›®çš„æˆ–æºç«¯å£æ˜¯25çš„ç½‘ç»œæ•°æ®</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 port 25</span><br></pre></td></tr></table></figure>
<ul>
<li>æŒ‡å®šæºç«¯å£</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 src port 25</span><br></pre></td></tr></table></figure>
<ul>
<li>æŒ‡å®šç›®çš„ç«¯å£</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 dst port 25</span><br></pre></td></tr></table></figure>
<h3 id="1-3ã€ç½‘ç»œè¿‡æ»¤"><a href="#1-3ã€ç½‘ç»œè¿‡æ»¤" class="headerlink" title="1.3ã€ç½‘ç»œè¿‡æ»¤"></a>1.3ã€ç½‘ç»œè¿‡æ»¤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 net 192.168</span><br><span class="line">tcpdump -i eth1 src net 192.168</span><br><span class="line">tcpdump -i eth1 dst net 192.168</span><br></pre></td></tr></table></figure>
<h3 id="1-4ã€åè®®è¿‡æ»¤"><a href="#1-4ã€åè®®è¿‡æ»¤" class="headerlink" title="1.4ã€åè®®è¿‡æ»¤"></a>1.4ã€åè®®è¿‡æ»¤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 arp</span><br><span class="line">tcpdump -i eth1 ip</span><br><span class="line">tcpdump -i eth1 tcp</span><br><span class="line">tcpdump -i eth1 udp</span><br><span class="line">tcpdump -i eth1 icmp</span><br></pre></td></tr></table></figure>
<h3 id="1-5ã€å¸¸ç”¨è¡¨è¾¾å¼"><a href="#1-5ã€å¸¸ç”¨è¡¨è¾¾å¼" class="headerlink" title="1.5ã€å¸¸ç”¨è¡¨è¾¾å¼"></a>1.5ã€å¸¸ç”¨è¡¨è¾¾å¼</h3><pre><code>é : ! or &quot;not&quot; (å»æ‰åŒå¼•å·)  
ä¸” : &amp;&amp; or &quot;and&quot;  
æˆ– : || or &quot;or&quot;  </code></pre>
<ul>
<li>æŠ“å–æ‰€æœ‰ç»è¿‡eth1ï¼Œç›®çš„åœ°å€æ˜¯192.168.1.254æˆ–192.168.1.200ç«¯å£æ˜¯80çš„TCPæ•°æ®</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;((tcp) and (port 80) and ((dst host 192.168.1.254) or (dst host 192.168.1.200)))&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“å–æ‰€æœ‰ç»è¿‡eth1ï¼Œç›®æ ‡MACåœ°å€æ˜¯00:01:02:03:04:05çš„ICMPæ•°æ®</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;((icmp) and ((ether dst host 00:01:02:03:04:05)))&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“å–æ‰€æœ‰ç»è¿‡eth1ï¼Œç›®çš„ç½‘ç»œæ˜¯192.168ï¼Œä½†ç›®çš„ä¸»æœºä¸æ˜¯192.168.1.200çš„TCPæ•°æ®</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;((tcp) and ((dst net 192.168) and (not dst host 192.168.1.200)))&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="äºŒã€é«˜çº§åŒ…å¤´è¿‡æ»¤"><a href="#äºŒã€é«˜çº§åŒ…å¤´è¿‡æ»¤" class="headerlink" title="äºŒã€é«˜çº§åŒ…å¤´è¿‡æ»¤"></a>äºŒã€é«˜çº§åŒ…å¤´è¿‡æ»¤</h2><p>é¦–å…ˆäº†è§£å¦‚ä½•ä»åŒ…å¤´è¿‡æ»¤ä¿¡æ¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">proto[x:y]          : è¿‡æ»¤ä»xå­—èŠ‚å¼€å§‹çš„yå­—èŠ‚æ•°ã€‚æ¯”å¦‚ip[2:2]è¿‡æ»¤å‡º3ã€4å­—èŠ‚ï¼ˆç¬¬ä¸€å­—èŠ‚ä»0å¼€å§‹æ’ï¼‰</span><br><span class="line">proto[x:y] &amp; z &#x3D; 0  : proto[x:y]å’Œzçš„ä¸æ“ä½œä¸º0</span><br><span class="line">proto[x:y] &amp; z !&#x3D;0  : proto[x:y]å’Œzçš„ä¸æ“ä½œä¸ä¸º0</span><br><span class="line">proto[x:y] &amp; z &#x3D; z  : proto[x:y]å’Œzçš„ä¸æ“ä½œä¸ºz</span><br><span class="line">proto[x:y] &#x3D; z      : proto[x:y]ç­‰äºz</span><br></pre></td></tr></table></figure>
<p>æ“ä½œç¬¦ : &gt;, &lt;, &gt;=, &lt;=, =, !=</p>
<h3 id="2-1ã€IPå¤´"><a href="#2-1ã€IPå¤´" class="headerlink" title="2.1ã€IPå¤´"></a>2.1ã€IPå¤´</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0                   1                   2                   3</span><br><span class="line">0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|Version|  IHL  |Type of Service|          Total Length         |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|         Identification        |Flags|      Fragment Offset    |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|  Time to Live |    Protocol   |         Header Checksum       |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                       Source Address                          |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                    Destination Address                        |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                    Options                    |    Padding    | &lt;-- optional</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                            DATA ...                           |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure>
<p>æœ¬æ–‡åªé’ˆå¯¹IPv4ã€‚</p>
<h3 id="2-2ã€Flags"><a href="#2-2ã€Flags" class="headerlink" title="2.2ã€Flags"></a>2.2ã€Flags</h3><table>
<thead>
<tr>
<th align="left">TCP Flag</th>
<th align="left">tcpdump Flag</th>
<th align="left">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SYN</td>
<td align="left">S</td>
<td align="left">Synæ•°æ®åŒ…ï¼Œä¼šè¯å»ºç«‹è¯·æ±‚ã€‚</td>
</tr>
<tr>
<td align="left">ACK</td>
<td align="left">A</td>
<td align="left">Ackæ•°æ®åŒ…ï¼Œç¡®è®¤å‘é€ç«¯çš„æ•°æ®ã€‚</td>
</tr>
<tr>
<td align="left">FIN</td>
<td align="left">F</td>
<td align="left">ç»“æŸæ ‡è®°ï¼Œç»ˆæ­¢æŒ‡ç¤ºã€‚</td>
</tr>
<tr>
<td align="left">RESET</td>
<td align="left">R</td>
<td align="left">é‡ç½®ï¼ŒæŒ‡ç¤ºç«‹å³ç»ˆæ­¢è¿æ¥ã€‚</td>
</tr>
<tr>
<td align="left">PUSH</td>
<td align="left">P</td>
<td align="left">æ¨é€ï¼Œç«‹å³å°†ç¼“å­˜ä¸­çš„æ•°æ®å‘å®Œã€‚</td>
</tr>
<tr>
<td align="left">URGENT</td>
<td align="left">U</td>
<td align="left">ç´§æ€¥ï¼Œä¼˜å…ˆäºå…¶ä»–æ•°æ®ã€‚</td>
</tr>
<tr>
<td align="left">NONE</td>
<td align="left">.</td>
<td align="left">å ä½ç¬¦ï¼Œé€šå¸¸ç”¨äºACKã€‚</td>
</tr>
</tbody></table>
<h3 id="2-3ã€IPé€‰é¡¹è®¾ç½®äº†å—ï¼Ÿ"><a href="#2-3ã€IPé€‰é¡¹è®¾ç½®äº†å—ï¼Ÿ" class="headerlink" title="2.3ã€IPé€‰é¡¹è®¾ç½®äº†å—ï¼Ÿ"></a>2.3ã€IPé€‰é¡¹è®¾ç½®äº†å—ï¼Ÿ</h3><p>â€œä¸€èˆ¬â€çš„IPå¤´æ˜¯20å­—èŠ‚ï¼Œä½†IPå¤´æœ‰é€‰é¡¹è®¾ç½®ï¼Œä¸èƒ½ç›´æ¥ä»åç§»21å­—èŠ‚å¤„è¯»å–æ•°æ®ã€‚IPå¤´æœ‰ä¸ªé•¿åº¦å­—æ®µå¯ä»¥çŸ¥é“å¤´é•¿åº¦æ˜¯å¦å¤§äº20å­—èŠ‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+-+-+-+-+-+-+-+-+</span><br><span class="line">|Version|  IHL  |</span><br><span class="line">+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure>
<p>é€šå¸¸ç¬¬ä¸€ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶å€¼æ˜¯ï¼š01000101ï¼Œåˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<p>0100 = 4 è¡¨ç¤ºIPç‰ˆæœ¬<br>0101 = 5 è¡¨ç¤ºIPå¤´32 bitçš„å—æ•°ï¼Œ5 x 32 bits = 160 bits or 20 bytes</p>
<p>å¦‚æœç¬¬ä¸€å­—èŠ‚ç¬¬äºŒéƒ¨åˆ†çš„å€¼å¤§äº5ï¼Œé‚£ä¹ˆè¡¨ç¤ºå¤´æœ‰IPé€‰é¡¹ã€‚</p>
<p>ä¸‹é¢ä»‹ç»ä¸¤ç§è¿‡æ»¤æ–¹æ³•ï¼ˆç¬¬ä¸€ç§æ–¹æ³•æ¯”è¾ƒæ“è›‹ï¼Œå¯å¿½ç•¥ï¼‰ï¼š</p>
<p>a. æ¯”è¾ƒç¬¬ä¸€å­—èŠ‚çš„å€¼æ˜¯å¦å¤§äº01000101ï¼Œè¿™å¯ä»¥åˆ¤æ–­IPv4å¸¦IPé€‰é¡¹çš„æ•°æ®å’ŒIPv6çš„æ•°æ®ã€‚</p>
<p>01000101åè¿›åˆ¶ç­‰äº69ï¼Œè®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼ˆå°æç¤ºï¼šç”¨è®¡ç®—å™¨æ›´æ–¹ä¾¿ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0 : 0  \</span><br><span class="line">1 : 2^6 &#x3D; 64 \ ç¬¬ä¸€éƒ¨åˆ† (IPç‰ˆæœ¬)</span><br><span class="line">0 : 0   &#x2F;</span><br><span class="line">0 : 0  &#x2F;</span><br><span class="line">-</span><br><span class="line">0 : 0  \</span><br><span class="line">1 : 2^2 &#x3D; 4  \ ç¬¬äºŒéƒ¨åˆ† (å¤´é•¿åº¦)</span><br><span class="line">0 : 0   &#x2F;</span><br><span class="line">1 : 2^0 &#x3D; 1 &#x2F;</span><br></pre></td></tr></table></figure>
<p>64 + 4 + 1 = 69</p>
<p>å¦‚æœè®¾ç½®äº†IPé€‰é¡¹ï¼Œé‚£ä¹ˆç¬¬ä¸€è‡ªå·±æ˜¯01000110ï¼ˆåè¿›åˆ¶70ï¼‰ï¼Œè¿‡æ»¤è§„åˆ™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;ip[0] &gt; 69&#x27;</span></span><br></pre></td></tr></table></figure>
<p>IPv6çš„æ•°æ®ä¹Ÿä¼šåŒ¹é…ï¼Œçœ‹çœ‹ç¬¬äºŒç§æ–¹æ³•ã€‚</p>
<p>b. ä½æ“ä½œ</p>
<p>0100 0101 : ç¬¬ä¸€å­—èŠ‚çš„äºŒè¿›åˆ¶<br>0000 1111 : ä¸æ“ä½œ<br>&lt;=========<br>0000 0101 : ç»“æœ  </p>
<p>æ­£ç¡®çš„è¿‡æ»¤æ–¹æ³•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;ip[0] &amp; 15 &gt; 5&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;ip[0] &amp; 0x0f &gt; 5&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-4ã€åˆ†ç‰‡æ ‡è®°"><a href="#2-4ã€åˆ†ç‰‡æ ‡è®°" class="headerlink" title="2.4ã€åˆ†ç‰‡æ ‡è®°"></a>2.4ã€åˆ†ç‰‡æ ‡è®°</h3><p>å½“å‘é€ç«¯çš„MTUå¤§äºåˆ°ç›®çš„è·¯å¾„é“¾è·¯ä¸Šçš„MTUæ—¶å°±ä¼šè¢«åˆ†ç‰‡ï¼Œè¿™æ®µè¯æœ‰ç‚¹æ‹—å£ï¼Œæƒå¨çš„è¯·å‚è€ƒã€ŠTCP/IPè¯¦è§£ã€‹ã€‚å”‰ï¼Œ32å€Ÿæˆ‘çš„ä¹¦æ²¡è¿˜ï¼Œåªèƒ½å‡‘åˆå†™ï¼Œå¤§å®¶è®°å¾—çœ‹ä¹¦å•Šã€‚</p>
<p>åˆ†ç‰‡ä¿¡æ¯åœ¨IPå¤´çš„ç¬¬ä¸ƒå’Œç¬¬å…«å­—èŠ‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|Flags|      Fragment Offset    |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure>
<p>Bit 0:  ä¿ç•™ï¼Œå¿…é¡»æ˜¯0<br>Bit 1:  (DF) 0 = å¯èƒ½åˆ†ç‰‡, 1 = ä¸åˆ†ç‰‡<br>Bit 2:  (MF) 0 = æœ€åçš„åˆ†ç‰‡, 1 = è¿˜æœ‰åˆ†ç‰‡  </p>
<p>Fragment Offsetå­—æ®µåªæœ‰åœ¨åˆ†ç‰‡çš„æ—¶å€™æ‰ä½¿ç”¨ã€‚</p>
<p>è¦æŠ“å¸¦DFä½æ ‡è®°çš„ä¸åˆ†ç‰‡çš„åŒ…ï¼Œç¬¬ä¸ƒå­—èŠ‚çš„å€¼åº”è¯¥æ˜¯ï¼š</p>
<p>01000000 = 64</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;ip[6] = 64&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-5ã€æŠ“åˆ†ç‰‡åŒ…"><a href="#2-5ã€æŠ“åˆ†ç‰‡åŒ…" class="headerlink" title="2.5ã€æŠ“åˆ†ç‰‡åŒ…"></a>2.5ã€æŠ“åˆ†ç‰‡åŒ…</h3><ul>
<li>åŒ¹é…MFï¼Œåˆ†ç‰‡åŒ…</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;ip[6] = 32&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æœ€ååˆ†ç‰‡åŒ…çš„å¼€å§‹3ä½æ˜¯0ï¼Œä½†æ˜¯æœ‰Fragment Offsetå­—æ®µã€‚</p>
<ul>
<li>åŒ¹é…åˆ†ç‰‡å’Œæœ€ååˆ†ç‰‡</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;((ip[6:2] &gt; 0) and (not ip[6] = 64))&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•åˆ†ç‰‡å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ping -M want -s 3000 192.168.1.1</span><br></pre></td></tr></table></figure>
<h3 id="2-6ã€åŒ¹é…å°TTL"><a href="#2-6ã€åŒ¹é…å°TTL" class="headerlink" title="2.6ã€åŒ¹é…å°TTL"></a>2.6ã€åŒ¹é…å°TTL</h3><p>TTLå­—æ®µåœ¨ç¬¬ä¹å­—èŠ‚ï¼Œå¹¶ä¸”æ­£å¥½æ˜¯å®Œæ•´çš„ä¸€ä¸ªå­—èŠ‚ï¼ŒTTLæœ€å¤§å€¼æ˜¯255ï¼ŒäºŒè¿›åˆ¶ä¸º11111111ã€‚</p>
<p>å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤éªŒè¯ä¸€ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ping -M want -s 3000 -t 256 192.168.1.200</span><br><span class="line">ping: ttl 256 out of range</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+-+-+-+-+-+-+-+-+</span><br><span class="line">|  Time to Live |</span><br><span class="line">+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨ç½‘å…³å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤çœ‹çœ‹ç½‘ç»œä¸­è°åœ¨ä½¿ç”¨traceroute</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;ip[8] &lt; 5&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-7ã€æŠ“å¤§äºXå­—èŠ‚çš„åŒ…"><a href="#2-7ã€æŠ“å¤§äºXå­—èŠ‚çš„åŒ…" class="headerlink" title="2.7ã€æŠ“å¤§äºXå­—èŠ‚çš„åŒ…"></a>2.7ã€æŠ“å¤§äºXå­—èŠ‚çš„åŒ…</h3><ul>
<li>å¤§äº600å­—èŠ‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;ip[2:2] &gt; 600&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-8ã€æ›´å¤šçš„IPè¿‡æ»¤"><a href="#2-8ã€æ›´å¤šçš„IPè¿‡æ»¤" class="headerlink" title="2.8ã€æ›´å¤šçš„IPè¿‡æ»¤"></a>2.8ã€æ›´å¤šçš„IPè¿‡æ»¤</h3><p>é¦–å…ˆè¿˜æ˜¯éœ€è¦çŸ¥é“TCPåŸºæœ¬ç»“æ„ï¼Œå†æ¬¡æ¨èã€ŠTCP/IPè¯¦è§£ã€‹ï¼Œå·ä¸€å°±å¤Ÿçœ‹çš„äº†ï¼Œé¿å…èµ°ç«å…¥é­”ã€‚</p>
<ul>
<li>TCPå¤´</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0                   1                   2                   3</span><br><span class="line">0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|          Source Port          |       Destination Port        |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                        Sequence Number                        |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                    Acknowledgment Number                      |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|  Data |       |C|E|U|A|P|R|S|F|                               |</span><br><span class="line">| Offset|  Res. |W|C|R|C|S|S|Y|I|            Window             |</span><br><span class="line">|       |       |R|E|G|K|H|T|N|N|                               |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|           Checksum            |         Urgent Pointer        |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                    Options                    |    Padding    |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                             data                              |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“å–æºç«¯å£å¤§äº1024çš„TCPæ•°æ®åŒ…</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[0:2] &gt; 1024&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>åŒ¹é…TCPæ•°æ®åŒ…çš„ç‰¹æ®Šæ ‡è®°</li>
</ul>
<p>TCPæ ‡è®°å®šä¹‰åœ¨TCPå¤´çš„ç¬¬åå››ä¸ªå­—èŠ‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+-+-+-+-+-+-+-+-+</span><br><span class="line">|C|E|U|A|P|R|S|F|</span><br><span class="line">|W|C|R|C|S|S|Y|I|</span><br><span class="line">|R|E|G|K|H|T|N|N|</span><br><span class="line">+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure>
<p>é‡å¤ä¸€ä¸‹TCPä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤ä¸ªä¸»æœºæ˜¯å¦‚ä½•å‹¾æ­çš„ï¼š</p>
<ol>
<li>æºå‘é€SYN</li>
<li>ç›®æ ‡å›ç­”SYN, ACK</li>
<li>æºå‘é€ACK</li>
</ol>
<p>æ²¡å¥³æœ‹å‹çš„ç«¥é‹è¦å­¦ä¹ ä¸€ä¸‹ï¼š  </p>
<ol>
<li>MMï¼Œä½ çš„æ‰‹æœ‰ç©ºå—ï¼Ÿ-_-  </li>
<li>æœ‰ç©ºï¼Œä½ å‘¢ï¼Ÿ~_~  </li>
<li>æˆ‘ä¹Ÿæœ‰ç©º *_*  </li>
</ol>
<p>å¤±è´¥çš„loseræ˜¯é…±ç´«çš„ï¼š  </p>
<ol>
<li>MMï¼Œè¿™æ˜¯ä½ æ‰çš„æ¿ç –å—ï¼Ÿ(SYN) ï¿£â–½ï¿£  </li>
<li>ä¸æ˜¯ï¼Œæ‰¾æ‹å•Šï¼Ÿ(RST-ACK) Ë‹ï¹ËŠ  </li>
</ol>
<ul>
<li>åªæŠ“SYNåŒ…ï¼Œç¬¬åå››å­—èŠ‚æ˜¯äºŒè¿›åˆ¶çš„00000010ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„2</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[13] = 2&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“SYN, ACK ï¼ˆ00010010 or 18ï¼‰</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[13] = 18&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“SYNæˆ–è€…SYN-ACK</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[13] &amp; 2 = 2&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç”¨åˆ°äº†ä½æ“ä½œï¼Œå°±æ˜¯ä¸ç®¡ACKä½æ˜¯å•¥ã€‚</p>
<ul>
<li>æŠ“PSH-ACK</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[13] = 24&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“æ‰€æœ‰åŒ…å«FINæ ‡è®°çš„åŒ…ï¼ˆFINé€šå¸¸å’ŒACKä¸€èµ·ï¼Œè¡¨ç¤ºå¹½ä¼šå®Œäº†ï¼Œå›è§ï¼‰</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[13] &amp; 1 = 1&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“RSTï¼ˆå‹¾æ­æ²¡æˆåŠŸï¼Œä¼Ÿå¤§çš„greatwallå¯¹å¥¹è®¤ä¸ºæœ‰æ•æ„Ÿä¿¡æ¯çš„è¿æ¥å‘RSTåŒ…ï¼Œå…¸å‹çš„æ£’æ‰“é¸³é¸¯ï¼‰</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[13] &amp; 4 = 4&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ä¸‹å›¾è¯¦ç»†æè¿°äº†TCPå„ç§çŠ¶æ€çš„æ ‡è®°ï¼Œæ–¹ä¾¿åˆ†æã€‚</p>
<p><img src="https://raw.githubusercontent.com/linuxwiki/SourceWiki/master/images/tcp_state_machine.jpg" alt="tcp_state_machine.jpg"></p>
<h3 id="2-9ã€å¤§å”æ³¨"><a href="#2-9ã€å¤§å”æ³¨" class="headerlink" title="2.9ã€å¤§å”æ³¨"></a>2.9ã€å¤§å”æ³¨</h3><p>tcpdumpè€ƒè™‘äº†ä¸€äº›æ•°å­—ææƒ§ç—‡è€…çš„éœ€æ±‚ï¼Œæä¾›äº†éƒ¨åˆ†å¸¸ç”¨çš„å­—æ®µåç§»åå­—ï¼š</p>
<p>icmptype  (ICMPç±»å‹å­—æ®µ)<br>icmpcode  (ICMPç¬¦å·å­—æ®µ)<br>tcpflags  (TCPæ ‡è®°å­—æ®µ)  </p>
<p>ICMPç±»å‹å€¼æœ‰ï¼š</p>
<p>icmp-echoreply, icmp-unreach, icmp-sourcequench, icmp-redirect, icmp-echo, icmp-routeradvert, icmp-routersolicit, icmp-timxceed, icmp-paramprob, icmp-tstamp, icmp-tstampreply, icmp-ireq, icmp-ireqreply, icmp-maskreq, icmp-maskreply</p>
<p>TCPæ ‡è®°å€¼ï¼š</p>
<p>tcp-fin, tcp-syn, tcp-rst, tcp-push, tcp-push, tcp-ack, tcp-urg</p>
<p>è¿™æ ·ä¸Šé¢æŒ‰ç…§TCPæ ‡è®°ä½æŠ“åŒ…çš„å°±å¯ä»¥å†™ç›´è§‚çš„è¡¨è¾¾å¼äº†ï¼š</p>
<ul>
<li>åªæŠ“SYNåŒ…</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[tcpflags] = tcp-syn&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“SYN, ACK</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[tcpflags] &amp; tcp-syn != 0 and tcp[tcpflags] &amp; tcp-ack != 0&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-10ã€æŠ“SMTPæ•°æ®"><a href="#2-10ã€æŠ“SMTPæ•°æ®" class="headerlink" title="2.10ã€æŠ“SMTPæ•°æ®"></a>2.10ã€æŠ“SMTPæ•°æ®</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;((port 25) and (tcp[(tcp[12]&gt;&gt;2):4] = 0x4d41494c))&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æŠ“å–æ•°æ®åŒºå¼€å§‹ä¸ºâ€MAILâ€çš„åŒ…ï¼Œâ€MAILâ€çš„åå…­è¿›åˆ¶ä¸º0x4d41494cã€‚</p>
<h3 id="2-11ã€æŠ“HTTP-GETæ•°æ®"><a href="#2-11ã€æŠ“HTTP-GETæ•°æ®" class="headerlink" title="2.11ã€æŠ“HTTP GETæ•°æ®"></a>2.11ã€æŠ“HTTP GETæ•°æ®</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[(tcp[12]&gt;&gt;2):4] = 0x47455420&#x27;</span></span><br></pre></td></tr></table></figure>
<p>â€œGET â€œçš„åå…­è¿›åˆ¶æ˜¯47455420</p>
<h3 id="2-12ã€æŠ“SSHè¿”å›"><a href="#2-12ã€æŠ“SSHè¿”å›" class="headerlink" title="2.12ã€æŠ“SSHè¿”å›"></a>2.12ã€æŠ“SSHè¿”å›</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;tcp[(tcp[12]&gt;&gt;2):4] = 0x5353482D&#x27;</span></span><br></pre></td></tr></table></figure>
<p>â€œSSH-â€œçš„åå…­è¿›åˆ¶æ˜¯0x5353482D</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 <span class="string">&#x27;(tcp[(tcp[12]&gt;&gt;2):4] = 0x5353482D) and (tcp[((tcp[12]&gt;&gt;2)+4):2] = 0x312E)&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æŠ“è€ç‰ˆæœ¬çš„SSHè¿”å›ä¿¡æ¯ï¼Œå¦‚â€SSH-1.99..â€</p>
<h2 id="ä¸‰ã€å¤§å”æ³¨"><a href="#ä¸‰ã€å¤§å”æ³¨" class="headerlink" title="ä¸‰ã€å¤§å”æ³¨"></a>ä¸‰ã€å¤§å”æ³¨</h2><p>å¦‚æœæ˜¯ä¸ºäº†æŸ¥çœ‹æ•°æ®å†…å®¹ï¼Œå»ºè®®ç”¨<code>tcpdump -s 0 -w filename</code>æŠŠæ•°æ®åŒ…éƒ½ä¿å­˜ä¸‹æ¥ï¼Œç„¶åç”¨wiresharkçš„Follow TCP Stream/Follow UDP Streamæ¥æŸ¥çœ‹æ•´ä¸ªä¼šè¯çš„å†…å®¹ã€‚</p>
<p><code>-s 0</code>æ˜¯æŠ“å–å®Œæ•´æ•°æ®åŒ…ï¼Œå¦åˆ™é»˜è®¤åªæŠ“68å­—èŠ‚ã€‚</p>
<p>å¦å¤–ï¼Œç”¨tcpflowä¹Ÿå¯ä»¥æ–¹ä¾¿çš„è·å–TCPä¼šè¯å†…å®¹ï¼Œæ”¯æŒtcpdumpçš„å„ç§è¡¨è¾¾å¼ã€‚</p>
<h3 id="3-1ã€UDPå¤´"><a href="#3-1ã€UDPå¤´" class="headerlink" title="3.1ã€UDPå¤´"></a>3.1ã€UDPå¤´</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> 0      7 8     15 16    23 24    31</span><br><span class="line">+--------+--------+--------+--------+</span><br><span class="line">|     Source      |   Destination   |</span><br><span class="line">|      Port       |      Port       |</span><br><span class="line">+--------+--------+--------+--------+</span><br><span class="line">|                 |                 |</span><br><span class="line">|     Length      |    Checksum     |</span><br><span class="line">+--------+--------+--------+--------+</span><br><span class="line">|                                   |</span><br><span class="line">|              DATA ...             |</span><br><span class="line">+-----------------------------------+</span><br></pre></td></tr></table></figure>
<ul>
<li>æŠ“DNSè¯·æ±‚æ•°æ®</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tcpdump -i eth1 udp dst port 53</span><br></pre></td></tr></table></figure>
<h3 id="3-2ã€å…¶ä»–"><a href="#3-2ã€å…¶ä»–" class="headerlink" title="3.2ã€å…¶ä»–"></a>3.2ã€å…¶ä»–</h3><p><code>-c</code>å‚æ•°å¯¹äºè¿ç»´äººå‘˜æ¥è¯´ä¹Ÿæ¯”è¾ƒå¸¸ç”¨ï¼Œå› ä¸ºæµé‡æ¯”è¾ƒå¤§çš„æœåŠ¡å™¨ï¼Œé äººå·¥CTRL+Cè¿˜æ˜¯æŠ“çš„å¤ªå¤šï¼Œç”šè‡³å¯¼è‡´æœåŠ¡å™¨å®•æœºï¼Œäºæ˜¯å¯ä»¥ç”¨<code>-c</code>å‚æ•°æŒ‡å®šæŠ“å¤šå°‘ä¸ªåŒ…ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">time tcpdump -nn -i eth0 <span class="string">&#x27;tcp[tcpflags] = tcp-syn&#x27;</span> -c 10000 &gt; /dev/null</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„å‘½ä»¤è®¡ç®—æŠ“10000ä¸ªSYNåŒ…èŠ±è´¹å¤šå°‘æ—¶é—´ï¼Œå¯ä»¥åˆ¤æ–­è®¿é—®é‡å¤§æ¦‚æ˜¯å¤šå°‘ã€‚</p>
<h2 id="å››ã€å‚è€ƒèµ„æ–™"><a href="#å››ã€å‚è€ƒèµ„æ–™" class="headerlink" title="å››ã€å‚è€ƒèµ„æ–™"></a>å››ã€å‚è€ƒèµ„æ–™</h2><blockquote>
<p><a class="link"   href="http://www.wains.be/pub/networking/tcpdump_advanced_filters.txt" >tcpdump advanced filters<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
]]></content>
      <tags>
        <tag>net</tag>
      </tags>
  </entry>
  <entry>
    <title>è…¾è®¯ä¸åä¸ºåˆ°ä½è°æ›´èµšé’±</title>
    <url>/2019/07/30/tencent-vs-huwwei-2019/</url>
    <content><![CDATA[<p>ä»Šå¤©åä¸ºå‘å¸ƒ2019å¹´ä¸ŠåŠå¹´ä¸šç»©ï¼Œæ”¶å…¥åŒæ¯”å¢é•¿23.2%ï¼é‚£ä¹ˆåä¸ºä»Šå¹´ä¸ŠåŠå¹´å–äº†å¤šå°‘é’±å‘¢ï¼Ÿ</p>
<p><strong>4013äº¿äººæ°‘å¸/6ä¸ªæœˆ</strong></p>
<p>è…¾è®¯2019å¹´5æœˆ15æ—¥å…¬å¸ƒçš„ä¸€å­£åº¦è´¢æŠ¥æ˜¾ç¤ºï¼Œè…¾è®¯å–äº†854.65äº¿ã€‚äºŒå­£åº¦è¿˜æ²¡å‡ºæ¥ï¼Œä¸”ç®€å•åšx2æ¨ç®—å§ã€‚</p>
<p><strong>1708äº¿äººæ°‘å¸/6ä¸ªæœˆ</strong></p>
<p>è…¾è®¯ä¸€è½¯ä»¶æœåŠ¡å…¬å¸ï¼Œæ”¶é’±çš„èƒ½åŠ›è¿å–è´§çš„åä¸ºä¸€åŠéƒ½ä¸åˆ°ã€‚ä¸è¿‡å¾—æ·±æŒ–ä¸€ä¸‹ã€‚</p>
<pre class="mermaid">pie title è¥æ”¶
  "åä¸º" : 4013
  "è…¾è®¯" : 1708</pre>


<h2 id="åä¸º"><a href="#åä¸º" class="headerlink" title="åä¸º"></a>åä¸º</h2><blockquote>
<p>[ä¸­å›½ï¼Œæ·±åœ³ï¼Œ2019å¹´7æœˆ30æ—¥] 2019å¹´ä¸ŠåŠå¹´ï¼Œåä¸ºå®ç°é”€å”®æ”¶å…¥4013äº¿äººæ°‘å¸ï¼Œ<br>åŒæ¯”å¢é•¿23.2%ï¼Œ<u>å‡€åˆ©æ¶¦ç‡8.7%</u>ã€‚<a class="link"   href="https://www.huawei.com/cn/press-events/news/2019/7/huawei-announces-h1-2019-revenue" >æºè‡ªï¼šå®˜æ–¹æ–°é—»<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p>åä¸ºå‡€åˆ©æ¶¦ï¼š4013 x 0.087 / 6 = <strong>58.1äº¿/æœˆ</strong></p>
<h2 id="è…¾è®¯"><a href="#è…¾è®¯" class="headerlink" title="è…¾è®¯"></a>è…¾è®¯</h2><blockquote>
<p>æœŸå†…ç›ˆåˆ©ä¸ºäººæ°‘å¸ 278.56 äº¿å…ƒï¼ˆ41.37 äº¿ç¾å…ƒï¼‰ï¼Œæ¯”å»å¹´åŒæœŸå¢é•¿ 16%ï¼›<u>å‡€åˆ©æ¶¦ç‡ä¸å»å¹´åŒæœŸæŒå¹³ï¼Œä¸º<br>  33%</u>ã€‚<a class="link"   href="http://www.tencent.com/zh-cn/articles/15000771557911821.pdf" >æºè‡ªï¼šå®˜æ–¹è´¢æŠ¥<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p>è…¾è®¯å‡€åˆ©æ¶¦ï¼š854.65 x 0.33 / 3 = <strong>94äº¿/æœˆ</strong></p>
<pre class="mermaid">pie title å‡€åˆ©æ¶¦
  "åä¸º" : 58.1
  "è…¾è®¯" : 94</pre>

<h3 id="è¿˜æ˜¯æè½¯ä»¶æœåŠ¡æ›´èµšé’±å•Šï¼ï½ï½ï½"><a href="#è¿˜æ˜¯æè½¯ä»¶æœåŠ¡æ›´èµšé’±å•Šï¼ï½ï½ï½" class="headerlink" title="è¿˜æ˜¯æè½¯ä»¶æœåŠ¡æ›´èµšé’±å•Šï¼ï½ï½ï½"></a>è¿˜æ˜¯æè½¯ä»¶æœåŠ¡æ›´èµšé’±å•Šï¼ï½ï½ï½</h3>]]></content>
      <tags>
        <tag>è´¢æŠ¥è§£è¯»</tag>
      </tags>
  </entry>
  <entry>
    <title>truss lsof strace ltrace è®©ä½ çŸ¥é“ç³»ç»Ÿè¿è¡Œä¸­çš„è¿›ç¨‹æ­£åœ¨å¹²ä»€ä¹ˆ</title>
    <url>/2017/06/12/truss-lsof-strace-ltrace/</url>
    <content><![CDATA[<p>#truss<br>è¿™ä¸ªå‘½ä»¤ä¸€èˆ¬UNIXå¹³å°è‡ªå¸¦ã€‚ä½¿ç”¨ä¸¾ä¾‹ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">[bluse@ybcz ~/vhosts/bluse]$ sudo truss -p48932</span><br><span class="line">clock_gettime(4,&#123;334689.597960013 &#125;)		 = 0 (0x0)</span><br><span class="line">clock_gettime(4,&#123;334689.598165067 &#125;)		 = 0 (0x0)</span><br><span class="line">clock_gettime(4,&#123;334689.598310337 &#125;)		 = 0 (0x0)</span><br><span class="line">gettimeofday(&#123;1480832080.977889 &#125;,0x0)		 = 0 (0x0)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,54) = 54 (0x36)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,52) = 52 (0x34)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,56) = 56 (0x38)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,55) = 55 (0x37)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,50) = 50 (0x32)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,55) = 55 (0x37)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,54) = 54 (0x36)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,47) = 47 (0x2f)</span><br><span class="line">clock_gettime(4,&#123;334689.600967100 &#125;)		 = 0 (0x0)</span><br><span class="line">gettimeofday(&#123;1480832080.980523 &#125;,0x0)		 = 0 (0x0)</span><br><span class="line">gettimeofday(&#123;1480832080.980791 &#125;,0x0)		 = 0 (0x0)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,52) = 52 (0x34)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,50) = 50 (0x32)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,49) = 49 (0x31)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,46) = 46 (0x2e)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,45) = 45 (0x2d)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,49) = 49 (0x31)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,46) = 46 (0x2e)</span><br><span class="line">write(14,&quot;*3\r\n$4\r\nhget\r\n$14\r\nstate&quot;...,46) = 46 (0x2e)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å®æ—¶æŸ¥çœ‹ã€‚ä¹Ÿå¯ä»¥ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">truss -p 48932 -o out.truss</span><br></pre></td></tr></table></figure>
<p>æŠŠç»“æœè¾“å‡ºè‡³æ–‡ä»¶ä¸­ã€‚æ•è·ä¸€æ–­æ—¶é—´åå†ç»†åˆ†æã€‚</p>
<p>è¿™ä¸ªå‘½ä»¤èƒ½è®©ä½ å¾ˆæ–¹ä¾¿åœ°çœ‹æ¸…å¼‚å¸¸ä½ç½®ã€‚å¦‚ï¼šæ­»å¾ªç¯ã€æŸäº›æœªå†™å…¥æ—¥å¿—çš„å¼‚å¸¸ç­‰ã€‚</p>
<p>å¾ˆé€‚åˆç”¨æ¥è§£å†³CPUå ç”¨è¿‡é«˜ã€éš¾å®šä½çš„å¼‚å¸¸ã€éš¾é‡ç°çš„å¼‚å¸¸ç­‰ ã€‚</p>
<p>#lsof<br>è¿™ä¸ªlinux/unixéƒ½å¥½ä½¿ã€‚å®ƒæœ‰ä¸¤ä¸ªæ–¹é¢å¥½ä½¿ã€‚</p>
<ul>
<li>æŒ‰ç«¯å£æŸ¥è¿æ¥<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">bluse@bluse-Inspiron-1427:~/www/vhost$ lsof -i:80</span><br><span class="line">COMMAND    PID  USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">cairo-doc 3059 bluse   24u  IPv4  95707      0t0  TCP 192.168.1.102:40728-&gt;ec2-35-162-44-96.us-west-2.compute.amazonaws.com:http (ESTABLISHED)</span><br><span class="line">xmradio   3425 bluse   13u  IPv4  96506      0t0  TCP 192.168.1.102:48640-&gt;202.108.249.250:http (ESTABLISHED)</span><br><span class="line">xmradio   3425 bluse   14u  IPv4  90643      0t0  TCP 192.168.1.102:57590-&gt;140.205.220.98:http (CLOSE_WAIT)</span><br><span class="line">gvfsd-htt 3450 bluse   10u  IPv4  95783      0t0  TCP 192.168.1.102:55522-&gt;123.125.7.240:http (ESTABLISHED)</span><br><span class="line">chrome    3967 bluse  162u  IPv4  95526      0t0  TCP 192.168.1.102:58632-&gt;128.199.228.91:http (ESTABLISHED)</span><br><span class="line">chrome    3967 bluse  202u  IPv4  95527      0t0  TCP 192.168.1.102:58634-&gt;128.199.228.91:http (ESTABLISHED)</span><br><span class="line">chrome    3967 bluse  228u  IPv4  91831      0t0  TCP 192.168.1.102:58714-&gt;151.101.52.249:http (ESTABLISHED)</span><br></pre></td></tr></table></figure></li>
<li>æŒ‰è¿›ç¨‹PIDæŸ¥æ–‡ä»¶è°ƒç”¨<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">bluse@bluse-Inspiron-1427:~/www/vhost$ lsof -p 3425</span><br><span class="line">COMMAND  PID  USER   FD      TYPE             DEVICE SIZE/OFF     NODE NAME</span><br><span class="line">xmradio 3425 bluse  cwd       DIR                8,1     4096   262146 /home/bluse</span><br><span class="line">xmradio 3425 bluse  rtd       DIR                8,1     4096        2 /</span><br><span class="line">xmradio 3425 bluse  txt       REG                8,1    14664 21375342 /usr/bin/xmradio</span><br><span class="line">xmradio 3425 bluse  mem       REG               0,19 67108904       15 /dev/shm/pulse-shm-1137957205</span><br><span class="line">xmradio 3425 bluse  mem       REG                8,1    10256 21435409 /usr/lib/vlc/plugins/audio_filter/libtrivial_channel_mixer_plugin.so</span><br><span class="line">xmradio 3425 bluse  mem       REG                8,1    34920 21435412 /usr/lib/vlc/plugins/audio_filter/libaudio_format_plugin.so</span><br><span class="line">xmradio 3425 bluse  mem       REG                8,1    10272 21435429 /usr/lib/vlc/plugins/audio_filter/libugly_resampler_plugin.so</span><br><span class="line">xmradio 3425 bluse  mem       REG                8,1    10280 21435410 /usr/lib/vlc/plugins/audio_filter/libdolby_surround_decoder_plugin.so</span><br><span class="line">xmradio 3425 bluse  mem       REG                8,1    10320 21435419 /usr/lib/vlc/plugins/audio_filter/libdtstospdif_plugin.so</span><br><span class="line">xmradio 3425 bluse  mem       REG                8,1    18472 21435431 /usr/lib/vlc/plugins/audio_filter/libsimple_channel_mixer_plugin.so</span><br><span class="line">xmradio 3425 bluse  mem       REG                8,1     6176 21435428 /usr/lib/vlc/plugins/audio_filter/liba52tospdif_plugin.so</span><br><span class="line">xmradio 3425 bluse  mem       REG               0,19 67108904        7 /dev/shm/pulse-shm-3282743321</span><br><span class="line">xmradio 3425 bluse  mem       REG                8,1  4343844 22414964 /usr/share/fonts/truetype/nanum/NanumGothic.ttf</span><br></pre></td></tr></table></figure>
#strace<br>å®ƒçš„ç”¨æ³•ä¹Ÿå·®ä¸å¤šï¼š<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">strace -f -o vim.strace vimï¼š è·Ÿè¸ªvimåŠå…¶å­è¿›ç¨‹çš„è¿è¡Œï¼Œå°†è¾“å‡ºä¿¡æ¯å†™åˆ°æ–‡ä»¶vim.straceã€‚</span><br></pre></td></tr></table></figure>
è¿›ç¨‹è°ƒè¯•<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">bluse@bluse-Inspiron-1427:~/www/vhost$ sudo strace -o out.strace lsof -p 3425</span><br><span class="line">bluse@bluse-Inspiron-1427:~/www/vhost$ head -10 out.strace </span><br><span class="line">execve(&quot;/usr/bin/lsof&quot;, [&quot;lsof&quot;, &quot;-p&quot;, &quot;3425&quot;], [/* 26 vars */]) = 0</span><br><span class="line">brk(NULL)                               = 0x562c9956b000</span><br><span class="line">access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)</span><br><span class="line">mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f29b0751000</span><br><span class="line">access(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)</span><br><span class="line">open(&quot;/etc/ld.so.cache&quot;, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line">fstat(3, &#123;st_mode=S_IFREG|0644, st_size=188234, ...&#125;) = 0</span><br><span class="line">mmap(NULL, 188234, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f29b0723000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
##htop ä¸­ä½¿ç”¨ strace<br>htopä¸­å†…ç½®äº†strace</li>
</ul>
<p>è¿›å…¥<code>htop</code>åæŒ‰ä¸Šä¸‹æ–¹å‘é”®é€‰æ‹©è¿›ç¨‹ï¼Œåœ¨éœ€è¦è°ƒè¯•çš„è¿›ç¨‹ä¸ŠæŒ‰<code>s</code>å°±èƒ½è¿›å…¥ å®ƒçš„straceã€‚<code>F8</code>æ˜¯è‡ªåŠ¨ç¿»é¡µå¼€å…³ï¼</p>
<p>#ltrace</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">sudo ltrace -p 3425</span><br><span class="line">--- UNKNOWN_SIGNAL (Unknown signal 32) ---</span><br><span class="line">+++ exited (status 0) +++</span><br><span class="line">+++ exited (status 0) +++</span><br><span class="line">+++ exited (status 0) +++</span><br><span class="line">--- SIGCHLD (Child exited) ---</span><br></pre></td></tr></table></figure>
<p>ä½œä¸ºç³»ç»Ÿç®¡ç†ï¼Œä»¥ä¸Šè¿™äº›ç”¨æ³•åŸºæœ¬èƒ½æ»¡è¶³æ—¥å¸¸æ‰€éœ€ã€‚æ›´å¤šæ·±åº¦åŠŸèƒ½å¾—æ‰¾å„è‡ªçš„<code>man</code></p>
]]></content>
      <tags>
        <tag>FreeBSD</tag>
        <tag>è¿ç»´</tag>
        <tag>æ€§èƒ½</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ webpack æ‰“åŒ… font-awesome</title>
    <url>/2017/02/21/webpack-font-awesome/</url>
    <content><![CDATA[<p>å½“ <code>npm install font-awesome --save</code> ååœ¨ä¸»scssæ–‡ä»¶ä¸­ï¼š<br><code>@import ~font-awesome</code> ä¼šæŠ¥å¾ˆå¤šé—®é¢˜</p>
<p>é—®é¢˜ä¸»è¦æ˜¯ä¸¤æ–¹é¢ï¼š</p>
<ul>
<li>è·¯å¾„</li>
<li>åŠ è½½å™¨</li>
</ul>
<h2 id="è·¯å¾„"><a href="#è·¯å¾„" class="headerlink" title="è·¯å¾„"></a>è·¯å¾„</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">@import &quot;~font-awesome/scss/variables&quot;;</span><br><span class="line">$fa-font-path: &quot;~font-awesome/fonts&quot;;</span><br><span class="line">@import &quot;~font-awesome/scss/font-awesome&quot;;</span><br></pre></td></tr></table></figure>
<h2 id="åŠ è½½å™¨"><a href="#åŠ è½½å™¨" class="headerlink" title="åŠ è½½å™¨"></a>åŠ è½½å™¨</h2><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">module: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">    &#123;test: /\.eot(\?v=\d+.\d+.\d+)?$/, loader: &#x27;file-loader&#x27;&#125;,</span><br><span class="line">    &#123;test: /\.woff(2)?(\?v=[0-9]\.[0-9]\.[0-9])?$/, loader: &#x27;url-loader?limit=10000&amp;mimetype=application/font-woff&#x27;&#125;,</span><br><span class="line">    &#123;test: /\.(ttf|eot|svg)(\?v=[0-9]\.[0-9]\.[0-9])?$/, loader: &quot;file-loader?limit=10000&quot;&#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>webpack</tag>
        <tag>font-awesome</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”µå­å•†åŠ¡æ³•</title>
    <url>/2021/01/07/electronic-commerce-law/</url>
    <content><![CDATA[<h1 id="ä¸­åäººæ°‘å…±å’Œå›½ç”µå­å•†åŠ¡æ³•"><a href="#ä¸­åäººæ°‘å…±å’Œå›½ç”µå­å•†åŠ¡æ³•" class="headerlink" title="ä¸­åäººæ°‘å…±å’Œå›½ç”µå­å•†åŠ¡æ³•"></a>ä¸­åäººæ°‘å…±å’Œå›½ç”µå­å•†åŠ¡æ³•</h1><h2 id="ç¬¬ä¸€ç« -æ€»-åˆ™"><a href="#ç¬¬ä¸€ç« -æ€»-åˆ™" class="headerlink" title="ç¬¬ä¸€ç«  æ€» åˆ™"></a>ç¬¬ä¸€ç«  æ€» åˆ™</h2><h4 id="ç¬¬ä¸€æ¡"><a href="#ç¬¬ä¸€æ¡" class="headerlink" title="ç¬¬ä¸€æ¡"></a>ç¬¬ä¸€æ¡</h4><p>ä¸ºäº†ä¿éšœç”µå­å•†åŠ¡å„æ–¹ä¸»ä½“çš„åˆæ³•æƒç›Šï¼Œè§„èŒƒç”µå­å•†åŠ¡è¡Œä¸ºï¼Œç»´æŠ¤å¸‚åœºç§©åºï¼Œä¿ƒè¿›ç”µå­å•†åŠ¡æŒç»­å¥åº·å‘å±•ï¼Œåˆ¶å®šæœ¬æ³•ã€‚</p>
<h4 id="ç¬¬äºŒæ¡"><a href="#ç¬¬äºŒæ¡" class="headerlink" title="ç¬¬äºŒæ¡"></a>ç¬¬äºŒæ¡</h4><p>ä¸­åäººæ°‘å…±å’Œå›½å¢ƒå†…çš„ç”µå­å•†åŠ¡æ´»åŠ¨ï¼Œé€‚ç”¨æœ¬æ³•ã€‚</p>
<p> æœ¬æ³•æ‰€ç§°ç”µå­å•†åŠ¡ï¼Œæ˜¯æŒ‡é€šè¿‡äº’è”ç½‘ç­‰ä¿¡æ¯ç½‘ç»œé”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡çš„ç»è¥æ´» åŠ¨ã€‚</p>
<p> æ³•å¾‹ã€è¡Œæ”¿æ³•è§„å¯¹é”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡æœ‰è§„å®šçš„ï¼Œé€‚ç”¨å…¶è§„å®šã€‚é‡‘èç±»äº§å“å’Œ æœåŠ¡ï¼Œåˆ©ç”¨ä¿¡æ¯ç½‘ç»œæä¾›æ–°é—»ä¿¡æ¯ã€éŸ³è§†é¢‘èŠ‚ç›®ã€å‡ºç‰ˆä»¥åŠæ–‡åŒ–äº§å“ç­‰å†…å®¹æ–¹é¢çš„æœ åŠ¡ï¼Œä¸é€‚ç”¨æœ¬æ³•ã€‚</p>
<h4 id="ç¬¬ä¸‰æ¡"><a href="#ç¬¬ä¸‰æ¡" class="headerlink" title="ç¬¬ä¸‰æ¡"></a>ç¬¬ä¸‰æ¡</h4><p>å›½å®¶é¼“åŠ±å‘å±•ç”µå­å•†åŠ¡æ–°ä¸šæ€ï¼Œåˆ›æ–°å•†ä¸šæ¨¡å¼ï¼Œä¿ƒè¿›ç”µå­å•†åŠ¡æŠ€æœ¯ç ”å‘ å’Œæ¨å¹¿åº”ç”¨ï¼Œæ¨è¿›ç”µå­å•†åŠ¡è¯šä¿¡ä½“ç³»å»ºè®¾ï¼Œè¥é€ æœ‰åˆ©äºç”µå­å•†åŠ¡åˆ›æ–°å‘å±•çš„å¸‚åœºç¯å¢ƒï¼Œ å……åˆ†å‘æŒ¥ç”µå­å•†åŠ¡åœ¨æ¨åŠ¨é«˜è´¨é‡å‘å±•ã€æ»¡è¶³äººæ°‘æ—¥ç›Šå¢é•¿çš„ç¾å¥½ç”Ÿæ´»éœ€è¦ã€æ„å»ºå¼€æ”¾ å‹ç»æµæ–¹é¢çš„é‡è¦ä½œç”¨ã€‚</p>
<h3 id="ç¬¬å››æ¡"><a href="#ç¬¬å››æ¡" class="headerlink" title="ç¬¬å››æ¡"></a>ç¬¬å››æ¡</h3><p>å›½å®¶å¹³ç­‰å¯¹å¾…çº¿ä¸Šçº¿ä¸‹å•†åŠ¡æ´»åŠ¨ï¼Œä¿ƒè¿›çº¿ä¸Šçº¿ä¸‹èåˆå‘å±•ï¼Œå„çº§äººæ°‘æ”¿åºœå’Œæœ‰å…³éƒ¨é—¨ä¸å¾—é‡‡å–æ­§è§†æ€§çš„æ”¿ç­–æªæ–½ï¼Œä¸å¾—æ»¥ç”¨è¡Œæ”¿æƒåŠ›æ’é™¤ã€é™åˆ¶å¸‚åœºç«äº‰ã€‚</p>
<h4 id="ç¬¬äº”æ¡"><a href="#ç¬¬äº”æ¡" class="headerlink" title="ç¬¬äº”æ¡"></a>ç¬¬äº”æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…ä»äº‹ç»è¥æ´»åŠ¨ï¼Œåº”å½“éµå¾ªè‡ªæ„¿ã€å¹³ç­‰ã€å…¬å¹³ã€è¯šä¿¡çš„åŸåˆ™ï¼Œéµå®ˆæ³•å¾‹å’Œå•†ä¸šé“å¾·ï¼Œå…¬å¹³å‚ä¸å¸‚åœºç«äº‰ï¼Œå±¥è¡Œæ¶ˆè´¹è€…æƒç›Šä¿æŠ¤ã€ç¯å¢ƒä¿æŠ¤ã€çŸ¥è¯†äº§æƒä¿æŠ¤ã€ç½‘ç»œå®‰å…¨ä¸ä¸ªäººä¿¡æ¯ä¿æŠ¤ç­‰æ–¹é¢çš„ä¹‰åŠ¡ï¼Œæ‰¿æ‹…äº§å“å’ŒæœåŠ¡è´¨é‡è´£ä»»ï¼Œæ¥å—æ”¿åºœå’Œç¤¾ä¼šçš„ç›‘ç£ã€‚</p>
<h4 id="ç¬¬å…­æ¡"><a href="#ç¬¬å…­æ¡" class="headerlink" title="ç¬¬å…­æ¡"></a>ç¬¬å…­æ¡</h4><p>å›½åŠ¡é™¢æœ‰å…³éƒ¨é—¨æŒ‰ç…§èŒè´£åˆ†å·¥è´Ÿè´£ç”µå­å•†åŠ¡å‘å±•ä¿ƒè¿›ã€ç›‘ç£ç®¡ç†ç­‰å·¥ä½œã€‚å¿çº§ä»¥ä¸Šåœ°æ–¹å„çº§äººæ°‘æ”¿åºœå¯ä»¥æ ¹æ®æœ¬è¡Œæ”¿åŒºåŸŸçš„å®é™…æƒ…å†µï¼Œç¡®å®šæœ¬è¡Œæ”¿åŒºåŸŸå†…ç”µå­å•†åŠ¡çš„éƒ¨é—¨èŒè´£åˆ’åˆ†ã€‚</p>
<h4 id="ç¬¬ä¸ƒæ¡"><a href="#ç¬¬ä¸ƒæ¡" class="headerlink" title="ç¬¬ä¸ƒæ¡"></a>ç¬¬ä¸ƒæ¡</h4><p>å›½å®¶å»ºç«‹ç¬¦åˆç”µå­å•†åŠ¡ç‰¹ç‚¹çš„ååŒç®¡ç†ä½“ç³»ï¼Œæ¨åŠ¨å½¢æˆæœ‰å…³éƒ¨é—¨ã€ç”µå­å•†åŠ¡è¡Œä¸šç»„ç»‡ã€ç”µå­å•†åŠ¡ç»è¥è€…ã€æ¶ˆè´¹è€…ç­‰å…±åŒå‚ä¸çš„ç”µå­å•†åŠ¡å¸‚åœºæ²»ç†ä½“ç³»ã€‚</p>
<h4 id="ç¬¬å…«æ¡"><a href="#ç¬¬å…«æ¡" class="headerlink" title="ç¬¬å…«æ¡"></a>ç¬¬å…«æ¡</h4><p>ç”µå­å•†åŠ¡è¡Œä¸šç»„ç»‡æŒ‰ç…§æœ¬ç»„ç»‡ç« ç¨‹å¼€å±•è¡Œä¸šè‡ªå¾‹ï¼Œå»ºç«‹å¥å…¨è¡Œä¸šè§„èŒƒï¼Œæ¨åŠ¨è¡Œä¸šè¯šä¿¡å»ºè®¾ï¼Œç›‘ç£ã€å¼•å¯¼æœ¬è¡Œä¸šç»è¥è€…å…¬å¹³å‚ä¸å¸‚åœºç«äº‰ã€‚</p>
<h2 id="ç¬¬äºŒç« -ç”µå­å•†åŠ¡ç»è¥è€…"><a href="#ç¬¬äºŒç« -ç”µå­å•†åŠ¡ç»è¥è€…" class="headerlink" title="ç¬¬äºŒç«  ç”µå­å•†åŠ¡ç»è¥è€…"></a>ç¬¬äºŒç«  ç”µå­å•†åŠ¡ç»è¥è€…</h2><h3 id="ç¬¬ä¸€èŠ‚-ä¸€èˆ¬è§„å®š"><a href="#ç¬¬ä¸€èŠ‚-ä¸€èˆ¬è§„å®š" class="headerlink" title="ç¬¬ä¸€èŠ‚ ä¸€èˆ¬è§„å®š"></a>ç¬¬ä¸€èŠ‚ ä¸€èˆ¬è§„å®š</h3><h4 id="ç¬¬ä¹æ¡"><a href="#ç¬¬ä¹æ¡" class="headerlink" title="ç¬¬ä¹æ¡"></a>ç¬¬ä¹æ¡</h4><p>æœ¬æ³•æ‰€ç§°ç”µå­å•†åŠ¡ç»è¥è€…ï¼Œæ˜¯æŒ‡é€šè¿‡äº’è”ç½‘ç­‰ä¿¡æ¯ç½‘ç»œä»äº‹é”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡çš„ç»è¥æ´»åŠ¨çš„è‡ªç„¶äººã€æ³•äººå’Œéæ³•äººç»„ç»‡ï¼ŒåŒ…æ‹¬ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ã€å¹³å°å†…ç»è¥è€…ä»¥åŠé€šè¿‡è‡ªå»ºç½‘ç«™ã€å…¶ä»–ç½‘ç»œæœåŠ¡é”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡çš„ç”µå­å•†åŠ¡ç»è¥è€…ã€‚</p>
<p> æœ¬æ³•æ‰€ç§°ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ï¼Œæ˜¯æŒ‡åœ¨ç”µå­å•†åŠ¡ä¸­ä¸ºäº¤æ˜“åŒæ–¹æˆ–è€…å¤šæ–¹æä¾›ç½‘ç»œç»è¥åœºæ‰€ã€äº¤æ˜“æ’®åˆã€ä¿¡æ¯å‘å¸ƒç­‰æœåŠ¡ï¼Œä¾›äº¤æ˜“åŒæ–¹æˆ–è€…å¤šæ–¹ç‹¬ç«‹å¼€å±•äº¤æ˜“æ´»åŠ¨çš„æ³•äººæˆ–è€…éæ³•äººç»„ç»‡ã€‚</p>
<p> æœ¬æ³•æ‰€ç§°å¹³å°å†…ç»è¥è€…ï¼Œæ˜¯æŒ‡é€šè¿‡ç”µå­å•†åŠ¡å¹³å°é”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡çš„ç”µå­å•†åŠ¡ç»è¥è€…ã€‚</p>
<h4 id="ç¬¬åæ¡"><a href="#ç¬¬åæ¡" class="headerlink" title="ç¬¬åæ¡"></a>ç¬¬åæ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“ä¾æ³•åŠç†å¸‚åœºä¸»ä½“ç™»è®°ã€‚ä½†æ˜¯ï¼Œä¸ªäººé”€å”®è‡ªäº§å†œå‰¯äº§å“ã€å®¶åº­æ‰‹å·¥ä¸šäº§å“ï¼Œä¸ªäººåˆ©ç”¨è‡ªå·±çš„æŠ€èƒ½ä»äº‹ä¾æ³•æ— é¡»å–å¾—è®¸å¯çš„ä¾¿æ°‘åŠ³åŠ¡æ´»åŠ¨å’Œé›¶æ˜Ÿå°é¢äº¤æ˜“æ´»åŠ¨ï¼Œä»¥åŠä¾ç…§æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ä¸éœ€è¦è¿›è¡Œç™»è®°çš„é™¤å¤–ã€‚</p>
<h4 id="ç¬¬åä¸€æ¡"><a href="#ç¬¬åä¸€æ¡" class="headerlink" title="ç¬¬åä¸€æ¡"></a>ç¬¬åä¸€æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“ä¾æ³•å±¥è¡Œçº³ç¨ä¹‰åŠ¡ï¼Œå¹¶ä¾æ³•äº«å—ç¨æ”¶ä¼˜æƒ ã€‚</p>
<p> ä¾ç…§å‰æ¡è§„å®šä¸éœ€è¦åŠç†å¸‚åœºä¸»ä½“ç™»è®°çš„ç”µå­å•†åŠ¡ç»è¥è€…åœ¨é¦–æ¬¡çº³ç¨ä¹‰åŠ¡å‘ç”Ÿåï¼Œåº”å½“ä¾ç…§ç¨æ”¶å¾æ”¶ç®¡ç†æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šç”³è¯·åŠç†ç¨åŠ¡ç™»è®°ï¼Œå¹¶å¦‚å®ç”³æŠ¥çº³ç¨ã€‚</p>
<h4 id="ç¬¬åäºŒæ¡"><a href="#ç¬¬åäºŒæ¡" class="headerlink" title="ç¬¬åäºŒæ¡"></a>ç¬¬åäºŒæ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…ä»äº‹ç»è¥æ´»åŠ¨ï¼Œä¾æ³•éœ€è¦å–å¾—ç›¸å…³è¡Œæ”¿è®¸å¯çš„ï¼Œåº”å½“ä¾æ³•å–å¾—è¡Œæ”¿è®¸å¯ã€‚</p>
<h4 id="ç¬¬åä¸‰æ¡"><a href="#ç¬¬åä¸‰æ¡" class="headerlink" title="ç¬¬åä¸‰æ¡"></a>ç¬¬åä¸‰æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…é”€å”®çš„å•†å“æˆ–è€…æä¾›çš„æœåŠ¡åº”å½“ç¬¦åˆä¿éšœäººèº«ã€è´¢äº§å®‰å…¨çš„è¦æ±‚å’Œç¯å¢ƒä¿æŠ¤è¦æ±‚ï¼Œä¸å¾—é”€å”®æˆ–è€…æä¾›æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ç¦æ­¢äº¤æ˜“çš„å•†å“æˆ–è€…æœåŠ¡ã€‚</p>
<h4 id="ç¬¬åå››æ¡"><a href="#ç¬¬åå››æ¡" class="headerlink" title="ç¬¬åå››æ¡"></a>ç¬¬åå››æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…é”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡åº”å½“ä¾æ³•å‡ºå…·çº¸è´¨å‘ç¥¨æˆ–è€…ç”µå­å‘ç¥¨ç­‰è´­è´§å‡­è¯æˆ–è€…æœåŠ¡å•æ®ã€‚ç”µå­å‘ç¥¨ä¸çº¸è´¨å‘ç¥¨å…·æœ‰åŒç­‰æ³•å¾‹æ•ˆåŠ›ã€‚</p>
<h4 id="ç¬¬åäº”æ¡"><a href="#ç¬¬åäº”æ¡" class="headerlink" title="ç¬¬åäº”æ¡"></a>ç¬¬åäº”æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“åœ¨å…¶é¦–é¡µæ˜¾è‘—ä½ç½®ï¼ŒæŒç»­å…¬ç¤ºè¥ä¸šæ‰§ç…§ä¿¡æ¯ã€ä¸å…¶ç»è¥ä¸šåŠ¡æœ‰å…³çš„è¡Œæ”¿è®¸å¯ä¿¡æ¯ã€å±äºä¾ç…§æœ¬æ³•ç¬¬åæ¡è§„å®šçš„ä¸éœ€è¦åŠç†å¸‚åœºä¸»ä½“ç™»è®°æƒ…å½¢ç­‰ä¿¡æ¯ï¼Œæˆ–è€…ä¸Šè¿°ä¿¡æ¯çš„é“¾æ¥æ ‡è¯†ã€‚</p>
<p> å‰æ¬¾è§„å®šçš„ä¿¡æ¯å‘ç”Ÿå˜æ›´çš„ï¼Œç”µå­å•†åŠ¡ç»è¥è€…åº”å½“åŠæ—¶æ›´æ–°å…¬ç¤ºä¿¡æ¯ã€‚</p>
<h4 id="ç¬¬åå…­æ¡"><a href="#ç¬¬åå…­æ¡" class="headerlink" title="ç¬¬åå…­æ¡"></a>ç¬¬åå…­æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…è‡ªè¡Œç»ˆæ­¢ä»äº‹ç”µå­å•†åŠ¡çš„ï¼Œåº”å½“æå‰ä¸‰åæ—¥åœ¨é¦–é¡µæ˜¾è‘—ä½ç½®æŒç»­å…¬ç¤ºæœ‰å…³ä¿¡æ¯ã€‚</p>
<h4 id="ç¬¬åä¸ƒæ¡"><a href="#ç¬¬åä¸ƒæ¡" class="headerlink" title="ç¬¬åä¸ƒæ¡"></a>ç¬¬åä¸ƒæ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“å…¨é¢ã€çœŸå®ã€å‡†ç¡®ã€åŠæ—¶åœ°æŠ«éœ²å•†å“æˆ–è€…æœåŠ¡ä¿¡æ¯ï¼Œä¿éšœæ¶ˆè´¹è€…çš„çŸ¥æƒ…æƒå’Œé€‰æ‹©æƒã€‚ç”µå­å•†åŠ¡ç»è¥è€…ä¸å¾—ä»¥è™šæ„äº¤æ˜“ã€ç¼–é€ ç”¨æˆ·è¯„ä»·ç­‰æ–¹å¼è¿›è¡Œè™šå‡æˆ–è€…å¼•äººè¯¯è§£çš„å•†ä¸šå®£ä¼ ï¼Œæ¬ºéª—ã€è¯¯å¯¼æ¶ˆè´¹è€…ã€‚</p>
<h4 id="ç¬¬åå…«æ¡"><a href="#ç¬¬åå…«æ¡" class="headerlink" title="ç¬¬åå…«æ¡"></a>ç¬¬åå…«æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…æ ¹æ®æ¶ˆè´¹è€…çš„å…´è¶£çˆ±å¥½ã€æ¶ˆè´¹ä¹ æƒ¯ç­‰ç‰¹å¾å‘å…¶æä¾›å•†å“æˆ–è€…æœåŠ¡çš„æœç´¢ç»“æœçš„ï¼Œåº”å½“åŒæ—¶å‘è¯¥æ¶ˆè´¹è€…æä¾›ä¸é’ˆå¯¹å…¶ä¸ªäººç‰¹å¾çš„é€‰é¡¹ï¼Œå°Šé‡<br>å’Œå¹³ç­‰ä¿æŠ¤æ¶ˆè´¹è€…åˆæ³•æƒç›Šã€‚</p>
<p> ç”µå­å•†åŠ¡ç»è¥è€…å‘æ¶ˆè´¹è€…å‘é€å¹¿å‘Šçš„ï¼Œåº”å½“éµå®ˆã€Šä¸­åäººæ°‘å…±å’Œå›½å¹¿å‘Šæ³•ã€‹çš„æœ‰å…³è§„å®šã€‚</p>
<h4 id="ç¬¬åä¹æ¡"><a href="#ç¬¬åä¹æ¡" class="headerlink" title="ç¬¬åä¹æ¡"></a>ç¬¬åä¹æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…æ­å”®å•†å“æˆ–è€…æœåŠ¡ï¼Œåº”å½“ä»¥æ˜¾è‘—æ–¹å¼æè¯·æ¶ˆè´¹è€…æ³¨æ„ï¼Œä¸å¾—å°†æ­å”®å•†å“æˆ–è€…æœåŠ¡ä½œä¸ºé»˜è®¤åŒæ„çš„é€‰é¡¹ã€‚</p>
<h4 id="ç¬¬äºŒåæ¡"><a href="#ç¬¬äºŒåæ¡" class="headerlink" title="ç¬¬äºŒåæ¡"></a>ç¬¬äºŒåæ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“æŒ‰ç…§æ‰¿è¯ºæˆ–è€…ä¸æ¶ˆè´¹è€…çº¦å®šçš„æ–¹å¼ã€æ—¶é™å‘æ¶ˆè´¹è€…äº¤ä»˜å•†å“æˆ–è€…æœåŠ¡ï¼Œå¹¶æ‰¿æ‹…å•†å“è¿è¾“ä¸­çš„é£é™©å’Œè´£ä»»ã€‚ä½†æ˜¯ï¼Œæ¶ˆè´¹è€…å¦è¡Œé€‰æ‹©å¿«é€’ç‰©æµæœåŠ¡æä¾›è€…çš„é™¤å¤–ã€‚</p>
<h4 id="ç¬¬äºŒåä¸€æ¡"><a href="#ç¬¬äºŒåä¸€æ¡" class="headerlink" title="ç¬¬äºŒåä¸€æ¡"></a>ç¬¬äºŒåä¸€æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…æŒ‰ç…§çº¦å®šå‘æ¶ˆè´¹è€…æ”¶å–æŠ¼é‡‘çš„ï¼Œåº”å½“æ˜ç¤ºæŠ¼é‡‘é€€è¿˜çš„æ–¹å¼ã€ç¨‹åºï¼Œä¸å¾—å¯¹æŠ¼é‡‘é€€è¿˜è®¾ç½®ä¸åˆç†æ¡ä»¶ã€‚æ¶ˆè´¹è€…ç”³è¯·é€€è¿˜æŠ¼é‡‘ï¼Œç¬¦åˆæŠ¼é‡‘é€€è¿˜æ¡ä»¶çš„ï¼Œç”µå­å•†åŠ¡ç»è¥è€…åº”å½“åŠæ—¶é€€è¿˜ã€‚</p>
<h4 id="ç¬¬äºŒåäºŒæ¡"><a href="#ç¬¬äºŒåäºŒæ¡" class="headerlink" title="ç¬¬äºŒåäºŒæ¡"></a>ç¬¬äºŒåäºŒæ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…å› å…¶æŠ€æœ¯ä¼˜åŠ¿ã€ç”¨æˆ·æ•°é‡ã€å¯¹ç›¸å…³è¡Œä¸šçš„æ§åˆ¶èƒ½åŠ›ä»¥åŠå…¶ä»–ç»è¥è€…å¯¹è¯¥ç”µå­å•†åŠ¡ç»è¥è€…åœ¨äº¤æ˜“ä¸Šçš„ä¾èµ–ç¨‹åº¦ç­‰å› ç´ è€Œå…·æœ‰å¸‚åœºæ”¯é…åœ°ä½çš„ï¼Œä¸å¾—æ»¥ç”¨å¸‚åœºæ”¯é…åœ°ä½ï¼Œæ’é™¤ã€é™åˆ¶ç«äº‰ã€‚</p>
<h4 id="ç¬¬äºŒåä¸‰æ¡"><a href="#ç¬¬äºŒåä¸‰æ¡" class="headerlink" title="ç¬¬äºŒåä¸‰æ¡"></a>ç¬¬äºŒåä¸‰æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…æ”¶é›†ã€ä½¿ç”¨å…¶ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œåº”å½“éµå®ˆæ³•å¾‹ã€è¡Œæ”¿æ³•è§„æœ‰å…³ä¸ªäººä¿¡æ¯ä¿æŠ¤çš„è§„å®šã€‚</p>
<h4 id="ç¬¬äºŒåå››æ¡"><a href="#ç¬¬äºŒåå››æ¡" class="headerlink" title="ç¬¬äºŒåå››æ¡"></a>ç¬¬äºŒåå››æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“æ˜ç¤ºç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ã€æ›´æ­£ã€åˆ é™¤ä»¥åŠç”¨æˆ·æ³¨é”€çš„æ–¹å¼ã€ç¨‹åºï¼Œä¸å¾—å¯¹ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ã€æ›´æ­£ã€åˆ é™¤ä»¥åŠç”¨æˆ·æ³¨é”€è®¾ç½®ä¸åˆç†æ¡ä»¶ã€‚</p>
<p> ç”µå­å•†åŠ¡ç»è¥è€…æ”¶åˆ°ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢æˆ–è€…æ›´æ­£ã€åˆ é™¤çš„ç”³è¯·çš„ï¼Œåº”å½“åœ¨æ ¸å®èº«ä»½ååŠæ—¶æä¾›æŸ¥è¯¢æˆ–è€…æ›´æ­£ã€åˆ é™¤ç”¨æˆ·ä¿¡æ¯ã€‚ç”¨æˆ·æ³¨é”€çš„ï¼Œç”µå­å•†åŠ¡ç»è¥è€…åº”å½“ç«‹å³åˆ é™¤è¯¥ç”¨æˆ·çš„ä¿¡æ¯ï¼›ä¾ç…§æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šæˆ–è€…åŒæ–¹çº¦å®šä¿å­˜çš„ï¼Œä¾ç…§å…¶è§„å®šã€‚</p>
<h4 id="ç¬¬äºŒåäº”æ¡"><a href="#ç¬¬äºŒåäº”æ¡" class="headerlink" title="ç¬¬äºŒåäº”æ¡"></a>ç¬¬äºŒåäº”æ¡</h4><p>æœ‰å…³ä¸»ç®¡éƒ¨é—¨ä¾ç…§æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šè¦æ±‚ç”µå­å•†åŠ¡ç»è¥è€…æä¾›æœ‰å…³ç”µå­å•†åŠ¡æ•°æ®ä¿¡æ¯çš„ï¼Œç”µå­å•†åŠ¡ç»è¥è€…åº”å½“æä¾›ã€‚æœ‰å…³ä¸»ç®¡éƒ¨é—¨åº”å½“é‡‡å–å¿…è¦æªæ–½ä¿æŠ¤ç”µå­å•†åŠ¡ç»è¥è€…æä¾›çš„æ•°æ®ä¿¡æ¯çš„å®‰å…¨ï¼Œå¹¶å¯¹å…¶ä¸­çš„ä¸ªäººä¿¡æ¯ã€éšç§å’Œå•†ä¸šç§˜å¯†ä¸¥æ ¼ä¿å¯†ï¼Œä¸å¾—æ³„éœ²ã€å‡ºå”®æˆ–è€…éæ³•å‘ä»–äººæä¾›ã€‚</p>
<h4 id="ç¬¬äºŒåå…­æ¡"><a href="#ç¬¬äºŒåå…­æ¡" class="headerlink" title="ç¬¬äºŒåå…­æ¡"></a>ç¬¬äºŒåå…­æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…ä»äº‹è·¨å¢ƒç”µå­å•†åŠ¡ï¼Œåº”å½“éµå®ˆè¿›å‡ºå£ç›‘ç£ç®¡ç†çš„æ³•å¾‹ã€è¡Œæ”¿æ³•è§„å’Œå›½å®¶æœ‰å…³è§„å®šã€‚</p>
<h3 id="ç¬¬äºŒèŠ‚-ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…"><a href="#ç¬¬äºŒèŠ‚-ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…" class="headerlink" title="ç¬¬äºŒèŠ‚ ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…"></a>ç¬¬äºŒèŠ‚ ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…</h3><h4 id="ç¬¬äºŒåä¸ƒæ¡"><a href="#ç¬¬äºŒåä¸ƒæ¡" class="headerlink" title="ç¬¬äºŒåä¸ƒæ¡"></a>ç¬¬äºŒåä¸ƒæ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“è¦æ±‚ç”³è¯·è¿›å…¥å¹³å°é”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡çš„ç»è¥è€…æäº¤å…¶èº«ä»½ã€åœ°å€ã€è”ç³»æ–¹å¼ã€è¡Œæ”¿è®¸å¯ç­‰çœŸå®ä¿¡æ¯ï¼Œè¿›è¡Œæ ¸éªŒã€ç™»è®°ï¼Œå»ºç«‹ç™»è®°æ¡£æ¡ˆï¼Œå¹¶å®šæœŸæ ¸éªŒæ›´æ–°ã€‚</p>
<p> ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ä¸ºè¿›å…¥å¹³å°é”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡çš„éç»è¥ç”¨æˆ·æä¾›æœåŠ¡ï¼Œåº”å½“éµå®ˆæœ¬èŠ‚æœ‰å…³è§„å®šã€‚</p>
<h4 id="ç¬¬äºŒåå…«æ¡"><a href="#ç¬¬äºŒåå…«æ¡" class="headerlink" title="ç¬¬äºŒåå…«æ¡"></a>ç¬¬äºŒåå…«æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“æŒ‰ç…§è§„å®šå‘å¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨æŠ¥é€å¹³å°å†…ç»è¥è€…çš„èº«ä»½ä¿¡æ¯ï¼Œæç¤ºæœªåŠç†å¸‚åœºä¸»ä½“ç™»è®°çš„ç»è¥è€…ä¾æ³•åŠç†ç™»è®°ï¼Œå¹¶é…åˆå¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨ï¼Œé’ˆå¯¹ç”µå­å•†åŠ¡çš„ç‰¹ç‚¹ï¼Œä¸ºåº”å½“åŠç†å¸‚åœºä¸»ä½“ç™»è®°çš„ç»è¥è€…åŠç†ç™»è®°æä¾›ä¾¿åˆ©ã€‚</p>
<p> ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“ä¾ç…§ç¨æ”¶å¾æ”¶ç®¡ç†æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šï¼Œå‘ç¨åŠ¡éƒ¨é—¨æŠ¥é€å¹³å°å†…ç»è¥è€…çš„èº«ä»½ä¿¡æ¯å’Œä¸çº³ç¨æœ‰å…³çš„ä¿¡æ¯ï¼Œå¹¶åº”å½“æç¤ºä¾ç…§æœ¬æ³•ç¬¬åæ¡è§„å®šä¸éœ€è¦åŠç†å¸‚åœºä¸»ä½“ç™»è®°çš„ç”µå­å•†åŠ¡ç»è¥è€…ä¾ç…§æœ¬æ³•ç¬¬åä¸€æ¡ç¬¬äºŒæ¬¾çš„è§„å®šåŠç†ç¨åŠ¡ç™»è®°ã€‚</p>
<h4 id="ç¬¬äºŒåä¹æ¡"><a href="#ç¬¬äºŒåä¹æ¡" class="headerlink" title="ç¬¬äºŒåä¹æ¡"></a>ç¬¬äºŒåä¹æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…å‘ç°å¹³å°å†…çš„å•†å“æˆ–è€…æœåŠ¡ä¿¡æ¯å­˜åœ¨è¿åæœ¬æ³•ç¬¬åäºŒæ¡ã€ç¬¬åä¸‰æ¡è§„å®šæƒ…å½¢çš„ï¼Œåº”å½“ä¾æ³•é‡‡å–å¿…è¦çš„å¤„ç½®æªæ–½ï¼Œå¹¶å‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šã€‚</p>
<h4 id="ç¬¬ä¸‰åæ¡"><a href="#ç¬¬ä¸‰åæ¡" class="headerlink" title="ç¬¬ä¸‰åæ¡"></a>ç¬¬ä¸‰åæ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“é‡‡å–æŠ€æœ¯æªæ–½å’Œå…¶ä»–å¿…è¦æªæ–½ä¿è¯å…¶ç½‘ç»œå®‰å…¨ã€ç¨³å®šè¿è¡Œï¼Œé˜²èŒƒç½‘ç»œè¿æ³•çŠ¯ç½ªæ´»åŠ¨ï¼Œæœ‰æ•ˆåº”å¯¹ç½‘ç»œå®‰å…¨äº‹ä»¶ï¼Œä¿éšœç”µå­å•†åŠ¡äº¤æ˜“å®‰å…¨ã€‚</p>
<p> ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“åˆ¶å®šç½‘ç»œå®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆï¼Œå‘ç”Ÿç½‘ç»œå®‰å…¨äº‹ä»¶æ—¶ï¼Œåº”å½“ç«‹å³å¯åŠ¨åº”æ€¥é¢„æ¡ˆï¼Œé‡‡å–ç›¸åº”çš„è¡¥æ•‘æªæ–½ï¼Œå¹¶å‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šã€‚</p>
<h4 id="ç¬¬ä¸‰åä¸€æ¡"><a href="#ç¬¬ä¸‰åä¸€æ¡" class="headerlink" title="ç¬¬ä¸‰åä¸€æ¡"></a>ç¬¬ä¸‰åä¸€æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“è®°å½•ã€ä¿å­˜å¹³å°ä¸Šå‘å¸ƒçš„å•†å“å’ŒæœåŠ¡ä¿¡æ¯ã€äº¤æ˜“ä¿¡æ¯ï¼Œå¹¶ç¡®ä¿ä¿¡æ¯çš„å®Œæ•´æ€§ã€ä¿å¯†æ€§ã€å¯ç”¨æ€§ã€‚å•†å“å’ŒæœåŠ¡ä¿¡æ¯ã€äº¤æ˜“ä¿¡æ¯ä¿å­˜æ—¶é—´è‡ªäº¤æ˜“å®Œæˆä¹‹æ—¥èµ·ä¸å°‘äºä¸‰å¹´ï¼›æ³•å¾‹ã€è¡Œæ”¿æ³•è§„å¦æœ‰è§„å®šçš„ï¼Œä¾ç…§å…¶è§„å®šã€‚</p>
<h4 id="ç¬¬ä¸‰åäºŒæ¡"><a href="#ç¬¬ä¸‰åäºŒæ¡" class="headerlink" title="ç¬¬ä¸‰åäºŒæ¡"></a>ç¬¬ä¸‰åäºŒæ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“éµå¾ªå…¬å¼€ã€å…¬å¹³ã€å…¬æ­£çš„åŸåˆ™ï¼Œåˆ¶å®šå¹³å°æœåŠ¡åè®®å’Œäº¤æ˜“è§„åˆ™ï¼Œæ˜ç¡®è¿›å…¥å’Œé€€å‡ºå¹³å°ã€å•†å“å’ŒæœåŠ¡è´¨é‡ä¿éšœã€æ¶ˆè´¹è€…æƒç›Šä¿æŠ¤ã€ä¸ªäººä¿¡æ¯ä¿æŠ¤ç­‰æ–¹é¢çš„æƒåˆ©å’Œä¹‰åŠ¡ã€‚</p>
<h4 id="ç¬¬ä¸‰åä¸‰æ¡"><a href="#ç¬¬ä¸‰åä¸‰æ¡" class="headerlink" title="ç¬¬ä¸‰åä¸‰æ¡"></a>ç¬¬ä¸‰åä¸‰æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“åœ¨å…¶é¦–é¡µæ˜¾è‘—ä½ç½®æŒç»­å…¬ç¤ºå¹³å°æœåŠ¡åè®®å’Œäº¤æ˜“è§„åˆ™ä¿¡æ¯æˆ–è€…ä¸Šè¿°ä¿¡æ¯çš„é“¾æ¥æ ‡è¯†ï¼Œå¹¶ä¿è¯ç»è¥è€…å’Œæ¶ˆè´¹è€…èƒ½å¤Ÿä¾¿åˆ©ã€å®Œæ•´åœ°é˜…è§ˆå’Œä¸‹è½½ã€‚</p>
<h4 id="ç¬¬ä¸‰åå››æ¡"><a href="#ç¬¬ä¸‰åå››æ¡" class="headerlink" title="ç¬¬ä¸‰åå››æ¡"></a>ç¬¬ä¸‰åå››æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ä¿®æ”¹å¹³å°æœåŠ¡åè®®å’Œäº¤æ˜“è§„åˆ™ï¼Œåº”å½“åœ¨å…¶é¦–é¡µæ˜¾è‘—ä½ç½®å…¬å¼€å¾æ±‚æ„è§ï¼Œé‡‡å–åˆç†æªæ–½ç¡®ä¿æœ‰å…³å„æ–¹èƒ½å¤ŸåŠæ—¶å……åˆ†è¡¨è¾¾æ„è§ã€‚ä¿®æ”¹å†…å®¹åº”å½“è‡³å°‘åœ¨å®æ–½å‰ä¸ƒæ—¥äºˆä»¥å…¬ç¤ºã€‚</p>
<p> å¹³å°å†…ç»è¥è€…ä¸æ¥å—ä¿®æ”¹å†…å®¹ï¼Œè¦æ±‚é€€å‡ºå¹³å°çš„ï¼Œç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ä¸å¾—é˜»æ­¢ï¼Œå¹¶æŒ‰ç…§ä¿®æ”¹å‰çš„æœåŠ¡åè®®å’Œäº¤æ˜“è§„åˆ™æ‰¿æ‹…ç›¸å…³è´£ä»»ã€‚</p>
<h4 id="ç¬¬ä¸‰åäº”æ¡"><a href="#ç¬¬ä¸‰åäº”æ¡" class="headerlink" title="ç¬¬ä¸‰åäº”æ¡"></a>ç¬¬ä¸‰åäº”æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ä¸å¾—åˆ©ç”¨æœåŠ¡åè®®ã€äº¤æ˜“è§„åˆ™ä»¥åŠæŠ€æœ¯ç­‰æ‰‹æ®µï¼Œå¯¹å¹³å°å†…ç»è¥è€…åœ¨å¹³å°å†…çš„äº¤æ˜“ã€äº¤æ˜“ä»·æ ¼ä»¥åŠä¸å…¶ä»–ç»è¥è€…çš„äº¤æ˜“ç­‰è¿›è¡Œä¸åˆç†é™åˆ¶æˆ–è€…é™„åŠ ä¸åˆç†æ¡ä»¶ï¼Œæˆ–è€…å‘å¹³å°å†…ç»è¥è€…æ”¶å–ä¸åˆç†è´¹ç”¨ã€‚</p>
<h4 id="ç¬¬ä¸‰åå…­æ¡"><a href="#ç¬¬ä¸‰åå…­æ¡" class="headerlink" title="ç¬¬ä¸‰åå…­æ¡"></a>ç¬¬ä¸‰åå…­æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ä¾æ®å¹³å°æœåŠ¡åè®®å’Œäº¤æ˜“è§„åˆ™å¯¹å¹³å°å†…ç»è¥è€…è¿åæ³•å¾‹ã€æ³•è§„çš„è¡Œä¸ºå®æ–½è­¦ç¤ºã€æš‚åœæˆ–è€…ç»ˆæ­¢æœåŠ¡ç­‰æªæ–½çš„ï¼Œåº”å½“åŠæ—¶å…¬ç¤ºã€‚</p>
<h4 id="ç¬¬ä¸‰åä¸ƒæ¡"><a href="#ç¬¬ä¸‰åä¸ƒæ¡" class="headerlink" title="ç¬¬ä¸‰åä¸ƒæ¡"></a>ç¬¬ä¸‰åä¸ƒæ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åœ¨å…¶å¹³å°ä¸Šå¼€å±•è‡ªè¥ä¸šåŠ¡çš„ï¼Œåº”å½“ä»¥æ˜¾è‘—æ–¹å¼åŒºåˆ†æ ‡è®°è‡ªè¥ä¸šåŠ¡å’Œå¹³å°å†…ç»è¥è€…å¼€å±•çš„ä¸šåŠ¡ï¼Œä¸å¾—è¯¯å¯¼æ¶ˆè´¹è€…ã€‚</p>
<p> ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…å¯¹å…¶æ ‡è®°ä¸ºè‡ªè¥çš„ä¸šåŠ¡ä¾æ³•æ‰¿æ‹…å•†å“é”€å”®è€…æˆ–è€…æœåŠ¡æä¾›è€…çš„æ°‘äº‹è´£ä»»ã€‚</p>
<h4 id="ç¬¬ä¸‰åå…«æ¡"><a href="#ç¬¬ä¸‰åå…«æ¡" class="headerlink" title="ç¬¬ä¸‰åå…«æ¡"></a>ç¬¬ä¸‰åå…«æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…çŸ¥é“æˆ–è€…åº”å½“çŸ¥é“å¹³å°å†…ç»è¥è€…é”€å”®çš„å•†å“æˆ–è€…æä¾›çš„æœåŠ¡ä¸ç¬¦åˆä¿éšœäººèº«ã€è´¢äº§å®‰å…¨çš„è¦æ±‚ï¼Œæˆ–è€…æœ‰å…¶ä»–ä¾µå®³æ¶ˆè´¹è€…åˆæ³•æƒç›Šè¡Œä¸ºï¼Œæœªé‡‡å–å¿…è¦æªæ–½çš„ï¼Œä¾æ³•ä¸è¯¥å¹³å°å†…ç»è¥è€…æ‰¿æ‹…è¿å¸¦è´£ä»»ã€‚</p>
<p> å¯¹å…³ç³»æ¶ˆè´¹è€…ç”Ÿå‘½å¥åº·çš„å•†å“æˆ–è€…æœåŠ¡ï¼Œç”µå­å•†åŠ¡å¹³å°ç»è¥è€…å¯¹å¹³å°å†…ç»è¥è€…çš„èµ„è´¨èµ„æ ¼æœªå°½åˆ°å®¡æ ¸ä¹‰åŠ¡ï¼Œæˆ–è€…å¯¹æ¶ˆè´¹è€…æœªå°½åˆ°å®‰å…¨ä¿éšœä¹‰åŠ¡ï¼Œé€ æˆæ¶ˆè´¹è€…æŸå®³çš„ï¼Œä¾æ³•æ‰¿æ‹…ç›¸åº”çš„è´£ä»»ã€‚</p>
<h4 id="ç¬¬ä¸‰åä¹æ¡"><a href="#ç¬¬ä¸‰åä¹æ¡" class="headerlink" title="ç¬¬ä¸‰åä¹æ¡"></a>ç¬¬ä¸‰åä¹æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“å»ºç«‹å¥å…¨ä¿¡ç”¨è¯„ä»·åˆ¶åº¦ï¼Œå…¬ç¤ºä¿¡ç”¨è¯„ä»·è§„åˆ™ï¼Œä¸ºæ¶ˆè´¹è€…æä¾›å¯¹å¹³å°å†…é”€å”®çš„å•†å“æˆ–è€…æä¾›çš„æœåŠ¡è¿›è¡Œè¯„ä»·çš„é€”å¾„ã€‚</p>
<p> ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ä¸å¾—åˆ é™¤æ¶ˆè´¹è€…å¯¹å…¶å¹³å°å†…é”€å”®çš„å•†å“æˆ–è€…æä¾›çš„æœåŠ¡çš„è¯„ä»·ã€‚</p>
<h4 id="ç¬¬å››åæ¡"><a href="#ç¬¬å››åæ¡" class="headerlink" title="ç¬¬å››åæ¡"></a>ç¬¬å››åæ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“æ ¹æ®å•†å“æˆ–è€…æœåŠ¡çš„ä»·æ ¼ã€é”€é‡ã€ä¿¡ç”¨ç­‰ä»¥å¤šç§æ–¹å¼å‘æ¶ˆè´¹è€…æ˜¾ç¤ºå•†å“æˆ–è€…æœåŠ¡çš„æœç´¢ç»“æœï¼›å¯¹äºç«ä»·æ’åçš„å•†å“æˆ–è€…æœåŠ¡ï¼Œåº”å½“æ˜¾è‘—æ ‡æ˜â€œå¹¿å‘Šâ€ã€‚</p>
<h4 id="ç¬¬å››åä¸€æ¡"><a href="#ç¬¬å››åä¸€æ¡" class="headerlink" title="ç¬¬å››åä¸€æ¡"></a>ç¬¬å››åä¸€æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“å»ºç«‹çŸ¥è¯†äº§æƒä¿æŠ¤è§„åˆ™ï¼Œä¸çŸ¥è¯†äº§æƒæƒåˆ©äººåŠ å¼ºåˆä½œï¼Œä¾æ³•ä¿æŠ¤çŸ¥è¯†äº§æƒã€‚</p>
<h4 id="ç¬¬å››åäºŒæ¡"><a href="#ç¬¬å››åäºŒæ¡" class="headerlink" title="ç¬¬å››åäºŒæ¡"></a>ç¬¬å››åäºŒæ¡</h4><p>çŸ¥è¯†äº§æƒæƒåˆ©äººè®¤ä¸ºå…¶çŸ¥è¯†äº§æƒå—åˆ°ä¾µå®³çš„ï¼Œæœ‰æƒé€šçŸ¥ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…é‡‡å–åˆ é™¤ã€å±è”½ã€æ–­å¼€é“¾æ¥ã€ç»ˆæ­¢äº¤æ˜“å’ŒæœåŠ¡ç­‰å¿…è¦æªæ–½ã€‚é€šçŸ¥åº”å½“åŒ…æ‹¬æ„æˆä¾µæƒçš„åˆæ­¥è¯æ®ã€‚</p>
<p> ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…æ¥åˆ°é€šçŸ¥åï¼Œåº”å½“åŠæ—¶é‡‡å–å¿…è¦æªæ–½ï¼Œå¹¶å°†è¯¥é€šçŸ¥è½¬é€å¹³å°å†…ç»è¥è€…ï¼›æœªåŠæ—¶é‡‡å–å¿…è¦æªæ–½çš„ï¼Œå¯¹æŸå®³çš„æ‰©å¤§éƒ¨åˆ†ä¸å¹³å°å†…ç»è¥è€…æ‰¿æ‹…è¿å¸¦è´£ä»»ã€‚</p>
<p> å› é€šçŸ¥é”™è¯¯é€ æˆå¹³å°å†…ç»è¥è€…æŸå®³çš„ï¼Œä¾æ³•æ‰¿æ‹…æ°‘äº‹è´£ä»»ã€‚æ¶æ„å‘å‡ºé”™è¯¯é€šçŸ¥ï¼Œé€ æˆå¹³å°å†…ç»è¥è€…æŸå¤±çš„ï¼ŒåŠ å€æ‰¿æ‹…èµ”å¿è´£ä»»ã€‚</p>
<h4 id="ç¬¬å››åä¸‰æ¡"><a href="#ç¬¬å››åä¸‰æ¡" class="headerlink" title="ç¬¬å››åä¸‰æ¡"></a>ç¬¬å››åä¸‰æ¡</h4><p>å¹³å°å†…ç»è¥è€…æ¥åˆ°è½¬é€çš„é€šçŸ¥åï¼Œå¯ä»¥å‘ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…æäº¤ä¸å­˜åœ¨ä¾µæƒè¡Œä¸ºçš„å£°æ˜ã€‚å£°æ˜åº”å½“åŒ…æ‹¬ä¸å­˜åœ¨ä¾µæƒè¡Œä¸ºçš„åˆæ­¥è¯æ®ã€‚</p>
<p> ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…æ¥åˆ°å£°æ˜åï¼Œåº”å½“å°†è¯¥å£°æ˜è½¬é€å‘å‡ºé€šçŸ¥çš„çŸ¥è¯†äº§æƒæƒåˆ©äººï¼Œå¹¶å‘ŠçŸ¥å…¶å¯ä»¥å‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ•è¯‰æˆ–è€…å‘äººæ°‘æ³•é™¢èµ·è¯‰ã€‚ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åœ¨è½¬é€å£°æ˜åˆ°è¾¾çŸ¥è¯†äº§æƒæƒåˆ©äººååäº”æ—¥å†…ï¼Œæœªæ”¶åˆ°æƒåˆ©äººå·²ç»æŠ•è¯‰æˆ–è€…èµ·è¯‰é€šçŸ¥çš„ï¼Œåº”å½“åŠæ—¶ç»ˆæ­¢æ‰€é‡‡å–çš„æªæ–½ã€‚</p>
<h4 id="ç¬¬å››åå››æ¡"><a href="#ç¬¬å››åå››æ¡" class="headerlink" title="ç¬¬å››åå››æ¡"></a>ç¬¬å››åå››æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“åŠæ—¶å…¬ç¤ºæ”¶åˆ°çš„æœ¬æ³•ç¬¬å››åäºŒæ¡ã€ç¬¬å››åä¸‰æ¡è§„å®šçš„é€šçŸ¥ã€å£°æ˜åŠå¤„ç†ç»“æœã€‚</p>
<h4 id="ç¬¬å››åäº”æ¡"><a href="#ç¬¬å››åäº”æ¡" class="headerlink" title="ç¬¬å››åäº”æ¡"></a>ç¬¬å››åäº”æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…çŸ¥é“æˆ–è€…åº”å½“çŸ¥é“å¹³å°å†…ç»è¥è€…ä¾µçŠ¯çŸ¥è¯†äº§æƒçš„ï¼Œåº”å½“é‡‡å–åˆ é™¤ã€å±è”½ã€æ–­å¼€é“¾æ¥ã€ç»ˆæ­¢äº¤æ˜“å’ŒæœåŠ¡ç­‰å¿…è¦æªæ–½ï¼›æœªé‡‡å–å¿…è¦æªæ–½çš„ï¼Œä¸ä¾µæƒäººæ‰¿æ‹…è¿å¸¦è´£ä»»ã€‚</p>
<h4 id="ç¬¬å››åå…­æ¡"><a href="#ç¬¬å››åå…­æ¡" class="headerlink" title="ç¬¬å››åå…­æ¡"></a>ç¬¬å››åå…­æ¡</h4><p>é™¤æœ¬æ³•ç¬¬ä¹æ¡ç¬¬äºŒæ¬¾è§„å®šçš„æœåŠ¡å¤–ï¼Œç”µå­å•†åŠ¡å¹³å°ç»è¥è€…å¯ä»¥æŒ‰ç…§å¹³å°æœåŠ¡åè®®å’Œäº¤æ˜“è§„åˆ™ï¼Œä¸ºç»è¥è€…ä¹‹é—´çš„ç”µå­å•†åŠ¡æä¾›ä»“å‚¨ã€ç‰©æµã€æ”¯ä»˜ç»“ç®—ã€äº¤æ”¶ç­‰æœåŠ¡ã€‚ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ä¸ºç»è¥è€…ä¹‹é—´çš„ç”µå­å•†åŠ¡æä¾›æœåŠ¡ï¼Œåº”å½“éµå®ˆæ³•å¾‹ã€è¡Œæ”¿æ³•è§„å’Œå›½å®¶æœ‰å…³è§„å®šï¼Œä¸å¾—é‡‡å–é›†ä¸­ç«ä»·ã€åšå¸‚å•†ç­‰é›†ä¸­äº¤æ˜“æ–¹å¼è¿›è¡Œäº¤æ˜“ï¼Œä¸å¾—è¿›è¡Œæ ‡å‡†åŒ–åˆçº¦äº¤æ˜“ã€‚</p>
<h2 id="ç¬¬ä¸‰ç« -ç”µå­å•†åŠ¡åˆåŒçš„è®¢ç«‹ä¸å±¥è¡Œ"><a href="#ç¬¬ä¸‰ç« -ç”µå­å•†åŠ¡åˆåŒçš„è®¢ç«‹ä¸å±¥è¡Œ" class="headerlink" title="ç¬¬ä¸‰ç«  ç”µå­å•†åŠ¡åˆåŒçš„è®¢ç«‹ä¸å±¥è¡Œ"></a>ç¬¬ä¸‰ç«  ç”µå­å•†åŠ¡åˆåŒçš„è®¢ç«‹ä¸å±¥è¡Œ</h2><h4 id="ç¬¬å››åä¸ƒæ¡"><a href="#ç¬¬å››åä¸ƒæ¡" class="headerlink" title="ç¬¬å››åä¸ƒæ¡"></a>ç¬¬å››åä¸ƒæ¡</h4><p>ç”µå­å•†åŠ¡å½“äº‹äººè®¢ç«‹å’Œå±¥è¡ŒåˆåŒï¼Œé€‚ç”¨æœ¬ç« å’Œã€Šä¸­åäººæ°‘å…±å’Œå›½æ°‘æ³•æ€»åˆ™ã€‹ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆåŒæ³•ã€‹ã€Šä¸­åäººæ°‘å…±å’Œå›½ç”µå­ç­¾åæ³•ã€‹ç­‰æ³•å¾‹çš„è§„å®šã€‚</p>
<h4 id="ç¬¬å››åå…«æ¡"><a href="#ç¬¬å››åå…«æ¡" class="headerlink" title="ç¬¬å››åå…«æ¡"></a>ç¬¬å››åå…«æ¡</h4><p>ç”µå­å•†åŠ¡å½“äº‹äººä½¿ç”¨è‡ªåŠ¨ä¿¡æ¯ç³»ç»Ÿè®¢ç«‹æˆ–è€…å±¥è¡ŒåˆåŒçš„è¡Œä¸ºå¯¹ä½¿ç”¨è¯¥ç³»ç»Ÿçš„å½“äº‹äººå…·æœ‰æ³•å¾‹æ•ˆåŠ›ã€‚</p>
<p>åœ¨ç”µå­å•†åŠ¡ä¸­æ¨å®šå½“äº‹äººå…·æœ‰ç›¸åº”çš„æ°‘äº‹è¡Œä¸ºèƒ½åŠ›ã€‚ä½†æ˜¯ï¼Œæœ‰ç›¸åè¯æ®è¶³ä»¥æ¨ç¿»çš„é™¤å¤–ã€‚</p>
<h4 id="ç¬¬å››åä¹æ¡"><a href="#ç¬¬å››åä¹æ¡" class="headerlink" title="ç¬¬å››åä¹æ¡"></a>ç¬¬å››åä¹æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…å‘å¸ƒçš„å•†å“æˆ–è€…æœåŠ¡ä¿¡æ¯ç¬¦åˆè¦çº¦æ¡ä»¶çš„ï¼Œç”¨æˆ·é€‰æ‹©è¯¥å•†å“æˆ–è€…æœåŠ¡å¹¶æäº¤è®¢å•æˆåŠŸï¼ŒåˆåŒæˆç«‹ã€‚å½“äº‹äººå¦æœ‰çº¦å®šçš„ï¼Œä»å…¶çº¦å®šã€‚ç”µå­å•†åŠ¡ç»è¥è€…ä¸å¾—ä»¥æ ¼å¼æ¡æ¬¾ç­‰æ–¹å¼çº¦å®šæ¶ˆè´¹è€…æ”¯ä»˜ä»·æ¬¾ååˆåŒä¸æˆç«‹ï¼›æ ¼å¼æ¡æ¬¾ç­‰å«æœ‰è¯¥å†…å®¹çš„ï¼Œå…¶å†…å®¹æ— æ•ˆã€‚</p>
<h4 id="ç¬¬äº”åæ¡"><a href="#ç¬¬äº”åæ¡" class="headerlink" title="ç¬¬äº”åæ¡"></a>ç¬¬äº”åæ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“æ¸…æ™°ã€å…¨é¢ã€æ˜ç¡®åœ°å‘ŠçŸ¥ç”¨æˆ·è®¢ç«‹åˆåŒçš„æ­¥éª¤ã€æ³¨æ„äº‹é¡¹ã€ä¸‹è½½æ–¹æ³•ç­‰äº‹é¡¹ï¼Œå¹¶ä¿è¯ç”¨æˆ·èƒ½å¤Ÿä¾¿åˆ©ã€å®Œæ•´åœ°é˜…è§ˆå’Œä¸‹è½½ã€‚ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“ä¿è¯ç”¨æˆ·åœ¨æäº¤è®¢å•å‰å¯ä»¥æ›´æ­£è¾“å…¥é”™è¯¯ã€‚</p>
<h4 id="ç¬¬äº”åä¸€æ¡"><a href="#ç¬¬äº”åä¸€æ¡" class="headerlink" title="ç¬¬äº”åä¸€æ¡"></a>ç¬¬äº”åä¸€æ¡</h4><p>åˆåŒæ ‡çš„ä¸ºäº¤ä»˜å•†å“å¹¶é‡‡ç”¨å¿«é€’ç‰©æµæ–¹å¼äº¤ä»˜çš„ï¼Œæ”¶è´§äººç­¾æ”¶æ—¶é—´ä¸ºäº¤ä»˜æ—¶é—´ã€‚åˆåŒæ ‡çš„ä¸ºæä¾›æœåŠ¡çš„ï¼Œç”Ÿæˆçš„ç”µå­å‡­è¯æˆ–è€…å®ç‰©å‡­è¯ä¸­è½½æ˜çš„æ—¶é—´ä¸ºäº¤ä»˜æ—¶é—´ï¼›å‰è¿°å‡­è¯æ²¡æœ‰è½½æ˜æ—¶é—´æˆ–è€…è½½æ˜æ—¶é—´ä¸å®é™…æä¾›æœåŠ¡æ—¶é—´ä¸ä¸€è‡´çš„ï¼Œå®é™…æä¾›æœåŠ¡çš„æ—¶é—´ä¸ºäº¤ä»˜æ—¶é—´ã€‚</p>
<p>åˆåŒæ ‡çš„ä¸ºé‡‡ç”¨åœ¨çº¿ä¼ è¾“æ–¹å¼äº¤ä»˜çš„ï¼ŒåˆåŒæ ‡çš„è¿›å…¥å¯¹æ–¹å½“äº‹äººæŒ‡å®šçš„ç‰¹å®šç³»ç»Ÿå¹¶ä¸”èƒ½å¤Ÿæ£€ç´¢è¯†åˆ«çš„æ—¶é—´ä¸ºäº¤ä»˜æ—¶é—´ã€‚</p>
<p>åˆåŒå½“äº‹äººå¯¹äº¤ä»˜æ–¹å¼ã€äº¤ä»˜æ—¶é—´å¦æœ‰çº¦å®šçš„ï¼Œä»å…¶çº¦å®šã€‚</p>
<h4 id="ç¬¬äº”åäºŒæ¡"><a href="#ç¬¬äº”åäºŒæ¡" class="headerlink" title="ç¬¬äº”åäºŒæ¡"></a>ç¬¬äº”åäºŒæ¡</h4><p>ç”µå­å•†åŠ¡å½“äº‹äººå¯ä»¥çº¦å®šé‡‡ç”¨å¿«é€’ç‰©æµæ–¹å¼äº¤ä»˜å•†å“ã€‚å¿«é€’ç‰©æµæœåŠ¡æä¾›è€…ä¸ºç”µå­å•†åŠ¡æä¾›å¿«é€’ç‰©æµæœåŠ¡ï¼Œåº”å½“éµå®ˆæ³•å¾‹ã€è¡Œæ”¿æ³•è§„ï¼Œå¹¶åº”å½“ç¬¦åˆæ‰¿è¯ºçš„æœåŠ¡è§„èŒƒå’Œæ—¶é™ã€‚å¿«é€’ç‰©æµæœåŠ¡æä¾›è€…åœ¨äº¤ä»˜å•†å“æ—¶ï¼Œåº”å½“æç¤ºæ”¶è´§äººå½“é¢æŸ¥éªŒï¼›äº¤ç”±ä»–äººä»£æ”¶çš„ï¼Œåº”å½“ç»æ”¶è´§äººåŒæ„ã€‚ å¿«é€’ç‰©æµæœåŠ¡æä¾›è€…åº”å½“æŒ‰ç…§è§„å®šä½¿ç”¨ç¯ä¿åŒ…è£…ææ–™ï¼Œå®ç°åŒ…è£…ææ–™çš„å‡é‡åŒ–å’Œå†åˆ©ç”¨ã€‚å¿«é€’ç‰©æµæœåŠ¡æä¾›è€…åœ¨æä¾›å¿«é€’ç‰©æµæœåŠ¡çš„åŒæ—¶ï¼Œå¯ä»¥æ¥å—ç”µå­å•†åŠ¡ç»è¥è€…çš„å§”æ‰˜æä¾›ä»£æ”¶è´§æ¬¾æœåŠ¡ã€‚</p>
<h4 id="ç¬¬äº”åä¸‰æ¡"><a href="#ç¬¬äº”åä¸‰æ¡" class="headerlink" title="ç¬¬äº”åä¸‰æ¡"></a>ç¬¬äº”åä¸‰æ¡</h4><p>ç”µå­å•†åŠ¡å½“äº‹äººå¯ä»¥çº¦å®šé‡‡ç”¨ç”µå­æ”¯ä»˜æ–¹å¼æ”¯ä»˜ä»·æ¬¾ã€‚</p>
<p>ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…ä¸ºç”µå­å•†åŠ¡æä¾›ç”µå­æ”¯ä»˜æœåŠ¡ï¼Œåº”å½“éµå®ˆå›½å®¶è§„å®šï¼Œå‘ŠçŸ¥ç”¨æˆ·ç”µå­æ”¯ä»˜æœåŠ¡çš„åŠŸèƒ½ã€ä½¿ç”¨æ–¹æ³•ã€æ³¨æ„äº‹é¡¹ã€ç›¸å…³é£é™©å’Œæ”¶è´¹æ ‡å‡†ç­‰äº‹é¡¹ï¼Œä¸å¾—é™„åŠ ä¸åˆç†äº¤æ˜“æ¡ä»¶ã€‚ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…åº”å½“ç¡®ä¿ç”µå­æ”¯ä»˜æŒ‡ä»¤çš„å®Œæ•´æ€§ã€ä¸€è‡´æ€§ã€å¯è·Ÿè¸ªç¨½æ ¸å’Œä¸å¯ç¯¡æ”¹ã€‚</p>
<p>ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…åº”å½“å‘ç”¨æˆ·å…è´¹æä¾›å¯¹è´¦æœåŠ¡ä»¥åŠæœ€è¿‘ä¸‰å¹´çš„äº¤æ˜“è®°å½•ã€‚</p>
<h4 id="ç¬¬äº”åå››æ¡"><a href="#ç¬¬äº”åå››æ¡" class="headerlink" title="ç¬¬äº”åå››æ¡"></a>ç¬¬äº”åå››æ¡</h4><p>ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…æä¾›ç”µå­æ”¯ä»˜æœåŠ¡ä¸ç¬¦åˆå›½å®¶æœ‰å…³æ”¯ä»˜å®‰å…¨ç®¡ç†è¦æ±‚ï¼Œé€ æˆç”¨æˆ·æŸå¤±çš„ï¼Œåº”å½“æ‰¿æ‹…èµ”å¿è´£ä»»ã€‚</p>
<h4 id="ç¬¬äº”åäº”æ¡"><a href="#ç¬¬äº”åäº”æ¡" class="headerlink" title="ç¬¬äº”åäº”æ¡"></a>ç¬¬äº”åäº”æ¡</h4><p>ç”¨æˆ·åœ¨å‘å‡ºæ”¯ä»˜æŒ‡ä»¤å‰ï¼Œåº”å½“æ ¸å¯¹æ”¯ä»˜æŒ‡ä»¤æ‰€åŒ…å«çš„é‡‘é¢ã€æ”¶æ¬¾äººç­‰å®Œæ•´ä¿¡æ¯ã€‚</p>
<p>æ”¯ä»˜æŒ‡ä»¤å‘ç”Ÿé”™è¯¯çš„ï¼Œç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…åº”å½“åŠæ—¶æŸ¥æ‰¾åŸå› ï¼Œå¹¶é‡‡å–ç›¸å…³æªæ–½äºˆä»¥çº æ­£ã€‚é€ æˆç”¨æˆ·æŸå¤±çš„ï¼Œç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…åº”å½“æ‰¿æ‹…èµ”å¿è´£ä»»ï¼Œä½†èƒ½å¤Ÿè¯æ˜æ”¯ä»˜é”™è¯¯éè‡ªèº«åŸå› é€ æˆçš„é™¤å¤–ã€‚</p>
<h4 id="ç¬¬äº”åå…­æ¡"><a href="#ç¬¬äº”åå…­æ¡" class="headerlink" title="ç¬¬äº”åå…­æ¡"></a>ç¬¬äº”åå…­æ¡</h4><p>ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…å®Œæˆç”µå­æ”¯ä»˜åï¼Œåº”å½“åŠæ—¶å‡†ç¡®åœ°å‘ç”¨æˆ·æä¾›ç¬¦åˆçº¦å®šæ–¹å¼çš„ç¡®è®¤æ”¯ä»˜çš„ä¿¡æ¯ã€‚</p>
<h4 id="ç¬¬äº”åä¸ƒæ¡"><a href="#ç¬¬äº”åä¸ƒæ¡" class="headerlink" title="ç¬¬äº”åä¸ƒæ¡"></a>ç¬¬äº”åä¸ƒæ¡</h4><p>ç”¨æˆ·åº”å½“å¦¥å–„ä¿ç®¡äº¤æ˜“å¯†ç ã€ç”µå­ç­¾åæ•°æ®ç­‰å®‰å…¨å·¥å…·ã€‚ç”¨æˆ·å‘ç°å®‰å…¨å·¥å…·é—å¤±ã€è¢«ç›—ç”¨æˆ–è€…æœªç»æˆæƒçš„æ”¯ä»˜çš„ï¼Œåº”å½“åŠæ—¶é€šçŸ¥ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…ã€‚</p>
<p>æœªç»æˆæƒçš„æ”¯ä»˜é€ æˆçš„æŸå¤±ï¼Œç”±ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…æ‰¿æ‹…ï¼›ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…èƒ½å¤Ÿè¯æ˜æœªç»æˆæƒçš„æ”¯ä»˜æ˜¯å› ç”¨æˆ·çš„è¿‡é”™é€ æˆçš„ï¼Œä¸æ‰¿æ‹…è´£ä»»ã€‚</p>
<p>ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…å‘ç°æ”¯ä»˜æŒ‡ä»¤æœªç»æˆæƒï¼Œæˆ–è€…æ”¶åˆ°ç”¨æˆ·æ”¯ä»˜æŒ‡ä»¤æœªç»æˆæƒçš„é€šçŸ¥æ—¶ï¼Œåº”å½“ç«‹å³é‡‡å–æªæ–½é˜²æ­¢æŸå¤±æ‰©å¤§ã€‚ç”µå­æ”¯ä»˜æœåŠ¡æä¾›è€…æœªåŠæ—¶é‡‡å–æªæ–½å¯¼è‡´æŸå¤±æ‰©å¤§çš„ï¼Œå¯¹æŸå¤±æ‰©å¤§éƒ¨åˆ†æ‰¿æ‹…è´£ä»»ã€‚</p>
<h2 id="ç¬¬å››ç« -ç”µå­å•†åŠ¡äº‰è®®è§£å†³"><a href="#ç¬¬å››ç« -ç”µå­å•†åŠ¡äº‰è®®è§£å†³" class="headerlink" title="ç¬¬å››ç«  ç”µå­å•†åŠ¡äº‰è®®è§£å†³"></a>ç¬¬å››ç«  ç”µå­å•†åŠ¡äº‰è®®è§£å†³</h2><h4 id="ç¬¬äº”åå…«æ¡"><a href="#ç¬¬äº”åå…«æ¡" class="headerlink" title="ç¬¬äº”åå…«æ¡"></a>ç¬¬äº”åå…«æ¡</h4><p>å›½å®¶é¼“åŠ±ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…å»ºç«‹æœ‰åˆ©äºç”µå­å•†åŠ¡å‘å±•å’Œæ¶ˆè´¹è€…æƒç›Šä¿æŠ¤çš„å•†å“ã€æœåŠ¡è´¨é‡æ‹…ä¿æœºåˆ¶ã€‚</p>
<p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ä¸å¹³å°å†…ç»è¥è€…åè®®è®¾ç«‹æ¶ˆè´¹è€…æƒç›Šä¿è¯é‡‘çš„ï¼ŒåŒæ–¹åº”å½“å°±æ¶ˆè´¹è€…æƒç›Šä¿è¯é‡‘çš„æå–æ•°é¢ã€ç®¡ç†ã€ä½¿ç”¨å’Œé€€è¿˜åŠæ³•ç­‰ä½œå‡ºæ˜ç¡®çº¦å®šã€‚</p>
<p>æ¶ˆè´¹è€…è¦æ±‚ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…æ‰¿æ‹…å…ˆè¡Œèµ”å¿è´£ä»»ä»¥åŠç”µå­å•†åŠ¡å¹³å°ç»è¥è€…èµ”å¿åå‘å¹³å°å†…ç»è¥è€…çš„è¿½å¿ï¼Œé€‚ç”¨ã€Šä¸­åäººæ°‘å…±å’Œå›½æ¶ˆè´¹è€…æƒç›Šä¿æŠ¤æ³•ã€‹çš„æœ‰å…³è§„å®šã€‚</p>
<h4 id="ç¬¬äº”åä¹æ¡"><a href="#ç¬¬äº”åä¹æ¡" class="headerlink" title="ç¬¬äº”åä¹æ¡"></a>ç¬¬äº”åä¹æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…åº”å½“å»ºç«‹ä¾¿æ·ã€æœ‰æ•ˆçš„æŠ•è¯‰ã€ä¸¾æŠ¥æœºåˆ¶ï¼Œå…¬å¼€æŠ•è¯‰ã€ä¸¾æŠ¥æ–¹å¼ç­‰ä¿¡æ¯ï¼ŒåŠæ—¶å—ç†å¹¶å¤„ç†æŠ•è¯‰ã€ä¸¾æŠ¥ã€‚</p>
<h4 id="ç¬¬å…­åæ¡"><a href="#ç¬¬å…­åæ¡" class="headerlink" title="ç¬¬å…­åæ¡"></a>ç¬¬å…­åæ¡</h4><p>ç”µå­å•†åŠ¡äº‰è®®å¯ä»¥é€šè¿‡åå•†å’Œè§£ï¼Œè¯·æ±‚æ¶ˆè´¹è€…ç»„ç»‡ã€è¡Œä¸šåä¼šæˆ–è€…å…¶ä»–ä¾æ³•æˆç«‹çš„è°ƒè§£ç»„ç»‡è°ƒè§£ï¼Œå‘æœ‰å…³éƒ¨é—¨æŠ•è¯‰ï¼Œæè¯·ä»²è£ï¼Œæˆ–è€…æèµ·è¯‰è®¼ç­‰æ–¹å¼è§£å†³ã€‚</p>
<h4 id="ç¬¬å…­åä¸€æ¡"><a href="#ç¬¬å…­åä¸€æ¡" class="headerlink" title="ç¬¬å…­åä¸€æ¡"></a>ç¬¬å…­åä¸€æ¡</h4><p>æ¶ˆè´¹è€…åœ¨ç”µå­å•†åŠ¡å¹³å°è´­ä¹°å•†å“æˆ–è€…æ¥å—æœåŠ¡ï¼Œä¸å¹³å°å†…ç»è¥è€…å‘ç”Ÿäº‰è®®æ—¶ï¼Œç”µå­å•†åŠ¡å¹³å°ç»è¥è€…åº”å½“ç§¯æååŠ©æ¶ˆè´¹è€…ç»´æŠ¤åˆæ³•æƒç›Šã€‚</p>
<h4 id="ç¬¬å…­åäºŒæ¡"><a href="#ç¬¬å…­åäºŒæ¡" class="headerlink" title="ç¬¬å…­åäºŒæ¡"></a>ç¬¬å…­åäºŒæ¡</h4><p>åœ¨ç”µå­å•†åŠ¡äº‰è®®å¤„ç†ä¸­ï¼Œç”µå­å•†åŠ¡ç»è¥è€…åº”å½“æä¾›åŸå§‹åˆåŒå’Œäº¤æ˜“è®°å½•ã€‚å› ç”µå­å•†åŠ¡ç»è¥è€…ä¸¢å¤±ã€ä¼ªé€ ã€ç¯¡æ”¹ã€é”€æ¯ã€éšåŒ¿æˆ–è€…æ‹’ç»æä¾›å‰è¿°èµ„æ–™ï¼Œè‡´ä½¿äººæ°‘æ³•é™¢ã€ä»²è£æœºæ„æˆ–è€…æœ‰å…³æœºå…³æ— æ³•æŸ¥æ˜äº‹å®çš„ï¼Œç”µå­å•†åŠ¡ç»è¥è€…åº”å½“æ‰¿æ‹…ç›¸åº”çš„æ³•å¾‹è´£ä»»ã€‚</p>
<h4 id="ç¬¬å…­åä¸‰æ¡"><a href="#ç¬¬å…­åä¸‰æ¡" class="headerlink" title="ç¬¬å…­åä¸‰æ¡"></a>ç¬¬å…­åä¸‰æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…å¯ä»¥å»ºç«‹äº‰è®®åœ¨çº¿è§£å†³æœºåˆ¶ï¼Œåˆ¶å®šå¹¶å…¬ç¤ºäº‰è®®è§£å†³è§„åˆ™ï¼Œæ ¹æ®è‡ªæ„¿åŸåˆ™ï¼Œå…¬å¹³ã€å…¬æ­£åœ°è§£å†³å½“äº‹äººçš„äº‰è®®ã€‚</p>
<h2 id="ç¬¬äº”ç« -ç”µå­å•†åŠ¡ä¿ƒè¿›"><a href="#ç¬¬äº”ç« -ç”µå­å•†åŠ¡ä¿ƒè¿›" class="headerlink" title="ç¬¬äº”ç«  ç”µå­å•†åŠ¡ä¿ƒè¿›"></a>ç¬¬äº”ç«  ç”µå­å•†åŠ¡ä¿ƒè¿›</h2><h4 id="ç¬¬å…­åå››æ¡"><a href="#ç¬¬å…­åå››æ¡" class="headerlink" title="ç¬¬å…­åå››æ¡"></a>ç¬¬å…­åå››æ¡</h4><p>å›½åŠ¡é™¢å’Œçœã€è‡ªæ²»åŒºã€ç›´è¾–å¸‚äººæ°‘æ”¿åºœåº”å½“å°†ç”µå­å•†åŠ¡å‘å±•çº³å…¥å›½æ°‘ç»æµå’Œç¤¾ä¼šå‘å±•è§„åˆ’ï¼Œåˆ¶å®šç§‘å­¦åˆç†çš„äº§ä¸šæ”¿ç­–ï¼Œä¿ƒè¿›ç”µå­å•†åŠ¡åˆ›æ–°å‘å±•ã€‚</p>
<h4 id="ç¬¬å…­åäº”æ¡"><a href="#ç¬¬å…­åäº”æ¡" class="headerlink" title="ç¬¬å…­åäº”æ¡"></a>ç¬¬å…­åäº”æ¡</h4><p>å›½åŠ¡é™¢å’Œå¿çº§ä»¥ä¸Šåœ°æ–¹äººæ°‘æ”¿åºœåŠå…¶æœ‰å…³éƒ¨é—¨åº”å½“é‡‡å–æªæ–½ï¼Œæ”¯æŒã€æ¨åŠ¨ç»¿è‰²åŒ…è£…ã€ä»“å‚¨ã€è¿è¾“ï¼Œä¿ƒè¿›ç”µå­å•†åŠ¡ç»¿è‰²å‘å±•ã€‚</p>
<h4 id="ç¬¬å…­åå…­æ¡"><a href="#ç¬¬å…­åå…­æ¡" class="headerlink" title="ç¬¬å…­åå…­æ¡"></a>ç¬¬å…­åå…­æ¡</h4><p>å›½å®¶æ¨åŠ¨ç”µå­å•†åŠ¡åŸºç¡€è®¾æ–½å’Œç‰©æµç½‘ç»œå»ºè®¾ï¼Œå®Œå–„ç”µå­å•†åŠ¡ç»Ÿè®¡åˆ¶åº¦ï¼ŒåŠ å¼ºç”µå­å•†åŠ¡æ ‡å‡†ä½“ç³»å»ºè®¾ã€‚</p>
<h4 id="ç¬¬å…­åä¸ƒæ¡"><a href="#ç¬¬å…­åä¸ƒæ¡" class="headerlink" title="ç¬¬å…­åä¸ƒæ¡"></a>ç¬¬å…­åä¸ƒæ¡</h4><p>å›½å®¶æ¨åŠ¨ç”µå­å•†åŠ¡åœ¨å›½æ°‘ç»æµå„ä¸ªé¢†åŸŸçš„åº”ç”¨ï¼Œæ”¯æŒç”µå­å•†åŠ¡ä¸å„äº§ä¸šèåˆå‘å±•ã€‚</p>
<h4 id="ç¬¬å…­åå…«æ¡"><a href="#ç¬¬å…­åå…«æ¡" class="headerlink" title="ç¬¬å…­åå…«æ¡"></a>ç¬¬å…­åå…«æ¡</h4><p>å›½å®¶ä¿ƒè¿›å†œä¸šç”Ÿäº§ã€åŠ å·¥ã€æµé€šç­‰ç¯èŠ‚çš„äº’è”ç½‘æŠ€æœ¯åº”ç”¨ï¼Œé¼“åŠ±å„ç±»ç¤¾ä¼šèµ„æºåŠ å¼ºåˆä½œï¼Œä¿ƒè¿›å†œæ‘ç”µå­å•†åŠ¡å‘å±•ï¼Œå‘æŒ¥ç”µå­å•†åŠ¡åœ¨ç²¾å‡†æ‰¶è´«ä¸­çš„ä½œç”¨ã€‚</p>
<h4 id="ç¬¬å…­åä¹æ¡"><a href="#ç¬¬å…­åä¹æ¡" class="headerlink" title="ç¬¬å…­åä¹æ¡"></a>ç¬¬å…­åä¹æ¡</h4><p>å›½å®¶ç»´æŠ¤ç”µå­å•†åŠ¡äº¤æ˜“å®‰å…¨ï¼Œä¿æŠ¤ç”µå­å•†åŠ¡ç”¨æˆ·ä¿¡æ¯ï¼Œé¼“åŠ±ç”µå­å•†åŠ¡æ•°æ®å¼€å‘åº”ç”¨ï¼Œä¿éšœç”µå­å•†åŠ¡æ•°æ®ä¾æ³•æœ‰åºè‡ªç”±æµåŠ¨ã€‚å›½å®¶é‡‡å–æªæ–½æ¨åŠ¨å»ºç«‹å…¬å…±æ•°æ®å…±äº«æœºåˆ¶ï¼Œä¿ƒè¿›ç”µå­å•†åŠ¡ç»è¥è€…ä¾æ³•åˆ©ç”¨å…¬å…±æ•°æ®ã€‚</p>
<h4 id="ç¬¬ä¸ƒåæ¡"><a href="#ç¬¬ä¸ƒåæ¡" class="headerlink" title="ç¬¬ä¸ƒåæ¡"></a>ç¬¬ä¸ƒåæ¡</h4><p>å›½å®¶æ”¯æŒä¾æ³•è®¾ç«‹çš„ä¿¡ç”¨è¯„ä»·æœºæ„å¼€å±•ç”µå­å•†åŠ¡ä¿¡ç”¨è¯„ä»·ï¼Œå‘ç¤¾ä¼šæä¾›ç”µå­å•†åŠ¡ä¿¡ç”¨è¯„ä»·æœåŠ¡ã€‚</p>
<h4 id="ç¬¬ä¸ƒåä¸€æ¡"><a href="#ç¬¬ä¸ƒåä¸€æ¡" class="headerlink" title="ç¬¬ä¸ƒåä¸€æ¡"></a>ç¬¬ä¸ƒåä¸€æ¡</h4><p>å›½å®¶ä¿ƒè¿›è·¨å¢ƒç”µå­å•†åŠ¡å‘å±•ï¼Œå»ºç«‹å¥å…¨é€‚åº”è·¨å¢ƒç”µå­å•†åŠ¡ç‰¹ç‚¹çš„æµ·å…³ã€ç¨æ”¶ã€è¿›å‡ºå¢ƒæ£€éªŒæ£€ç–«ã€æ”¯ä»˜ç»“ç®—ç­‰ç®¡ç†åˆ¶åº¦ï¼Œæé«˜è·¨å¢ƒç”µå­å•†åŠ¡å„ç¯èŠ‚ä¾¿åˆ©åŒ–æ°´å¹³ï¼Œæ”¯æŒè·¨å¢ƒç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ç­‰ä¸ºè·¨å¢ƒç”µå­å•†åŠ¡æä¾›ä»“å‚¨ç‰©æµã€æŠ¥å…³ã€æŠ¥æ£€ç­‰æœåŠ¡ã€‚</p>
<p>å›½å®¶æ”¯æŒå°å‹å¾®å‹ä¼ä¸šä»äº‹è·¨å¢ƒç”µå­å•†åŠ¡ã€‚</p>
<h4 id="ç¬¬ä¸ƒåäºŒæ¡"><a href="#ç¬¬ä¸ƒåäºŒæ¡" class="headerlink" title="ç¬¬ä¸ƒåäºŒæ¡"></a>ç¬¬ä¸ƒåäºŒæ¡</h4><p>å›½å®¶è¿›å‡ºå£ç®¡ç†éƒ¨é—¨åº”å½“æ¨è¿›è·¨å¢ƒç”µå­å•†åŠ¡æµ·å…³ç”³æŠ¥ã€çº³ç¨ã€æ£€éªŒæ£€ç–«ç­‰ç¯èŠ‚çš„ç»¼åˆæœåŠ¡å’Œç›‘ç®¡ä½“ç³»å»ºè®¾ï¼Œä¼˜åŒ–ç›‘ç®¡æµç¨‹ï¼Œæ¨åŠ¨å®ç°ä¿¡æ¯å…±äº«ã€ç›‘ç®¡äº’è®¤ã€æ‰§æ³•äº’åŠ©ï¼Œæé«˜è·¨å¢ƒç”µå­å•†åŠ¡æœåŠ¡å’Œç›‘ç®¡æ•ˆç‡ã€‚è·¨å¢ƒç”µå­å•†åŠ¡ç»è¥è€…å¯ä»¥å‡­ç”µå­å•è¯å‘å›½å®¶è¿›å‡ºå£ç®¡ç†éƒ¨é—¨åŠç†æœ‰å…³æ‰‹ç»­ã€‚</p>
<h4 id="ç¬¬ä¸ƒåä¸‰æ¡"><a href="#ç¬¬ä¸ƒåä¸‰æ¡" class="headerlink" title="ç¬¬ä¸ƒåä¸‰æ¡"></a>ç¬¬ä¸ƒåä¸‰æ¡</h4><p>å›½å®¶æ¨åŠ¨å»ºç«‹ä¸ä¸åŒå›½å®¶ã€åœ°åŒºä¹‹é—´è·¨å¢ƒç”µå­å•†åŠ¡çš„äº¤æµåˆä½œï¼Œå‚ä¸ç”µå­å•†åŠ¡å›½é™…è§„åˆ™çš„åˆ¶å®šï¼Œä¿ƒè¿›ç”µå­ç­¾åã€ç”µå­èº«ä»½ç­‰å›½é™…äº’è®¤ã€‚å›½å®¶æ¨åŠ¨å»ºç«‹ä¸ä¸åŒå›½å®¶ã€åœ°åŒºä¹‹é—´çš„è·¨å¢ƒç”µå­å•†åŠ¡äº‰è®®è§£å†³æœºåˆ¶ã€‚</p>
<h2 id="ç¬¬å…­ç« -æ³•å¾‹è´£ä»»"><a href="#ç¬¬å…­ç« -æ³•å¾‹è´£ä»»" class="headerlink" title="ç¬¬å…­ç«  æ³•å¾‹è´£ä»»"></a>ç¬¬å…­ç«  æ³•å¾‹è´£ä»»</h2><h4 id="ç¬¬ä¸ƒåå››æ¡"><a href="#ç¬¬ä¸ƒåå››æ¡" class="headerlink" title="ç¬¬ä¸ƒåå››æ¡"></a>ç¬¬ä¸ƒåå››æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…é”€å”®å•†å“æˆ–è€…æä¾›æœåŠ¡ï¼Œä¸å±¥è¡ŒåˆåŒä¹‰åŠ¡æˆ–è€…å±¥è¡ŒåˆåŒä¹‰åŠ¡ä¸ç¬¦åˆçº¦å®šï¼Œæˆ–è€…é€ æˆä»–äººæŸå®³çš„ï¼Œä¾æ³•æ‰¿æ‹…æ°‘äº‹è´£ä»»ã€‚</p>
<h4 id="ç¬¬ä¸ƒåäº”æ¡"><a href="#ç¬¬ä¸ƒåäº”æ¡" class="headerlink" title="ç¬¬ä¸ƒåäº”æ¡"></a>ç¬¬ä¸ƒåäº”æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…è¿åæœ¬æ³•ç¬¬åäºŒæ¡ã€ç¬¬åä¸‰æ¡è§„å®šï¼Œæœªå–å¾—ç›¸å…³è¡Œæ”¿è®¸å¯ä»äº‹ç»è¥æ´»åŠ¨ï¼Œæˆ–è€…é”€å”®ã€æä¾›æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ç¦æ­¢äº¤æ˜“çš„å•†å“ã€æœåŠ¡ï¼Œæˆ–è€…ä¸å±¥è¡Œæœ¬æ³•ç¬¬äºŒåäº”æ¡è§„å®šçš„ä¿¡æ¯æä¾›ä¹‰åŠ¡ï¼Œç”µå­å•†åŠ¡å¹³å°ç»è¥è€…è¿åæœ¬æ³•ç¬¬å››åå…­æ¡è§„å®šï¼Œé‡‡å–é›†ä¸­äº¤æ˜“æ–¹å¼è¿›è¡Œäº¤æ˜“ï¼Œæˆ–è€…è¿›è¡Œæ ‡å‡†åŒ–åˆçº¦äº¤æ˜“çš„ï¼Œä¾ç…§æœ‰å…³æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šå¤„ç½šã€‚</p>
<h4 id="ç¬¬ä¸ƒåå…­æ¡"><a href="#ç¬¬ä¸ƒåå…­æ¡" class="headerlink" title="ç¬¬ä¸ƒåå…­æ¡"></a>ç¬¬ä¸ƒåå…­æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…è¿åæœ¬æ³•è§„å®šï¼Œæœ‰ä¸‹åˆ—è¡Œä¸ºä¹‹ä¸€çš„ï¼Œç”±å¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼Œå¯ä»¥å¤„ä¸€ä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼Œå¯¹å…¶ä¸­çš„ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…ï¼Œä¾ç…§æœ¬æ³•ç¬¬å…«åä¸€æ¡ç¬¬ä¸€æ¬¾çš„è§„å®šå¤„ç½šï¼š</p>
<ul>
<li>ï¼ˆä¸€ï¼‰æœªåœ¨é¦–é¡µæ˜¾è‘—ä½ç½®å…¬ç¤ºè¥ä¸šæ‰§ç…§ä¿¡æ¯ã€è¡Œæ”¿è®¸å¯ä¿¡æ¯ã€å±äºä¸éœ€è¦åŠç†å¸‚åœºä¸»ä½“ç™»è®°æƒ…å½¢ç­‰ä¿¡æ¯,æˆ–è€…ä¸Šè¿°ä¿¡æ¯çš„é“¾æ¥æ ‡è¯†çš„ï¼›</li>
<li>ï¼ˆäºŒï¼‰æœªåœ¨é¦–é¡µæ˜¾è‘—ä½ç½®æŒç»­å…¬ç¤ºç»ˆæ­¢ç”µå­å•†åŠ¡çš„æœ‰å…³ä¿¡æ¯çš„ï¼›</li>
<li>ï¼ˆä¸‰ï¼‰æœªæ˜ç¤ºç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ã€æ›´æ­£ã€åˆ é™¤ä»¥åŠç”¨æˆ·æ³¨é”€çš„æ–¹å¼ã€ç¨‹åºï¼Œæˆ–è€…å¯¹ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ã€æ›´æ­£ã€åˆ é™¤ä»¥åŠç”¨æˆ·æ³¨é”€è®¾ç½®ä¸åˆç†æ¡ä»¶çš„ã€‚</li>
</ul>
<p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…å¯¹è¿åå‰æ¬¾è§„å®šçš„å¹³å°å†…ç»è¥è€…æœªé‡‡å–å¿…è¦æªæ–½çš„ï¼Œç”±å¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼Œå¯ä»¥å¤„äºŒä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ã€‚</p>
<h4 id="ç¬¬ä¸ƒåä¸ƒæ¡"><a href="#ç¬¬ä¸ƒåä¸ƒæ¡" class="headerlink" title="ç¬¬ä¸ƒåä¸ƒæ¡"></a>ç¬¬ä¸ƒåä¸ƒæ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…è¿åæœ¬æ³•ç¬¬åå…«æ¡ç¬¬ä¸€æ¬¾è§„å®šæä¾›æœç´¢ç»“æœï¼Œæˆ–è€…è¿åæœ¬æ³•ç¬¬åä¹æ¡è§„å®šæ­å”®å•†å“ã€æœåŠ¡çš„ï¼Œç”±å¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼Œæ²¡æ”¶<br>è¿æ³•æ‰€å¾—ï¼Œå¯ä»¥å¹¶å¤„äº”ä¸‡å…ƒä»¥ä¸ŠäºŒåä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼›æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¹¶å¤„äºŒåä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ã€‚</p>
<h4 id="ç¬¬ä¸ƒåå…«æ¡"><a href="#ç¬¬ä¸ƒåå…«æ¡" class="headerlink" title="ç¬¬ä¸ƒåå…«æ¡"></a>ç¬¬ä¸ƒåå…«æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…è¿åæœ¬æ³•ç¬¬äºŒåä¸€æ¡è§„å®šï¼Œæœªå‘æ¶ˆè´¹è€…æ˜ç¤ºæŠ¼é‡‘é€€è¿˜çš„æ–¹å¼ã€ç¨‹åºï¼Œå¯¹æŠ¼é‡‘é€€è¿˜è®¾ç½®ä¸åˆç†æ¡ä»¶ï¼Œæˆ–è€…ä¸åŠæ—¶é€€è¿˜æŠ¼é‡‘çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼Œå¯ä»¥å¤„äº”ä¸‡å…ƒä»¥ä¸ŠäºŒåä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼›æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¤„äºŒåä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ã€‚</p>
<h4 id="ç¬¬ä¸ƒåä¹æ¡"><a href="#ç¬¬ä¸ƒåä¹æ¡" class="headerlink" title="ç¬¬ä¸ƒåä¹æ¡"></a>ç¬¬ä¸ƒåä¹æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…è¿åæ³•å¾‹ã€è¡Œæ”¿æ³•è§„æœ‰å…³ä¸ªäººä¿¡æ¯ä¿æŠ¤çš„è§„å®šï¼Œæˆ–è€…ä¸å±¥è¡Œæœ¬æ³•ç¬¬ä¸‰åæ¡å’Œæœ‰å…³æ³•å¾‹ã€è¡Œæ”¿æ³•è§„è§„å®šçš„ç½‘ç»œå®‰å…¨ä¿éšœä¹‰åŠ¡çš„ï¼Œä¾ç…§ã€Šä¸­åäººæ°‘å…±å’Œå›½ç½‘ç»œå®‰å…¨æ³•ã€‹ç­‰æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šå¤„ç½šã€‚</p>
<h4 id="ç¬¬å…«åæ¡"><a href="#ç¬¬å…«åæ¡" class="headerlink" title="ç¬¬å…«åæ¡"></a>ç¬¬å…«åæ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…æœ‰ä¸‹åˆ—è¡Œä¸ºä¹‹ä¸€çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼›é€¾æœŸä¸æ”¹æ­£çš„ï¼Œå¤„äºŒä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼›æƒ…èŠ‚ä¸¥é‡çš„ï¼Œè´£ä»¤åœä¸šæ•´é¡¿ï¼Œ å¹¶å¤„åä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼š</p>
<ul>
<li>ï¼ˆä¸€ï¼‰ä¸å±¥è¡Œæœ¬æ³•ç¬¬äºŒåä¸ƒæ¡è§„å®šçš„æ ¸éªŒã€ç™»è®°ä¹‰åŠ¡çš„ï¼›</li>
<li>ï¼ˆäºŒï¼‰ä¸æŒ‰ç…§æœ¬æ³•ç¬¬äºŒåå…«æ¡è§„å®šå‘å¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨ã€ç¨åŠ¡éƒ¨é—¨æŠ¥é€æœ‰å…³ä¿¡æ¯ çš„ï¼› </li>
<li>ï¼ˆä¸‰ï¼‰ä¸æŒ‰ç…§æœ¬æ³•ç¬¬äºŒåä¹æ¡è§„å®šå¯¹è¿æ³•æƒ…å½¢é‡‡å–å¿…è¦çš„å¤„ç½®æªæ–½ï¼Œæˆ–è€…æœªå‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šçš„ï¼›</li>
<li>ï¼ˆå››ï¼‰ä¸å±¥è¡Œæœ¬æ³•ç¬¬ä¸‰åä¸€æ¡è§„å®šçš„å•†å“å’ŒæœåŠ¡ä¿¡æ¯ã€äº¤æ˜“ä¿¡æ¯ä¿å­˜ä¹‰åŠ¡çš„ã€‚</li>
</ul>
<p>æ³•å¾‹ã€è¡Œæ”¿æ³•è§„å¯¹å‰æ¬¾è§„å®šçš„è¿æ³•è¡Œä¸ºçš„å¤„ç½šå¦æœ‰è§„å®šçš„ï¼Œä¾ç…§å…¶è§„å®šã€‚</p>
<h4 id="ç¬¬å…«åä¸€æ¡"><a href="#ç¬¬å…«åä¸€æ¡" class="headerlink" title="ç¬¬å…«åä¸€æ¡"></a>ç¬¬å…«åä¸€æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…è¿åæœ¬æ³•è§„å®šï¼Œæœ‰ä¸‹åˆ—è¡Œä¸ºä¹‹ä¸€çš„ï¼Œç”±å¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼Œå¯ä»¥å¤„äºŒä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼›æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¤„åä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼š</p>
<ul>
<li>ï¼ˆä¸€ï¼‰æœªåœ¨é¦–é¡µæ˜¾è‘—ä½ç½®æŒç»­å…¬ç¤ºå¹³å°æœåŠ¡åè®®ã€äº¤æ˜“è§„åˆ™ä¿¡æ¯æˆ–è€…ä¸Šè¿°ä¿¡æ¯çš„ é“¾æ¥æ ‡è¯†çš„ï¼›</li>
<li>ï¼ˆäºŒï¼‰ä¿®æ”¹äº¤æ˜“è§„åˆ™æœªåœ¨é¦–é¡µæ˜¾è‘—ä½ç½®å…¬å¼€å¾æ±‚æ„è§ï¼ŒæœªæŒ‰ç…§è§„å®šçš„æ—¶é—´æå‰å…¬ç¤ºä¿®æ”¹å†…å®¹ï¼Œæˆ–è€…é˜»æ­¢å¹³å°å†…ç»è¥è€…é€€å‡ºçš„ï¼›</li>
<li>ï¼ˆä¸‰ï¼‰æœªä»¥æ˜¾è‘—æ–¹å¼åŒºåˆ†æ ‡è®°è‡ªè¥ä¸šåŠ¡å’Œå¹³å°å†…ç»è¥è€…å¼€å±•çš„ä¸šåŠ¡çš„ï¼› </li>
<li>ï¼ˆå››ï¼‰æœªä¸ºæ¶ˆè´¹è€…æä¾›å¯¹å¹³å°å†…é”€å”®çš„å•†å“æˆ–è€…æä¾›çš„æœåŠ¡è¿›è¡Œè¯„ä»·çš„é€”å¾„ï¼Œæˆ–è€…æ“…è‡ªåˆ é™¤æ¶ˆè´¹è€…çš„è¯„ä»·çš„ã€‚</li>
</ul>
<p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…è¿åæœ¬æ³•ç¬¬å››åæ¡è§„å®šï¼Œå¯¹ç«ä»·æ’åçš„å•†å“æˆ–è€…æœåŠ¡æœªæ˜¾è‘—æ ‡æ˜â€œå¹¿å‘Šâ€çš„ï¼Œä¾ç…§ã€Šä¸­åäººæ°‘å…±å’Œå›½å¹¿å‘Šæ³•ã€‹çš„è§„å®šå¤„ç½šã€‚</p>
<h4 id="ç¬¬å…«åäºŒæ¡"><a href="#ç¬¬å…«åäºŒæ¡" class="headerlink" title="ç¬¬å…«åäºŒæ¡"></a>ç¬¬å…«åäºŒæ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…è¿åæœ¬æ³•ç¬¬ä¸‰åäº”æ¡è§„å®šï¼Œå¯¹å¹³å°å†…ç»è¥è€…åœ¨å¹³å°å†…çš„äº¤æ˜“ã€äº¤æ˜“ä»·æ ¼æˆ–è€…ä¸å…¶ä»–ç»è¥è€…çš„äº¤æ˜“ç­‰è¿›è¡Œä¸åˆç†é™åˆ¶æˆ–è€…é™„åŠ ä¸åˆç†æ¡ä»¶ï¼Œæˆ–è€…å‘å¹³å°å†…ç»è¥è€…æ”¶å–ä¸åˆç†è´¹ç”¨çš„ï¼Œç”±å¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼Œå¯ä»¥å¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼›æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¤„äº”åä¸‡å…ƒä»¥ä¸ŠäºŒç™¾ä¸‡å…ƒä»¥ä¸‹ çš„ç½šæ¬¾ã€‚</p>
<h4 id="ç¬¬å…«åä¸‰æ¡"><a href="#ç¬¬å…«åä¸‰æ¡" class="headerlink" title="ç¬¬å…«åä¸‰æ¡"></a>ç¬¬å…«åä¸‰æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…è¿åæœ¬æ³•ç¬¬ä¸‰åå…«æ¡è§„å®šï¼Œå¯¹å¹³å°å†…ç»è¥è€…ä¾µå®³æ¶ˆè´¹è€…åˆæ³•æƒç›Šè¡Œä¸ºæœªé‡‡å–å¿…è¦æªæ–½ï¼Œæˆ–è€…å¯¹å¹³å°å†…ç»è¥è€…æœªå°½åˆ°èµ„è´¨èµ„æ ¼å®¡æ ¸ä¹‰åŠ¡ï¼Œæˆ–è€…å¯¹æ¶ˆè´¹è€…æœªå°½åˆ°å®‰å…¨ä¿éšœä¹‰åŠ¡çš„ï¼Œç”±å¸‚åœºç›‘ç£ç®¡ç†éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼Œå¯ä»¥å¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼›æƒ…èŠ‚ä¸¥é‡çš„ï¼Œè´£ä»¤åœä¸šæ•´é¡¿ï¼Œå¹¶å¤„äº”åä¸‡å…ƒä»¥ä¸ŠäºŒç™¾ä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ã€‚</p>
<h4 id="ç¬¬å…«åå››æ¡"><a href="#ç¬¬å…«åå››æ¡" class="headerlink" title="ç¬¬å…«åå››æ¡"></a>ç¬¬å…«åå››æ¡</h4><p>ç”µå­å•†åŠ¡å¹³å°ç»è¥è€…è¿åæœ¬æ³•ç¬¬å››åäºŒæ¡ã€ç¬¬å››åäº”æ¡è§„å®šï¼Œå¯¹å¹³å°å†…ç»è¥è€…å®æ–½ä¾µçŠ¯çŸ¥è¯†äº§æƒè¡Œä¸ºæœªä¾æ³•é‡‡å–å¿…è¦æªæ–½çš„ï¼Œç”±æœ‰å…³çŸ¥è¯†äº§æƒè¡Œæ”¿éƒ¨é—¨è´£ä»¤é™æœŸæ”¹æ­£ï¼›é€¾æœŸä¸æ”¹æ­£çš„ï¼Œå¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ï¼›æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¤„äº”åä¸‡å…ƒä»¥ä¸ŠäºŒç™¾ä¸‡å…ƒä»¥ä¸‹çš„ç½šæ¬¾ã€‚</p>
<h4 id="ç¬¬å…«åäº”æ¡"><a href="#ç¬¬å…«åäº”æ¡" class="headerlink" title="ç¬¬å…«åäº”æ¡"></a>ç¬¬å…«åäº”æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…è¿åæœ¬æ³•è§„å®šï¼Œé”€å”®çš„å•†å“æˆ–è€…æä¾›çš„æœåŠ¡ä¸ç¬¦åˆä¿éšœäººèº«ã€è´¢äº§å®‰å…¨çš„è¦æ±‚ï¼Œå®æ–½è™šå‡æˆ–è€…å¼•äººè¯¯è§£çš„å•†ä¸šå®£ä¼ ç­‰ä¸æ­£å½“ç«äº‰è¡Œä¸ºï¼Œæ»¥ç”¨å¸‚åœºæ”¯é…åœ°ä½ï¼Œæˆ–è€…å®æ–½ä¾µçŠ¯çŸ¥è¯†äº§æƒã€ä¾µå®³æ¶ˆè´¹è€…æƒç›Šç­‰è¡Œä¸ºçš„ï¼Œä¾ç…§æœ‰å…³æ³•å¾‹çš„è§„å®šå¤„ç½šã€‚</p>
<h4 id="ç¬¬å…«åå…­æ¡"><a href="#ç¬¬å…«åå…­æ¡" class="headerlink" title="ç¬¬å…«åå…­æ¡"></a>ç¬¬å…«åå…­æ¡</h4><p>ç”µå­å•†åŠ¡ç»è¥è€…æœ‰æœ¬æ³•è§„å®šçš„è¿æ³•è¡Œä¸ºçš„ï¼Œä¾ç…§æœ‰å…³æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šè®°å…¥ä¿¡ç”¨æ¡£æ¡ˆï¼Œå¹¶äºˆä»¥å…¬ç¤ºã€‚</p>
<h4 id="ç¬¬å…«åä¸ƒæ¡"><a href="#ç¬¬å…«åä¸ƒæ¡" class="headerlink" title="ç¬¬å…«åä¸ƒæ¡"></a>ç¬¬å…«åä¸ƒæ¡</h4><p>ä¾æ³•è´Ÿæœ‰ç”µå­å•†åŠ¡ç›‘ç£ç®¡ç†èŒè´£çš„éƒ¨é—¨çš„å·¥ä½œäººå‘˜ï¼Œç©å¿½èŒå®ˆã€æ»¥ç”¨èŒæƒã€å¾‡ç§èˆå¼Šï¼Œæˆ–è€…æ³„éœ²ã€å‡ºå”®æˆ–è€…éæ³•å‘ä»–äººæä¾›åœ¨å±¥è¡ŒèŒè´£ä¸­æ‰€çŸ¥æ‚‰çš„ä¸ªäººä¿¡æ¯ã€éšç§å’Œå•†ä¸šç§˜å¯†çš„ï¼Œä¾æ³•è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚</p>
<h4 id="ç¬¬å…«åå…«æ¡"><a href="#ç¬¬å…«åå…«æ¡" class="headerlink" title="ç¬¬å…«åå…«æ¡"></a>ç¬¬å…«åå…«æ¡</h4><p>è¿åæœ¬æ³•è§„å®šï¼Œæ„æˆè¿åæ²»å®‰ç®¡ç†è¡Œä¸ºçš„ï¼Œä¾æ³•ç»™äºˆæ²»å®‰ç®¡ç†å¤„ç½šï¼›æ„æˆçŠ¯ç½ªçš„ï¼Œä¾æ³•è¿½ç©¶åˆ‘äº‹è´£ä»»ã€‚</p>
<p><a class="link"   href="https://github.com/blusewang/blog/files/5779079/default.pdf" >ä¸­åäººæ°‘å…±å’Œå›½ç”µå­å•†åŠ¡æ³•.pdf<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>ç”µå­å•†åŠ¡æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>è§£å†³FreeBSDä¸Šçš„ç¨‹åºå´©æºƒ</title>
    <url>/2021/02/27/freebsd-lldb-debug-programe/</url>
    <content><![CDATA[<h2 id="ç¬¬ä¸€æ­¥-å¼€å¯æ ¸å¿ƒè½¬å‚¨"><a href="#ç¬¬ä¸€æ­¥-å¼€å¯æ ¸å¿ƒè½¬å‚¨" class="headerlink" title="ç¬¬ä¸€æ­¥:å¼€å¯æ ¸å¿ƒè½¬å‚¨"></a>ç¬¬ä¸€æ­¥:å¼€å¯æ ¸å¿ƒè½¬å‚¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">kern.corefile=/var/db/coredump/%N.core</span><br><span class="line">kern.coredump=1</span><br><span class="line">kern.nodump_coredump=1</span><br><span class="line">kern.sugid_coredump=1</span><br></pre></td></tr></table></figure>
<p>å½“å‰è®¾ç½®,ä¼šè®©è¿›ç¨‹å´©æºƒå,å°†æ ¸å¿ƒè½¬å‚¨è‡³<code>/var/db/coredump/</code>æ–‡ä»¶å¤¹ä¸‹.</p>
<h2 id="ç¬¬äºŒæ­¥-ç­‰å¾…"><a href="#ç¬¬äºŒæ­¥-ç­‰å¾…" class="headerlink" title="ç¬¬äºŒæ­¥:ç­‰å¾…"></a>ç¬¬äºŒæ­¥:ç­‰å¾…</h2><p>å®šæœŸæ£€æŸ¥<code>/var/log/message</code>æ–‡ä»¶,ç­‰å¾…ç¨‹åºå´©æºƒäº‹ä»¶çš„åˆ°æ¥.</p>
<h2 id="ç¬¬ä¸‰æ­¥-è°ƒè¯•"><a href="#ç¬¬ä¸‰æ­¥-è°ƒè¯•" class="headerlink" title="ç¬¬ä¸‰æ­¥:è°ƒè¯•"></a>ç¬¬ä¸‰æ­¥:è°ƒè¯•</h2><ul>
<li>ä½¿ç”¨<code>lldb</code>æ‰“å¼€<code>core</code>æ–‡ä»¶<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">lldb -c /var/db/coredump/mosquitto.core -- /usr/local/sbin/mosquitto</span><br></pre></td></tr></table></figure></li>
<li>æ‰“å¼€,è¿›å…¥åæ‰§è¡Œ<code>bt</code>å°±çœ‹åˆ°è¯¦ç»†é”™è¯¯äº†.éå¸¸ç®€å•.</li>
</ul>
<p>è¿‡ç¨‹å¦‚å›¾:<br><img src="https://user-images.githubusercontent.com/1764005/109384031-354e3200-7925-11eb-802d-0ca220e55443.png" alt="image"></p>
<p>è¿™è¡¨æ˜æ˜¯<code>libgdb.so</code>æ‰©å±•é‡Œ,è°ƒç”¨<code>strcmp</code>å‡½æ•°æ—¶,å‚æ•°ç»™é”™äº†!</p>
<p>so easy!~</p>
]]></content>
      <tags>
        <tag>mosquitto</tag>
        <tag>FreeBSD</tag>
        <tag>lldb</tag>
      </tags>
  </entry>
</search>
